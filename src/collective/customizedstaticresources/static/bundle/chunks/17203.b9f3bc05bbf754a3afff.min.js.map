{"version":3,"file":"chunks/17203.b9f3bc05bbf754a3afff.min.js","mappings":"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","sources":["webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/tree/tree.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/contentbrowser/contentbrowser.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/pat/validation/validation.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/controlpanels/contentrules.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/cookietrigger/cookietrigger.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/core/utils.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/pat/depends/depends.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/autotoc/autotoc.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/core/i18n.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/controlpanels/discussion.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/core/i18n-wrapper.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/controlpanels/dexterity-types-listing.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/core/logging.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/pat/datetime-picker/datetime-picker.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/search/search.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/select2/select2.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/core/basepattern.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/core/parser.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/datatables/datatables.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/pat/ajax/ajax.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/pat/inject/inject.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/preventdoublesubmit/preventdoublesubmit.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/controlpanels/discussion-comments.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/core/events.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/formautofocus/formautofocus.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/structure/structure.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/modal/modal.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/controlpanels/discussion-moderation.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/passwordstrength/passwordstrength.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/core/jquery-ext.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/pat/checklist/checklist.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/core/registry.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/markspeciallinks/markspeciallinks.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/core/utils.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/recurrence/recurrence.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/core/dom.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/manageportlets/manageportlets.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/relateditems/relateditems.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/navigationmarker/navigationmarker.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/backdrop/backdrop.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/structure-updater/structure-updater.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/controlpanels/schemaeditor.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/core/mockup-parser.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/core/base.js","webpack://plone.staticresources/./node_modules/@patternslib/pat-code-editor/src/code-editor.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/formunloadalert/formunloadalert.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/querystring/querystring.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/toggle/toggle.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/controlpanels/registry.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/sortable/sortable.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/toolbar/toolbar.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/core/uuid.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/core/polyfills.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/pat/display-time/display-time.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/controlpanels/contentrule-elements.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/livesearch/livesearch.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/contentloader/contentloader.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/pat/close-panel/close-panel.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/pat/tooltip/tooltip.js","webpack://plone.staticresources/./node_modules/@plone/mockup/src/pat/upload/upload.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/core/store.js","webpack://plone.staticresources/./node_modules/@patternslib/patternslib/src/pat/date-picker/date-picker.js"],"sourcesContent":["import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport utils from \"../../core/utils\";\n\nexport default Base.extend({\n    name: \"tree\",\n    trigger: \".pat-tree\",\n    parser: \"mockup\",\n    defaults: {\n        dragAndDrop: false,\n        autoOpen: false,\n        selectable: true,\n        keyboardSupport: true,\n        onLoad: null,\n    },\n\n    async init() {\n        import(\"jqtree/jqtree.css\");\n        import(\"./tree.scss\");\n        await import(\"jqtree\");\n\n        var self = this;\n        /* convert all bool options */\n        for (var optionKey in self.options) {\n            var def = self.defaults[optionKey];\n            if (def !== undefined && typeof def === \"boolean\") {\n                self.options[optionKey] = utils.bool(self.options[optionKey]);\n            }\n        }\n\n        if (self.options.onCanMoveTo === undefined) {\n            self.options.onCanMoveTo = function (moved, target, position) {\n                /* if not using folder option, just allow, otherwise, only allow if folder */\n                if (position === \"inside\") {\n                    return target.folder === undefined || target.folder === true;\n                }\n                return true;\n            };\n        }\n\n        if (self.options.data && typeof self.options.data === \"string\") {\n            self.options.data = $.parseJSON(self.options.data);\n        }\n        if (self.options.onLoad !== null) {\n            // delay generating tree...\n            var options = $.extend({}, self.options);\n\n            $.getJSON(options.dataUrl, function (data) {\n                options.data = data;\n                delete options.dataUrl;\n                self.tree = self.$el.tree(options);\n                self.options.onLoad(self);\n            }).fail(function (response) {  // eslint-disable-line no-unused-vars\n                console.log(\"failed to load json data\");\n            });\n        } else {\n            self.tree = self.$el.tree(self.options);\n        }\n    },\n});\n","import { BasePattern } from \"@patternslib/patternslib/src/core/basepattern\";\nimport Parser from \"@patternslib/patternslib/src/core/parser\";\nimport registry from \"@patternslib/patternslib/src/core/registry\";\nimport utils from \"../../core/utils\";\nimport plone_registry from \"@plone/registry\";\n\n// Contentbrowser pattern\n\nexport const parser = new Parser(\"contentbrowser\");\n\nparser.addArgument(\"vocabulary-url\");\nparser.addArgument(\n    \"attributes\",\n    [\n        \"UID\",\n        \"Title\",\n        \"Description\",\n        \"portal_type\",\n        \"path\",\n        \"getURL\",\n        \"getIcon\",\n        \"is_folderish\",\n        \"review_state\",\n        \"created\",\n        \"modified\",\n    ], null, true\n);\nparser.addArgument(\"width\");\nparser.addArgument(\"mode\");\nparser.addArgument(\"max-depth\");\nparser.addArgument(\"root-path\");\nparser.addArgument(\"root-url\");\nparser.addArgument(\"base-path\");\nparser.addArgument(\"context-path\");\nparser.addArgument(\"maximum-selection-size\");\nparser.addArgument(\"selectable-types\");\nparser.addArgument(\"browseable-types\");\nparser.addArgument(\"search-index\");\nparser.addArgument(\"separator\");\nparser.addArgument(\"selection\");\nparser.addArgument(\"selection-template\");\nparser.addArgument(\"favorites\");\nparser.addArgument(\"recently-used\");\nparser.addArgument(\"recently-used-key\");\nparser.addArgument(\"recently-used-max-items\");\nparser.addArgument(\"b-size\");\n\nclass Pattern extends BasePattern {\n    static name = \"contentbrowser\";\n    static trigger = \".pat-contentbrowser\";\n    static parser = parser;\n\n    async init() {\n        this.el.style.display = \"none\";\n\n        // register default components in @plone/registry\n        const SelectedItem = (await import(\"./src/SelectedItem.svelte\")).default;\n\n        plone_registry.registerComponent({\n            name: \"pat-contentbrowser.SelectedItem\",\n            component: SelectedItem,\n        });\n\n        // ensure an id on our element (TinyMCE doesn't have one)\n        let nodeId = this.el.getAttribute(\"id\");\n        if (!nodeId) {\n            nodeId = utils.generateId();\n            this.el.setAttribute(\"id\", nodeId);\n        }\n\n        const ContentBrowserApp = (await import(\"./src/App.svelte\")).default;\n\n        // create browser node\n        const contentBrowserEl = document.createElement(\"div\");\n        contentBrowserEl.classList.add(\"content-browser-wrapper\");\n        this.el.parentNode.insertBefore(contentBrowserEl, this.el);\n\n        this.component_content_browser = new ContentBrowserApp({\n            target: contentBrowserEl,\n            props: {\n                fieldId: nodeId,\n                ...this.options,\n            }\n        });\n    }\n}\n\nregistry.register(Pattern);\nexport default Pattern;\nexport { Pattern };\n","// Patterns validate - Form vlidation\nimport \"../../core/polyfills\"; // SubmitEvent.submitter for Safari < 15.4 and jsDOM\nimport $ from \"jquery\";\nimport { BasePattern } from \"../../core/basepattern\";\nimport Parser from \"../../core/parser\";\nimport dom from \"../../core/dom\";\nimport events from \"../../core/events\";\nimport logging from \"../../core/logging\";\nimport utils from \"../../core/utils\";\nimport registry from \"../../core/registry\";\n\nconst logger = logging.getLogger(\"pat-validation\");\n//logger.setLevel(logging.Level.DEBUG);\n\nexport const parser = new Parser(\"validation\");\nparser.addArgument(\"disable-selector\", \"[type=submit], button:not([type=button])\"); // Elements which must be disabled if there are errors\nparser.addArgument(\"message-date\", \"\"); // \"This value must be a valid date\");\nparser.addArgument(\"message-datetime\", \"\"); // \"This value must be a valid date and time\");\nparser.addArgument(\"message-email\", \"\"); // \"This value must be a valid email address\");\nparser.addArgument(\"message-max\", \"\"); // \"This value must be less than or equal to %{count}\");\nparser.addArgument(\"message-min\", \"\"); // \"This value must be greater than or equal to %{count}\"); // prettier-ignore\nparser.addArgument(\"message-number\", \"\"); // \"This value must be a number\");\nparser.addArgument(\"message-required\", \"\"); // \"This field is required\");\nparser.addArgument(\"message-equality\", \"is not equal to %{attribute}.\");\nparser.addArgument(\"not-after\", null);\nparser.addArgument(\"not-before\", null);\nparser.addArgument(\"equality\", null);\nparser.addArgument(\"delay\", 100); // Delay before validation is done to avoid validating while typing.\n\n// BBB\n// TODO: deprecated. Will be removed with next major version.\nparser.addAlias(\"message-integer\", \"message-number\");\nparser.addArgument(\"error-template\");\n\nconst KEY_ERROR_EL = \"__patternslib__input__error__el\";\nconst KEY_ERROR_MSG = \"__patternslib__input__error__msg\";\n\nclass Pattern extends BasePattern {\n    static name = \"validation\";\n    static trigger = \"form.pat-validation\";\n    static parser = parser;\n\n    init() {\n        events.add_event_listener(\n            this.el,\n            \"submit\",\n            `pat-validation--submit--validator`,\n            (e) => {\n                // On submit, check all.\n                // Immediate, non-debounced check with submit. Otherwise submit\n                // is not cancelable.\n                for (const input of this.inputs) {\n                    logger.debug(\"Checking input for submit\", input, e);\n                    this.check_input({ input: input, event: e });\n                }\n            },\n            // Make sure this event handler is run early, in the capturing\n            // phase in order to be able to cancel later non-capturing submit\n            // events.\n            { capture: true }\n        );\n\n        this.initialize_inputs();\n        $(this.el).on(\"pat-update\", () => {\n            this.initialize_inputs();\n        });\n\n        // Set ``novalidate`` attribute to disable the browser's validation\n        // bubbles but not disable the validation API.\n        this.el.setAttribute(\"novalidate\", \"\");\n    }\n\n    initialize_inputs() {\n        this.inputs = [\n            ...this.el.querySelectorAll(\"input[name], select[name], textarea[name]\"),\n        ];\n        this.disabled_elements = [\n            ...this.el.querySelectorAll(this.options.disableSelector),\n        ];\n\n        for (const [cnt, input] of this.inputs.entries()) {\n            // Cancelable debouncer.\n            const debouncer = utils.debounce((e) => {\n                logger.debug(\"Checking input for event\", input, e);\n                this.check_input({ input: input, event: e });\n            }, this.options.delay);\n\n            events.add_event_listener(\n                input,\n                \"input\",\n                `pat-validation--input-${input.name}--${cnt}--validator`,\n                (e) => debouncer(e)\n            );\n            events.add_event_listener(\n                input,\n                \"change\",\n                `pat-validation--change-${input.name}--${cnt}--validator`,\n                (e) => debouncer(e)\n            );\n            events.add_event_listener(\n                input,\n                \"blur\",\n                `pat-validation--blur-${input.name}--${cnt}--validator`,\n                (e) => debouncer(e)\n            );\n        }\n    }\n\n    check_input({ input, event, stop = false }) {\n        if (input.disabled) {\n            // No need to check disabled inputs.\n            return;\n        }\n\n        // In any case, clear the custom validity first.\n        this.set_error({ input: input, msg: \"\", skip_event: true });\n        const validity_state = input.validity;\n\n        if (event?.submitter?.hasAttribute(\"formnovalidate\")) {\n            // Do not check when a button with ``formnovalidate`` was used.\n            return;\n        }\n\n        logger.debug(`\n            validity_state.badInput ${validity_state.badInput}\n            validity_state.customError ${validity_state.customError}\n            validity_state.patternMismatch ${validity_state.patternMismatch}\n            validity_state.rangeOverflow ${validity_state.rangeOverflow}\n            validity_state.rangeUnderflow ${validity_state.rangeUnderflow}\n            validity_state.stepMismatch ${validity_state.stepMismatch}\n            validity_state.tooLong ${validity_state.tooLong}\n            validity_state.tooShort ${validity_state.tooShort}\n            validity_state.typeMismatch ${validity_state.typeMismatch}\n            validity_state.valid ${validity_state.valid}\n            validity_state.valueMissing ${validity_state.valueMissing}\n        `);\n\n        const input_options = parser.parse(input);\n\n        if (validity_state.valid) {\n            // Custom error cases or no invalid state.\n\n            if (\n                input_options.equality &&\n                this.el.querySelector(`[name=${input_options.equality}]`)?.value !==\n                    input.value\n            ) {\n                const message =\n                    input_options.message.equality ||\n                    `The value is not equal to %{attribute}`;\n                this.set_error({\n                    input: input,\n                    msg: message,\n                    attribute: input_options.equality,\n                });\n            } else if (input_options.not.after || input_options.not.before) {\n                const msg = input_options.message.date || input_options.message.datetime;\n                const msg_default_not_before = \"The date must be after %{attribute}\";\n                const msg_default_not_after = \"The date must be before %{attribute}\";\n\n                let not_after;\n                let not_after_el;\n                if (input_options.not.after) {\n                    if (utils.is_iso_date_time(input_options.not.after, true)) {\n                        not_after = new Date(input_options.not.after);\n                    } else {\n                        // Handle value as selector\n                        not_after_el = document.querySelector(input_options.not.after);\n                        not_after = not_after_el?.value\n                            ? new Date(not_after_el?.value)\n                            : undefined;\n                    }\n\n                    // Use null if no valid date.\n                    not_after = isNaN(not_after) ? null : not_after;\n                }\n\n                let not_before;\n                let not_before_el;\n                if (input_options.not.before) {\n                    if (utils.is_iso_date_time(input_options.not.before, true)) {\n                        not_before = new Date(input_options.not.before);\n                    } else {\n                        // Handle value as selector\n                        not_before_el = document.querySelector(input_options.not.before);\n                        not_before = not_before_el?.value\n                            ? new Date(not_before_el?.value)\n                            : undefined;\n                    }\n\n                    // Use null if no valid date.\n                    not_before = isNaN(not_before) ? null : not_before;\n                }\n\n                if (\n                    input.value &&\n                    utils.is_iso_date_time(input.value, true) &&\n                    !isNaN(new Date(input.value))\n                ) {\n                    // That's 1 valid date!\n                    const date = new Date(input.value);\n\n                    if (not_after && date > not_after) {\n                        let msg_attr;\n                        // Try to construct a meaningfull error message\n                        if (!not_after_el && input_options.not.after) {\n                            // fixed date case\n                            msg_attr = input_options.not.after;\n                        } else {\n                            // Get the label + other text content within the\n                            // label and replace all whitespace and newlines\n                            // with a single space.\n                            msg_attr = not_after_el?.labels?.[0]?.textContent.replace(\n                                /\\s\\s+/g, // replace all whitespace\n                                \" \" // with a single space\n                            );\n                            msg_attr = msg_attr || not_after_el.name;\n                        }\n                        this.set_error({\n                            input: input,\n                            msg: msg || msg_default_not_after,\n                            attribute: msg_attr.trim(),\n                        });\n                    } else if (not_before && date < not_before) {\n                        let msg_attr;\n                        // Try to construct a meaningfull error message\n                        if (!not_before_el && input_options.not.before) {\n                            // fixed date case\n                            msg_attr = input_options.not.before;\n                        } else {\n                            // Get the label + other text content within the\n                            // label and replace all whitespace and newlines\n                            // with a single space.\n                            msg_attr = not_before_el?.labels?.[0]?.textContent.replace(\n                                /\\s\\s+/g, // replace all whitespace\n                                \" \" // with a single space\n                            );\n                            msg_attr = msg_attr || not_before_el.name;\n                        }\n                        this.set_error({\n                            input: input,\n                            msg: msg || msg_default_not_before,\n                            attribute: msg_attr.trim(),\n                        });\n                    }\n                }\n\n                // always check the other input to clear/set errors\n                // do not re-check when stop is set to avoid infinite loops\n                if (!stop && not_after_el) {\n                    logger.debug(\"Check `not-after` input.\", not_after_el);\n                    this.check_input({ input: not_after_el, stop: true });\n                }\n                if (!stop && not_before_el) {\n                    logger.debug(\"Check `no-before` input.\", not_after_el);\n                    this.check_input({ input: not_before_el, stop: true });\n                }\n            }\n\n            if (!validity_state.customError) {\n                // No error to handle. Return.\n                this.remove_error(input, true);\n                return;\n            }\n        } else {\n            // Default error cases with custom messages.\n\n            if (validity_state.valueMissing && input_options.message.required) {\n                this.set_error({ input: input, msg: input_options.message.required });\n            } else if (validity_state.rangeUnderflow && input_options.message.min) {\n                this.set_error({\n                    input: input,\n                    msg: input_options.message.min,\n                    min: input.getAttribute(\"min\"),\n                });\n            } else if (validity_state.rangeOverflow && input_options.message.max) {\n                this.set_error({\n                    input: input,\n                    msg: input_options.message.max,\n                    max: input.getAttribute(\"max\"),\n                });\n            } else if (\n                (validity_state.badInput || validity_state.stepMismatch) &&\n                input.type === \"number\" &&\n                input_options.message.number\n            ) {\n                this.set_error({ input: input, msg: input_options.message.number });\n            } else if (\n                validity_state.typeMismatch &&\n                input.type === \"email\" &&\n                input_options.message.email\n            ) {\n                this.set_error({ input: input, msg: input_options.message.email });\n            } else if (\n                validity_state.rangeUnderflow &&\n                input.type === \"date\" &&\n                input_options.message.date\n            ) {\n                this.set_error({ input: input, msg: input_options.message.date });\n            } else if (\n                validity_state.rangeOverflow &&\n                input.type === \"date\" &&\n                input_options.message.date\n            ) {\n                this.set_error({ input: input, msg: input_options.message.date });\n            } else if (\n                validity_state.rangeUnderflow &&\n                input.type === \"datetime\" &&\n                input_options.message.datetime\n            ) {\n                this.set_error({ input: input, msg: input_options.message.datetime });\n            } else if (\n                validity_state.rangeOverflow &&\n                input.type === \"datetime\" &&\n                input_options.message.datetime\n            ) {\n                this.set_error({ input: input, msg: input_options.message.datetime });\n            } else {\n                // Still an error, but without customized messages.\n                // Call `emit_update` separately\n                this.emit_update(\"invalid\");\n            }\n\n        }\n\n        if (event?.type === \"submit\") {\n            // Do not submit in error case and prevent other handlers to take action.\n            event.preventDefault();\n            event.stopPropagation();\n            event.stopImmediatePropagation();\n        }\n        this.set_error_message(input);\n    }\n\n    set_error({ input, msg, attribute = null, min = null, max = null, skip_event = false }) {\n        // Replace some variables, as like validate.js\n        if (attribute) {\n            msg = msg.replace(/%{attribute}/g, attribute);\n        }\n        if (min) {\n            msg = msg.replace(/%{count}/g, min);\n        }\n        if (max) {\n            msg = msg.replace(/%{count}/g, max);\n        }\n        msg = msg.replace(/%{value}/g, JSON.stringify(input.value));\n\n        input.setCustomValidity(msg);\n        // Store the error message on the input.\n        // Hidden inputs do not participate in validation but we need this\n        // (e.g. styled date input).\n        input[KEY_ERROR_MSG] = msg;\n\n        if (!skip_event) {\n            this.emit_update(\"invalid\");\n        }\n    }\n\n    remove_error(input, all_of_group = false, skip_event = false) {\n        // Remove error message and related referencesfrom input.\n\n        let inputs = [input];\n        if (all_of_group) {\n            // Get all inputs with the same name - e.g. radio buttons, checkboxes.\n            inputs = this.inputs.filter((it) => it.name === input.name);\n        }\n        for (const it of inputs) {\n            const error_node = it[KEY_ERROR_EL];\n            it[KEY_ERROR_EL] = null;\n            error_node?.remove();\n        }\n\n        // disable selector\n        if (this.el.checkValidity()) {\n            for (const it of this.disabled_elements) {\n                if (it.disabled) {\n                    it.removeAttribute(\"disabled\");\n                    it.classList.remove(\"disabled\");\n                }\n            }\n        }\n\n        if (!skip_event) {\n            this.emit_update(\"valid\");\n        }\n    }\n\n    set_error_message(input) {\n        // First, remove the old error message.\n        this.remove_error(input, false, true);\n\n        // Do not set a error message for a input group like radio buttons or\n        // checkboxes where one has already been set.\n        const inputs = this.inputs.filter((it) => it.name === input.name);\n        if (inputs.length > 1 && inputs.some((it) => !!it[KEY_ERROR_EL])) {\n            // error message for input group already set.\n            return;\n        }\n\n        // Create the validation error DOM node from the template\n        const validation_message = input.validationMessage || input[KEY_ERROR_MSG];\n        const error_node = dom.create_from_string(\n            this.error_template(validation_message)\n        ).firstChild;\n\n        let fieldset;\n        if (input.type === \"radio\" || input.type === \"checkbox\") {\n            fieldset = input.closest(\"fieldset.pat-checklist\");\n        }\n        if (fieldset) {\n            fieldset.append(error_node);\n        } else {\n            input.after(error_node);\n        }\n        input[KEY_ERROR_EL] = error_node;\n\n        let did_disable = false;\n        for (const it of this.disabled_elements) {\n            // Disable for melements if they are not already disabled and which\n            // do not have set the `formnovalidate` attribute, e.g.\n            // `<button formnovalidate>cancel</button>`.\n            if (!it.disabled && !it.formNoValidate) {\n                did_disable = true;\n                it.setAttribute(\"disabled\", \"disabled\");\n                it.classList.add(\"disabled\");\n                logger.debug(\"Disable element\", it);\n            }\n        }\n\n        // Do an initial check of the whole form when a form element (e.g. the\n        // submit button) was disabled. We want to show the user all possible\n        // errors at once and after the submit button is disabled there is no\n        // way to check the whole form at once. ... well we also do not want to\n        // check the whole form when one input was changed....\n        if (did_disable) {\n            logger.debug(\"Checking whole form after element was disabled.\");\n            for (const _input of this.inputs.filter((it) => it !== input)) {\n                this.check_input({ input: _input, stop: true });\n            }\n        }\n    }\n\n    error_template(message) {\n        // Template for the validation message\n        return `<em class=\"validation warning message\">${message}</em>`;\n    }\n}\n\nregistry.register(Pattern);\n\nexport default Pattern;\nexport { Pattern };\n","import Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"contentrules\",\n    trigger: \"form[name='ruleSettings']\",\n\n    async init() {\n        // Async import implementation to reduce bundle size for controlpanels\n        const implementation = (await import(\"./contentrules--implementation\")).default;\n        const instance = new implementation(this.el);\n        instance.init();\n    },\n});\n","import Base from \"@patternslib/patternslib/src/core/base\";\nimport dom from \"@patternslib/patternslib/src/core/dom\";\n\nexport default Base.extend({\n    name: \"cookietrigger\",\n    trigger: \".pat-cookietrigger\",\n    parser: \"mockup\",\n\n    isCookiesEnabled: function () {\n        /* Test whether cookies are enabled by attempting to set a cookie\n         * and then change its value set test cookie.\n         */\n        var c = \"areYourCookiesEnabled=0\";\n        document.cookie = c;\n        var dc = document.cookie;\n        // cookie not set?  fail\n        if (dc.indexOf(c) === -1) {\n            return 0;\n        }\n        // change test cookie\n        c = \"areYourCookiesEnabled=1\";\n        document.cookie = c;\n        dc = document.cookie;\n        // cookie not changed?  fail\n        if (dc.indexOf(c) === -1) {\n            return 0;\n        }\n        // delete cookie\n        document.cookie = \"areYourCookiesEnabled=; expires=Thu, 01-Jan-70 00:00:01 GMT\";\n        return 1;\n    },\n\n    showIfCookiesDisabled: function () {\n        /* Show the element on which this pattern is defined if cookies are\n         * disabled.\n         */\n        if (this.isCookiesEnabled()) {\n            dom.hide(this.el);\n        } else {\n            dom.show(this.el);\n        }\n    },\n\n    init: function () {\n        this.showIfCookiesDisabled();\n    },\n});\n","import $ from \"jquery\";\nimport dom from \"./dom\";\n\nconst _MS_PER_DAY = 1000 * 60 * 60 * 24; // Milliseconds per day.\n\n$.fn.safeClone = function () {\n    var $clone = this.clone();\n    return $clone;\n};\n\n// Production steps of ECMA-262, Edition 5, 15.4.4.18\n// Reference: http://es5.github.io/#x15.4.4.18\nif (!Array.prototype.forEach) {\n    Array.prototype.forEach = function (callback, thisArg) {\n        var T, k;\n        if (this === null) {\n            throw new TypeError(\" this is null or not defined\");\n        }\n        // 1. Let O be the result of calling ToObject passing the |this| value as the argument.\n        var O = Object(this);\n        // 2. Let lenValue be the result of calling the Get internal method of O with the argument \"length\".\n        // 3. Let len be ToUint32(lenValue).\n        var len = O.length >>> 0;\n        // 4. If IsCallable(callback) is false, throw a TypeError exception.\n        // See: http://es5.github.com/#x9.11\n        if (typeof callback !== \"function\") {\n            throw new TypeError(callback + \" is not a function\");\n        }\n        // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.\n        if (arguments.length > 1) {\n            T = thisArg;\n        }\n        // 6. Let k be 0\n        k = 0;\n        // 7. Repeat, while k < len\n        while (k < len) {\n            var kValue;\n            // a. Let Pk be ToString(k).\n            //   This is implicit for LHS operands of the in operator\n            // b. Let kPresent be the result of calling the HasProperty internal method of O with argument Pk.\n            //   This step can be combined with c\n            // c. If kPresent is true, then\n            if (k in O) {\n                // i. Let kValue be the result of calling the Get internal method of O with argument Pk.\n                kValue = O[k];\n                // ii. Call the Call internal method of callback with T as the this value and\n                // argument list containing kValue, k, and O.\n                callback.call(T, kValue, k, O);\n            }\n            // d. Increase k by 1.\n            k++;\n        }\n        // 8. return undefined\n    };\n}\n\nvar singleBoundJQueryPlugin = function (pattern, method, options) {\n    /* This is a jQuery plugin for patterns which are invoked ONCE FOR EACH\n     * matched element in the DOM.\n     *\n     * This is how the Mockup-type patterns behave. They are constructor\n     * functions which need to be invoked once per jQuery-wrapped DOM node\n     * for all DOM nodes on which the pattern applies.\n     */\n    var $this = this;\n    $this.each(function () {\n        var pat,\n            $el = $(this);\n        pat = pattern.init($el, options);\n        if (method) {\n            if (pat[method] === undefined) {\n                $.error(\n                    \"Method \" + method + \" does not exist on jQuery.\" + pattern.name\n                );\n                return false;\n            }\n            if (method.charAt(0) === \"_\") {\n                $.error(\"Method \" + method + \" is private on jQuery.\" + pattern.name);\n                return false;\n            }\n            pat[method].apply(pat, [options]);\n        }\n    });\n    return $this;\n};\n\nvar pluralBoundJQueryPlugin = function (pattern, method, options) {\n    /* This is a jQuery plugin for patterns which are invoked ONCE FOR ALL\n     * matched elements in the DOM.\n     *\n     * This is how the vanilla Patternslib-type patterns behave. They are\n     * simple objects with an init method and this method gets called once\n     * with a list of jQuery-wrapped DOM nodes on which the pattern\n     * applies.\n     */\n    var $this = this;\n    if (method) {\n        if (pattern[method]) {\n            return pattern[method].apply($this, [$this].concat([options]));\n        } else {\n            $.error(\"Method \" + method + \" does not exist on jQuery.\" + pattern.name);\n        }\n    } else {\n        pattern.init.apply($this, [$this].concat([options]));\n    }\n    return $this;\n};\n\nvar jqueryPlugin = function (pattern) {\n    return function (method, options) {\n        var $this = this;\n        if ($this.length === 0) {\n            return $this;\n        }\n        if (typeof method === \"object\") {\n            options = method;\n            method = undefined;\n        }\n        if (typeof pattern === \"function\") {\n            return singleBoundJQueryPlugin.call(this, pattern, method, options);\n        } else {\n            return pluralBoundJQueryPlugin.call(this, pattern, method, options);\n        }\n    };\n};\n\n// Is a given variable an object?\nfunction isObject(obj) {\n    var type = typeof obj;\n    return type === \"function\" || (type === \"object\" && !!obj);\n}\n\n// Extend a given object with all the properties in passed-in object(s).\nfunction extend(obj) {\n    if (!isObject(obj)) return obj;\n    var source, prop;\n    for (var i = 1, length = arguments.length; i < length; i++) {\n        source = arguments[i];\n        for (prop in source) {\n            if (hasOwnProperty.call(source, prop)) {\n                obj[prop] = source[prop];\n            }\n        }\n    }\n    return obj;\n}\n// END: Taken from Underscore.js until here.\n\nfunction findLabel(input) {\n    var $label;\n    for (\n        var label = input.parentNode;\n        label && label.nodeType !== 11;\n        label = label.parentNode\n    ) {\n        if (label.tagName === \"LABEL\") {\n            return label;\n        }\n    }\n    if (input.id) {\n        $label = $('label[for=\"' + input.id + '\"]');\n    }\n    if ($label && $label.length === 0 && input.form) {\n        $label = $('label[for=\"' + input.name + '\"]', input.form);\n    }\n    if ($label && $label.length) {\n        return $label[0];\n    } else {\n        return null;\n    }\n}\n\n// Taken from http://stackoverflow.com/questions/3446170/escape-string-for-use-in-javascript-regex\nfunction escapeRegExp(str) {\n    return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n}\n\n/**\n * Create a RegExp object of a wildcard search string.\n *\n * @param {string} wildcard: A search string which can contain wildcards \"*\".\n *                           The wildcard \"*\" can be anywhere in the string and\n *                           can also be used multiple times. If no wildcard is\n *                           present the search string is used for an exact match.\n\n * @returns {RegExp}: A RegExp object which can be used to match strings.\n */\nfunction regexp_from_wildcard(wildcard) {\n    let regexp = wildcard.replace(/[\\-\\[\\]{}()+?.,\\\\\\^$|#\\s]/g, \"\\\\$&\");\n    regexp = regexp.replace(/[*]/g, \".*\");\n    regexp = new RegExp(`^${regexp}$`);\n    return regexp;\n}\n\n/**\n * Remove classes from a list of targets if they match a specific pattern.\n *\n * @param {Node, NodeList} targets: Dom Node or NodeList where the classes should be removed.\n * @param {string} classes: String matching classes to be removed.\n *                          You can add a \"*\" as wildcard to search for classes to be removed.\n *                          E.g. \"icon-*-alert\" to remove any of \"icon-1-alert icon-2-alert\".\n *\n * @returns {undefined}: This method directly operates on the targets.\n */\nfunction removeWildcardClass(targets, classes) {\n    targets = utils.ensureArray(targets);\n\n    if (classes.indexOf(\"*\") === -1) {\n        for (const target of targets) {\n            target.classList.remove(classes);\n        }\n    } else {\n        const matcher = regexp_from_wildcard(classes);\n        for (const target of targets) {\n            const class_list = (target.getAttribute(\"class\") || \"\").split(/\\s+/);\n            if (!class_list.length) {\n                continue;\n            }\n            const ok = class_list.filter((it) => !matcher.test(it));\n            if (ok.length) {\n                target.setAttribute(\"class\", ok.join(\" \"));\n            } else {\n                target.removeAttribute(\"class\");\n            }\n        }\n    }\n}\n\nfunction hasValue(el) {\n    if (el.tagName === \"INPUT\") {\n        if (el.type === \"checkbox\" || el.type === \"radio\") {\n            return el.checked;\n        }\n        return el.value !== \"\";\n    }\n    if (el.tagName === \"SELECT\") {\n        return el.selectedIndex !== -1;\n    }\n    if (el.tagName === \"TEXTAREA\") {\n        return el.value !== \"\";\n    }\n    return false;\n}\n\nconst hideOrShow = (nodes, visible, options, pattern_name) => {\n    nodes = dom.toNodeArray(nodes);\n\n    const transitions = {\n        none: { hide: \"hide\", show: \"show\" },\n        fade: { hide: \"fadeOut\", show: \"fadeIn\" },\n        slide: { hide: \"slideUp\", show: \"slideDown\" },\n    };\n\n    const duration =\n        options.transition === \"css\" || options.transition === \"none\"\n            ? null\n            : options.effect.duration;\n\n    const on_complete = (el) => {\n        el.classList.remove(\"in-progress\");\n        el.classList.add(visible ? \"visible\" : \"hidden\");\n        $(el).trigger(\"pat-update\", {\n            pattern: pattern_name,\n            action: \"attribute-changed\",\n            dom: el,\n            transition: \"complete\",\n        });\n    };\n\n    for (const el of nodes) {\n        el.classList.remove(\"visible\");\n        el.classList.remove(\"hidden\");\n        el.classList.remove(\"in-progress\");\n\n        if (duration) {\n            const t = transitions[options.transition];\n            el.classList.add(\"in-progress\");\n            $(el).trigger(\"pat-update\", {\n                pattern: pattern_name,\n                action: \"attribute-changed\",\n                dom: el,\n                transition: \"start\",\n            });\n            $(el)[visible ? t.show : t.hide]({\n                duration: duration,\n                easing: options.effect.easing,\n                complete: () => on_complete(el),\n            });\n        } else {\n            if (options.transition !== \"css\") {\n                dom[visible ? \"show\" : \"hide\"](el);\n            }\n            on_complete(el);\n        }\n    }\n};\n\nfunction addURLQueryParameter(fullURL, param, value) {\n    /* Using a positive lookahead (?=\\=) to find the given parameter,\n     * preceded by a ? or &, and followed by a = with a value after\n     * than (using a non-greedy selector) and then followed by\n     * a & or the end of the string.\n     *\n     * Taken from http://stackoverflow.com/questions/7640270/adding-modify-query-string-get-variables-in-a-url-with-javascript\n     */\n    var val = new RegExp(\"(\\\\?|\\\\&)\" + param + \"=.*?(?=(&|$))\"),\n        parts = fullURL.toString().split(\"#\"),\n        url = parts[0],\n        hash = parts[1],\n        qstring = /\\?.+$/,\n        newURL = url;\n    // Check if the parameter exists\n    if (val.test(url)) {\n        // if it does, replace it, using the captured group\n        // to determine & or ? at the beginning\n        newURL = url.replace(val, \"$1\" + param + \"=\" + value);\n    } else if (qstring.test(url)) {\n        // otherwise, if there is a query string at all\n        // add the param to the end of it\n        newURL = url + \"&\" + param + \"=\" + value;\n    } else {\n        // if there's no query string, add one\n        newURL = url + \"?\" + param + \"=\" + value;\n    }\n    if (hash) {\n        newURL += \"#\" + hash;\n    }\n    return newURL;\n}\n\nfunction removeDuplicateObjects(objs) {\n    /* Given an array of objects, remove any duplicate objects which might\n     * be present.\n     */\n    const comparator = function (k, v) {\n        return this[k] === v;\n    };\n\n    return objs.reduce(function (list, next_obj) {\n        let is_duplicate = false;\n        for (const obj of list) {\n            is_duplicate =\n                Object.keys(obj).length === Object.keys(next_obj).length &&\n                Object.entries(obj).filter(\n                    (it) => !comparator.bind(next_obj)(it[0], it[1])\n                ).length === 0;\n        }\n        if (!is_duplicate) {\n            list.push(next_obj);\n        }\n        return list;\n    }, []);\n}\n\nfunction mergeStack(stack, length) {\n    /* Given a list of lists of objects (which for brevity we call a stack),\n     * return a list of objects where each object is the merge of all the\n     * corresponding original objects at that particular index.\n     *\n     * If a certain sub-list doesn't have an object at that particular\n     * index, the last object in that list is merged.\n     */\n    const results = [];\n    for (let i = 0; i < length; i++) {\n        results.push({});\n    }\n    for (const frame of stack) {\n        const frame_length = frame.length - 1;\n        for (let x = 0; x < length; x++) {\n            results[x] = $.extend(\n                results[x] || {},\n                frame[x > frame_length ? frame_length : x]\n            );\n        }\n    }\n    return results;\n}\n\nfunction isElementInViewport(el, partial = false, offset = 0) {\n    /* returns true if element is visible to the user ie. is in the viewport.\n     * Setting partial parameter to true, will only check if a part of the element is visible\n     * in the viewport, specifically that some part of that element is touching the top part\n     * of the viewport. This only applies to the vertical direction, ie. doesnt check partial\n     * visibility for horizontal scrolling\n     * some code taken from:\n     * http://stackoverflow.com/questions/123999/how-to-tell-if-a-dom-element-is-visible-in-the-current-viewport/7557433#7557433\n     */\n    if (el instanceof $) {\n        el = el[0];\n    }\n\n    const rec = el.getBoundingClientRect();\n    const rec_values = [rec.top, rec.bottom, rec.left, rec.right];\n\n    if (rec_values.every((val) => val === 0)) {\n        // if every property of rec is 0, the element is invisible;\n        return false;\n    } else if (partial) {\n        // when using getBoundingClientRect() (in the vertical case)\n        // negative means above top of viewport, positive means below top of viewport\n        // therefore for part of the element to be touching or crossing the top of the viewport\n        // rec.top must <= 0 and rec.bottom must >= 0\n        // an optional tolerance offset can be added for when the desired element is not exactly\n        // toucing the top of the viewport but needs to be considered as touching.\n        return (\n            rec.top <= 0 + offset && rec.bottom >= 0 + offset\n            //(rec.top >= 0+offset && rec.top <= window.innerHeight) // this checks if the element\n            // touches bottom part of viewport\n            // XXX do we want to include a check for the padding of an element?\n            // using window.getComputedStyle(target).paddingTop\n        );\n    } else {\n        // this will return true if the entire element is completely in the viewport\n        return (\n            rec.top >= 0 &&\n            rec.left >= 0 &&\n            rec.bottom <=\n                (window.innerHeight || document.documentElement.clientHeight) &&\n            rec.right <= (window.innerWidth || document.documentElement.clientWidth)\n        );\n    }\n}\n\n/* parseTime - Parse a duration from a string and return the parsed time in milliseconds.\n *\n * @param {String} time - A duration/time string like ``1ms``, ``1s`` or ``1m``.\n *\n * @returns {Number} - A integer which represents the parsed time in milliseconds.\n */\nfunction parseTime(time) {\n    var m = /^(\\d+(?:\\.\\d+)?)\\s*(\\w*)/.exec(time);\n    if (!m) {\n        throw new Error(\"Invalid time\");\n    }\n    var amount = parseFloat(m[1]);\n    switch (m[2]) {\n        case \"s\":\n            return Math.round(amount * 1000);\n        case \"m\":\n            return Math.round(amount * 1000 * 60);\n        case \"ms\":\n        default:\n            return Math.round(amount);\n    }\n}\n\n/*\n\n * parseLength - Parse a length from a string and return the parsed length in\n * pixels.\n\n * @param {String} length - A length string like `1px` or `25%`. Lengths without a unit are treated as pixels.\n * @param {Number} reference_length - The reference length to use for percentage lengths.\n *\n * @returns {Number} - A integer which represents the parsed length in pixels.\n *\n * @throws {Error} - If the length string is invalid.\n *\n * @example\n * parseLength(\"1px\"); // 1\n * parseLength(\"10%\", 100); // 10\n *\n */\nfunction parseLength(length, reference_length = null) {\n    const m = /^(\\d+(?:\\.\\d+)?)\\s*(\\%?\\w*)/.exec(length);\n    if (!m) {\n        throw new Error(\"Invalid length\");\n    }\n    const amount = parseFloat(m[1]);\n    switch (m[2]) {\n        case \"px\":\n            return Math.round(amount);\n        case \"%\":\n            if (!reference_length) {\n                return 0;\n            }\n            return (reference_length / 100) * Math.round(amount);\n        case \"vw\":\n            return Math.round((amount * window.innerWidth) / 100);\n        case \"vh\":\n            return Math.round((amount * window.innerHeight) / 100);\n        case \"vmin\":\n            return Math.round(\n                (amount * Math.min(window.innerWidth, window.innerHeight)) / 100\n            );\n        case \"vmax\":\n            return Math.round(\n                (amount * Math.max(window.innerWidth, window.innerHeight)) / 100\n            );\n        default:\n            return Math.round(amount);\n    }\n}\n\n// Return a jQuery object with elements related to an input element.\nfunction findRelatives(el) {\n    var $el = $(el),\n        $relatives = $(el),\n        $label = $();\n\n    $relatives = $relatives.add($el.closest(\"label\"));\n    $relatives = $relatives.add($el.closest(\"fieldset\"));\n\n    if (el.id) $label = $(\"label[for='\" + el.id + \"']\");\n    if (!$label.length) {\n        var $form = $el.closest(\"form\");\n        if (!$form.length) $form = $(document.body);\n        $label = $form.find(\"label[for='\" + el.name + \"']\");\n    }\n    $relatives = $relatives.add($label);\n    return $relatives;\n}\n\nfunction get_bounds(el) {\n    // Return bounds of an element with it's values rounded and converted to ints.\n    const bounds = el.getBoundingClientRect();\n    return {\n        x: parseInt(Math.round(bounds.x), 10) || 0,\n        y: parseInt(Math.round(bounds.y), 10) || 0,\n        top: parseInt(Math.round(bounds.top), 10) || 0,\n        bottom: parseInt(Math.round(bounds.bottom), 10) || 0,\n        left: parseInt(Math.round(bounds.left), 10) || 0,\n        right: parseInt(Math.round(bounds.right), 10) || 0,\n        width: parseInt(Math.round(bounds.width), 10) || 0,\n        height: parseInt(Math.round(bounds.height), 10) || 0,\n    };\n}\n\nfunction checkInputSupport(type, invalid_value) {\n    /* Check input type support.\n     *  See: https://stackoverflow.com/a/10199306/1337474\n     */\n    let support = false;\n    const input = document.createElement(\"input\");\n    input.setAttribute(\"type\", type);\n    support = input.type == type;\n\n    if (invalid_value !== undefined) {\n        // Check for input type UI support\n        input.setAttribute(\"value\", invalid_value);\n        support = input.value !== invalid_value;\n    }\n    return support;\n}\n\nconst checkCSSFeature = (attribute, value, tag = \"div\") => {\n    /* Check for browser support of specific CSS feature.\n     */\n    tag = document.createElement(tag);\n    let supported = tag.style[attribute] !== undefined;\n    if (supported && value !== undefined) {\n        tag.style[attribute] = value;\n        supported = tag.style[attribute] === value;\n    }\n    return supported;\n};\n\nconst animation_frame = () => {\n    // Return promise to await next repaint cycle\n    // Use it in your async function like so: ``await utils.animation_frame()``\n    // From: http://www.albertlobo.com/fractals/async-await-requestanimationframe-buddhabrot\n    return new Promise(window.requestAnimationFrame);\n};\n\nconst timeout = (ms) => {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n};\n\n/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds.\n * From: https://underscorejs.org/#debounce\n *\n * @param {Function} func - The function to debounce.\n * @param {Number} ms - The time in milliseconds to debounce.\n * @param {Object} timer - A module-global timer as an object.\n * @param {Boolean} [postpone=true] - If true, the function will only be called\n * at the end, after it stops being called for N milliseconds. If false, the\n * function will be called no more than each [ms] milliseconds, ensuring that\n * the function isn't postponed for for too long.\n *\n * @returns {Function} - The debounced function.\n */\nconst debounce = (func, ms, timer = { timer: null }, postpone = true) => {\n    // Returns a function, that, as long as it continues to be invoked, will not\n    // be triggered. The function will be called after it stops being called for\n    // N milliseconds.\n    // From: https://underscorejs.org/#debounce\n    //\n    // Make sure to initialize ``debounce`` only once per to-be-debounced\n    // function to not reinitialize the timer each time and debounce not being\n    // able to cancel previouse runs.\n    //\n    // Pass a module-global timer as an object ``{ timer: null }`` if you want\n    // to also cancel debounced functions from other pattern-invocations.\n    timer.last_run = 0;\n    return function () {\n        const args = arguments;\n        if (!postpone && timer.timer && Date.now() - timer.last_run <= ms) {\n            return;\n        }\n        clearTimeout(timer.timer);\n        timer.last_run = Date.now();\n        timer.timer = setTimeout(() => {\n            func.apply(this, args);\n        }, ms);\n    };\n};\n\n// TODO: Remove in next major release.\nconst isIE = () => {\n    // See: https://stackoverflow.com/a/9851769/1337474\n    // Internet Explorer 6-11\n    // eslint-disable-next-line no-constant-binary-expression\n    return /*@cc_on!@*/false || !!document.documentMode;\n};\n\nconst jqToNode = (el) => {\n    // Return a DOM node if a jQuery node was passed.\n    if (el.jquery) {\n        el = el[0];\n    }\n    return el;\n};\n\n/**\n * Always return an iterable object.\n *\n * @param {any} it: The object which needs to be wrapped in an array or returned as is if it is iterable.\n * @param {boolean} force_array: If the object is iterable but not an Array, convert it to an array (e.g. For jQuery items or NodeList objects).\n *\n * @returns {Array}: Returns the object wrapped in an Array, expanded to an Array or as-is if it is already iterable.\n */\nconst ensureArray = (it, force_array) => {\n    // Ensure to return always an array\n    const array_like = !!(\n        NodeList.prototype.isPrototypeOf(it) || // eslint-disable-line no-prototype-builtins\n        Array.isArray(it) ||\n        it.jquery\n    );\n    return array_like ? (force_array ? [...it] : it) : [it];\n};\n\nconst localized_isodate = (date) => {\n    // Return a iso date (date only) in the current timezone instead of a\n    // UTC ISO 8601 date+time component which toISOString returns.\n\n    const day = date.getDate().toString().padStart(2, \"0\");\n    const month = (date.getMonth() + 1).toString().padStart(2, \"0\");\n    const year = date.getFullYear().toString();\n\n    return `${year}-${month}-${day}`;\n};\n\n/**\n * Replace HTML reserved characters with html entities to add HTML for user\n * editing to e.g. a textarea or a contenteditable.\n *\n * See:\n *  https://stackoverflow.com/a/22706073/1337474\n *  https://developer.mozilla.org/en-US/docs/Glossary/Entity#reserved_characters\n *\n * @param {string} html - The HTML string to encode.\n *\n * @returns {string} - Returns the escaped html string:\n *                     ``&`` will be replaced with ``&amp;``.\n *                     ``<`` will be repalced with ``&lt;``,\n *                     ``>`` will be replaced with ``&gt;``,\n *                     ``\"`` will be replaced with ``&quot;``.\n */\nconst escape_html = (html) => {\n    if (!html) {\n        return \"\";\n    }\n    const el = document.createElement(\"div\");\n    el.appendChild(document.createTextNode(html));\n    // Return escaped html and also replace quotes.\n    return el.innerHTML.replace(/\"/g, \"&quot;\");\n};\n\n/**\n * Return unescaped, raw HTML from an escaped HTML  string.\n *\n * See:\n *  https://stackoverflow.com/a/34064434/1337474\n *  https://developer.mozilla.org/en-US/docs/Glossary/Entity#reserved_characters\n *\n * @param {string} escaped_html - The HTML string to decode.\n *\n * @returns {string} - Returns the escaped html string:\n *                     ``&amp;`` will be replaced with ``&``,\n *                     ``&lt;`` will be repalced with ``<``,\n *                     ``&gt;`` will be replaced with ``>``,\n *                     ``&quot;`` will be replaced with ``\"``.\n */\nconst unescape_html = (escaped_html) => {\n    if (!escaped_html) {\n        return \"\";\n    }\n    const doc = new DOMParser().parseFromString(escaped_html, \"text/html\");\n    // Return unescaped html and also unescape quote named entities.\n    return doc.documentElement.textContent.replace(/&quot;/g, '\"');\n};\n\n/**\n * Return true, if the given value is a valid ISO 8601 date/time string with or without an optional time component.\n *\n * @param {String} value - The date/time value to be checked.\n * @param {Boolean} [optional_time=false] - True, if time component is optional.\n * @return {Boolean} - True, if the given value is a valid Date string. False if not.\n */\nconst is_iso_date_time = (value, optional_time = false) => {\n    const re_date_time = optional_time\n        ? /^\\d{4}-[01]\\d-[0-3]\\d(T[0-2]\\d:[0-5]\\d)?$/\n        : /^\\d{4}-[01]\\d-[0-3]\\dT[0-2]\\d:[0-5]\\d$/;\n    return re_date_time.test(value);\n};\n\n/**\n * Return true, if the given value is a valid ISO 8601 date string and without a time component.\n *\n * @param {String} value - The date value to be checked.\n * @return {Boolean} - True, if the given value is a valid ISO 8601 date string without a time component. False if not.\n */\nconst is_iso_date = (value) => {\n    const re_date_time = /^\\d{4}-[01]\\d-[0-3]\\d$/;\n    return re_date_time.test(value);\n};\n\n/**\n * Return the number of days between two dates.\n * Based on: https://stackoverflow.com/a/15289883/1337474\n *\n * @param {Date} date_1 - First date to compare. We will substract date_2 from date_1.\n * @param {Date} date_2 - Second date to compare.\n * @return {Number} - The number of days between the two dates.\n */\nconst date_diff = (date_1, date_2) => {\n    // Discard the time and time-zone information.\n    const utc_1 = Date.UTC(date_1.getFullYear(), date_1.getMonth(), date_1.getDate());\n    const utc_2 = Date.UTC(date_2.getFullYear(), date_2.getMonth(), date_2.getDate());\n\n    return Math.floor((utc_1 - utc_2) / _MS_PER_DAY);\n};\n\n/**\n * Build intersection observer threshold list.\n *\n * See: https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API#building_the_array_of_threshold_ratios\n *\n * @param {Number} num_steps - The number of steps to use.\n *\n * @returns {Array} - Returns the threshold list.\n */\nconst threshold_list = (num_steps = 0) => {\n    let thresholds = [];\n\n    for (let i = 1.0; i <= num_steps; i++) {\n        thresholds.push(i / num_steps);\n    }\n    thresholds.push(0);\n    return thresholds.sort();\n};\n\n/**\n * is_option_truthy - Check if an Pattern option is set.\n *\n * An option is set if it is not one of:\n * - undefined\n * - null\n * - \"none\"\n * - \"\"\n *\n * @param {String} option - The option to check.\n *\n * @returns {Boolean} - Returns true if the option is set, false otherwise.\n *\n * @example\n *\n * is_option_truthy() // false\n * is_option_truthy(undefined) // false\n * is_option_truthy(null) // false\n * is_option_truthy(\"\") // false\n * is_option_truthy(\"none\") // false\n * is_option_truthy(\"false\") // false\n * is_option_truthy(\"foo\") // true\n * is_option_truthy(true) // true\n * is_option_truthy(0) // true\n *\n */\nconst is_option_truthy = (option) => {\n    return ![undefined, null, \"none\", false, \"false\", \"\"].includes(option);\n};\n\nvar utils = {\n    jqueryPlugin: jqueryPlugin,\n    escapeRegExp: escapeRegExp,\n    isObject: isObject,\n    extend: extend,\n    findLabel: findLabel,\n    regexp_from_wildcard: regexp_from_wildcard,\n    removeWildcardClass: removeWildcardClass,\n    hideOrShow: hideOrShow,\n    addURLQueryParameter: addURLQueryParameter,\n    removeDuplicateObjects: removeDuplicateObjects,\n    mergeStack: mergeStack,\n    isElementInViewport: isElementInViewport,\n    hasValue: hasValue,\n    parseTime: parseTime,\n    parseLength: parseLength,\n    findRelatives: findRelatives,\n    get_bounds: get_bounds,\n    checkInputSupport: checkInputSupport,\n    checkCSSFeature: checkCSSFeature,\n    animation_frame: animation_frame,\n    timeout: timeout,\n    debounce: debounce,\n    isIE: isIE,\n    jqToNode: jqToNode,\n    ensureArray: ensureArray,\n    localized_isodate: localized_isodate,\n    escape_html: escape_html,\n    unescape_html: unescape_html,\n    is_iso_date_time: is_iso_date_time,\n    is_iso_date: is_iso_date,\n    date_diff: date_diff,\n    threshold_list: threshold_list,\n    is_option_truthy: is_option_truthy,\n    //getCSSValue: dom.get_css_value, // BBB: moved to dom. TODO: Remove in upcoming version.\n    elementInViewport: (el) => {\n        // BBB: Remove with next major version.\n        console.warn(\"Deprecated. Use utils.isElementInViewport\");\n        return isElementInViewport(el);\n    },\n};\n\nexport default utils;\n","import $ from \"jquery\";\nimport { BasePattern } from \"@patternslib/patternslib/src/core/basepattern\";\nimport events from \"../../core/events\";\nimport dom from \"../../core/dom\";\nimport logging from \"../../core/logging\";\nimport Parser from \"@patternslib/patternslib/src/core/parser\";\nimport registry from \"@patternslib/patternslib/src/core/registry\";\nimport utils from \"../../core/utils\";\n\nconst log = logging.getLogger(\"depends\");\n\nexport const parser = new Parser(\"depends\");\nparser.addArgument(\"condition\");\nparser.addArgument(\"action\", \"show\", [\"show\", \"enable\", \"both\"]);\nparser.addArgument(\"transition\", \"none\", [\"none\", \"css\", \"fade\", \"slide\"]);\nparser.addArgument(\"effect-duration\", \"fast\");\nparser.addArgument(\"effect-easing\", \"swing\");\n\n\n// A custom input event which differs from the one in `core/events` in that it\n// accepts a `detail` object to pass arbitrary information around.\n// TODO: The events in `core/events` should be refactored to accept a `detail`\n// object.\nconst input_event = (detail = {}) => {\n    return new CustomEvent(\"input\", {\n        bubbles: true,\n        cancelable: false,\n        detail: detail,\n    });\n};\n\n\nclass Pattern extends BasePattern {\n    static name = \"depends\";\n    static trigger = \".pat-depends\";\n    static parser = parser;\n\n    async init() {\n        this.$el = $(this.el);\n        const DependsHandler = (await import(\"../../lib/dependshandler\")).default; // prettier-ignore\n\n        try {\n            this.handler = new DependsHandler(this.el, this.options.condition);\n        } catch (e) {\n            log.error(\"Invalid condition: \" + e.message, this.el);\n            return;\n        }\n\n        // Initialize\n        this.set_state();\n\n        for (const input of this.handler.getAllInputs()) {\n            // Note: One input can be a dependency for multiple other dependent\n            // elements. Therefore we need to bind the events not uniquely and\n            // add a uuid to the event bindings id.\n\n            events.add_event_listener(\n                input,\n                \"input\",\n                `pat-depends--input--${this.uuid}`,\n                (e) => {\n                    if (e?.detail?.pattern_uuid === this.uuid) {\n                        // Ignore input events invoked from this pattern\n                        // instance to avoid infinite loops.\n                        return;\n                    }\n                    this.set_state();\n                }\n            );\n\n            if (input.form) {\n                events.add_event_listener(\n                    input.form,\n                    \"reset\",\n                    `pat-depends--reset--${this.uuid}`,\n                    async () => {\n                        // TODO: note sure, what this timeout is for.\n                        await utils.timeout(50);\n                        this.set_state.bind(this);\n                    }\n                );\n            }\n        }\n    }\n\n    update_modal() {\n        const modal = this.el.closest(\".pat-modal\");\n\n        // If we're in a modal, make sure that it gets resized.\n        if (modal) {\n            $(document).trigger(\"pat-update\", { pattern: \"depends\" });\n        }\n    }\n\n    enable() {\n        const inputs = dom.find_inputs(this.el);\n        for (const input of inputs) {\n            if (input.disabled === false) {\n                // Do not re-enable an already enabled input.\n                continue;\n            }\n\n            // Now, enable the input element.\n            input.disabled = false;\n\n            if (input === this.el) {\n                // Do not re-trigger this pattern on it's own element to avoid\n                // infinite loops.\n                continue;\n            }\n\n            if (dom.is_button(input)) {\n                // Do not trigger the input event on buttons as they do not\n                // support it.\n                continue;\n            }\n\n            // Trigger the input after enabling so that any other bound\n            // actions can react on that.\n            input.dispatchEvent(input_event({ pattern_uuid: this.uuid }));\n        }\n\n        // Restore the original click behavior for anchor elements.\n        if (this.el.tagName === \"A\") {\n            events.remove_event_listener(this.el, \"pat-depends--click\");\n        }\n\n        // Remove the disabled class from the element.\n        this.el.classList.remove(\"disabled\");\n\n        // Trigger the pat-update event to notify other patterns about enabling.\n        this.$el.trigger(\"pat-update\", {\n            pattern: \"depends\",\n            action: \"attribute-changed\",\n            dom: this.el,\n            enabled: true,\n        });\n    }\n\n    disable() {\n        const inputs = dom.find_inputs(this.el);\n        for (const input of inputs) {\n            if (input.disabled === true) {\n                // Do not re-disable an already disabled input.\n                continue;\n            }\n\n            // Now, disable the input element.\n            input.disabled = true;\n\n            if (input === this.el) {\n                // Do not re-trigger this pattern on it's own element to avoid\n                // infinite loops.\n                continue;\n            }\n\n            if (dom.is_button(input)) {\n                // Do not trigger the input event on buttons as they do not\n                // support it.\n                continue;\n            }\n\n            // Trigger the input after disabling so that any other bound\n            // actions can react on that.\n            input.dispatchEvent(input_event({ pattern_uuid: this.uuid }));\n        }\n\n        // Prevent the default click behavior for anchor elements.\n        if (this.el.tagName === \"A\") {\n            events.add_event_listener(this.el, \"click\", \"pat-depends--click\", (e) =>\n                e.preventDefault()\n            );\n        }\n\n        // Add the disabled class to the element.\n        this.el.classList.add(\"disabled\");\n\n        // Trigger the pat-update event to notify other patterns about disabling.\n        this.$el.trigger(\"pat-update\", {\n            pattern: \"depends\",\n            action: \"attribute-changed\",\n            dom: this.el,\n            enabled: false,\n        });\n    }\n\n    set_state() {\n        const state = this.handler.evaluate();\n        switch (this.options.action) {\n            case \"show\":\n                utils.hideOrShow(this.el, state, this.options, this.name);\n                this.update_modal();\n                break;\n            case \"enable\":\n                if (state) {\n                    this.enable();\n                } else {\n                    this.disable();\n                }\n                break;\n            case \"both\":\n                utils.hideOrShow(this.el, state, this.options, this.name);\n                this.update_modal();\n                if (state) {\n                    this.enable();\n                } else {\n                    this.disable();\n                }\n                break;\n        }\n    }\n}\n\n// Register Pattern class in the global pattern registry\nregistry.register(Pattern);\n\n// Make it available\nexport default Pattern;\n","import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport utils from \"@patternslib/patternslib/src/core/utils\";\n\nexport default Base.extend({\n    name: \"autotoc\",\n    trigger: \".pat-autotoc\",\n    parser: \"mockup\",\n    defaults: {\n        section: \"section\",\n        levels: \"h1,h2,h3\",\n        IDPrefix: \"autotoc-item-\",\n        classTOCName: \"autotoc-nav\",\n        classSectionName: \"autotoc-section\",\n        classLevelPrefixName: \"autotoc-level-\",\n        classActiveName: \"active\",\n        scrollDuration: \"slow\",\n        scrollEasing: \"swing\",\n        validationDelay: 200, // Note: This is set to twice as the default delay time for validation.\n    },\n\n    tabs: [],\n\n    init: function () {\n        import(\"./autotoc.scss\");\n\n        var self = this;\n\n        self.$toc = $(\"<nav/>\").addClass(self.options.classTOCName);\n\n        if (self.options.prependTo) {\n            self.$toc.prependTo(self.options.prependTo);\n        } else if (self.options.appendTo) {\n            self.$toc.appendTo(self.options.appendTo);\n        } else {\n            self.$toc.prependTo(self.$el);\n        }\n\n        if (self.options.className) {\n            self.$el.addClass(self.options.className);\n        }\n\n        $(self.options.section, self.$el).addClass(self.options.classSectionName);\n\n        var asTabs = self.$el.hasClass(\"autotabs\");\n\n        var activeId = null;\n\n        $(self.options.levels, self.$el).each(function (i) {\n            const section = this.closest(self.options.section);\n            const $level = $(this);\n            let id = $level.prop(\"id\") ? $level.prop(\"id\") : $(section).prop(\"id\");\n\n            if (!id || $(\"#\" + id).length > 0) {\n                id = self.options.IDPrefix + self.name + \"-\" + i;\n            }\n            if (window.location.hash === \"#\" + id) {\n                activeId = id;\n            }\n            if (activeId === null && $level.hasClass(self.options.classActiveName)) {\n                activeId = id;\n            }\n            $level.data(\"navref\", id);\n            const $nav = $(\"<a/>\");\n            $nav.appendTo(self.$toc)\n                .text($level.text())\n                .attr(\"id\", id)\n                .attr(\"href\", \"#\" + id)\n                .addClass(self.options.classLevelPrefixName + self.getLevel($level))\n                .on(\"click\", function (e, options) {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    if (!options) {\n                        options = {\n                            doScroll: true,\n                            skipHash: false,\n                        };\n                    }\n                    var $el = $(this);\n                    self.$toc\n                        .children(\".\" + self.options.classActiveName)\n                        .removeClass(self.options.classActiveName);\n                    self.$el\n                        .children(\".\" + self.options.classActiveName)\n                        .removeClass(self.options.classActiveName);\n                    $(e.target).addClass(self.options.classActiveName);\n                    $level\n                        .parents(self.options.section)\n                        .addClass(self.options.classActiveName);\n                    if (\n                        options.doScroll !== false &&\n                        self.options.scrollDuration &&\n                        $level &&\n                        !asTabs\n                    ) {\n                        $(\"body,html\").animate(\n                            {\n                                scrollTop: $level.offset().top,\n                            },\n                            self.options.scrollDuration,\n                            self.options.scrollEasing\n                        );\n                    }\n                    if (self.$el.parents(\".plone-modal\").length !== 0) {\n                        self.$el.trigger(\"resize.plone-modal.patterns\");\n                    }\n                    $(this).trigger(\"clicked\");\n                    if (!options.skipHash) {\n                        if (window.history && window.history.pushState) {\n                            window.history.pushState({}, \"\", \"#\" + $el.attr(\"id\"));\n                        }\n                    }\n                });\n            $level.data(\"autotoc-trigger-id\", id);\n\n            self.tabs.push({\n                section: section,\n                id: id,\n                nav: $nav[0],\n            });\n        });\n\n        if (activeId) {\n            $(\"a#\" + activeId).trigger(\"click\", {\n                doScroll: true,\n                skipHash: true,\n            });\n        } else {\n            self.$toc.find(\"a\").first().trigger(\"click\", {\n                doScroll: false,\n                skipHash: true,\n            });\n        }\n\n        // After DOM tree is built, initialize eventual validation\n        this.initialize_validation(self.$el);\n    },\n\n    initialize_validation: function ($el) {\n        const el = $el[0];\n\n        // Initialize only on forms\n        const form = el.closest(\"form\");\n        if (!form) {\n            return;\n        }\n\n        for (const tab of this.tabs) {\n            if (\n                tab.section.querySelectorAll(\n                    \"label.required, label .required, [required]\",\n                ).length > 0\n            ) {\n                tab.nav.classList.add(\"required\");\n            } else {\n                tab.nav.classList.remove(\"required\");\n            }\n        }\n\n        // Initialize the validation css class markings only for pat-validation forms.\n        if (!form.matches(\".pat-validation\")) {\n            return;\n        }\n\n        const debounced_validation_marker = utils.debounce(() => {\n            this.validation_marker();\n        }, this.options.validationDelay);\n\n        form.addEventListener(\"pat-update\", (e) => {\n            if (e.detail?.pattern !== \"validation\") {\n                // Nothing to do.\n                return;\n            }\n            debounced_validation_marker();\n        });\n    },\n\n    validation_marker: function () {\n        for (const tab of this.tabs) {\n            if (tab.section.querySelectorAll(\":invalid\").length > 0) {\n                tab.nav.classList.add(\"invalid\");\n            } else {\n                tab.nav.classList.remove(\"invalid\");\n            }\n        }\n    },\n\n    getLevel: function ($el) {\n        var elementLevel = 0;\n        $.each(this.options.levels.split(\",\"), function (level, levelSelector) {\n            if ($el.filter(levelSelector).length === 1) {\n                elementLevel = level + 1;\n                return false;\n            }\n        });\n        return elementLevel;\n    },\n});\n","/* i18n integration. This is forked from jarn.jsi18n\n *\n * This is a singleton.\n * Configuration is done on the body tag data-i18ncatalogurl attribute\n *     <body data-i18ncatalogurl=\"/plonejsi18n\">\n *\n *  Or, it'll default to \"/plonejsi18n\"\n */\n\nimport $ from \"jquery\";\n\nconst i18n = function () {\n    var self = this;\n    self.baseUrl = $(\"body\").attr(\"data-i18ncatalogurl\");\n    self.currentLanguage = $(\"html\").attr(\"lang\") || \"en\";\n\n    self.storage = null;\n    self.catalogs = {};\n    self.ttl = 24 * 3600 * 1000;\n\n    // Internet Explorer 8 does not know Date.now() which is used in e.g. loadCatalog, so we \"define\" it\n    if (!Date.now) {\n        Date.now = function () {\n            return new Date().valueOf();\n        };\n    }\n\n    try {\n        if (\n            \"localStorage\" in window &&\n            window.localStorage !== null &&\n            \"JSON\" in window &&\n            window.JSON !== null\n        ) {\n            self.storage = window.localStorage;\n        }\n    } catch {\n        console.log(\"Failed to set local storage\");\n    }\n\n    self.configure = function (config) {\n        for (var key in config) {\n            self[key] = config[key];\n        }\n    };\n\n    self._setCatalog = function (domain, language, catalog) {\n        if (domain in self.catalogs) {\n            self.catalogs[domain][language] = catalog;\n        } else {\n            self.catalogs[domain] = {};\n            self.catalogs[domain][language] = catalog;\n        }\n    };\n\n    self._storeCatalog = function (domain, language, catalog) {\n        var key = domain + \"-\" + language;\n        if (self.storage !== null && catalog !== null) {\n            self.storage.setItem(key, JSON.stringify(catalog));\n            self.storage.setItem(key + \"-updated\", Date.now());\n        }\n    };\n\n    self.getUrl = function (domain, language) {\n        return self.baseUrl + \"?domain=\" + domain + \"&language=\" + language;\n    };\n\n    self.loadCatalog = function (domain, language) {\n        if (language === undefined) {\n            language = self.currentLanguage;\n        }\n        if (self.storage !== null) {\n            var key = domain + \"-\" + language;\n            if (key in self.storage) {\n                if (\n                    Date.now() - parseInt(self.storage.getItem(key + \"-updated\"), 10) <\n                    self.ttl\n                ) {\n                    var catalog = JSON.parse(self.storage.getItem(key));\n                    self._setCatalog(domain, language, catalog);\n                    return;\n                }\n            }\n        }\n        if (!self.baseUrl) {\n            return;\n        }\n        $.getJSON(self.getUrl(domain, language), function (catalog) {\n            if (catalog === null) {\n                return;\n            }\n            self._setCatalog(domain, language, catalog);\n            self._storeCatalog(domain, language, catalog);\n        });\n    };\n\n    self.MessageFactory = function (domain, language) {\n        language = language || self.currentLanguage;\n        return function translate(msgid, keywords) {\n            var msgstr;\n            if (\n                domain in self.catalogs &&\n                language in self.catalogs[domain] &&\n                msgid in self.catalogs[domain][language]\n            ) {\n                msgstr = self.catalogs[domain][language][msgid];\n            } else {\n                msgstr = msgid;\n            }\n            if (keywords) {\n                var regexp, keyword;\n                for (keyword in keywords) {\n                    if (Object.prototype.hasOwnProperty.call(keywords, keyword)) {\n                        regexp = new RegExp(\"\\\\$\\\\{\" + keyword + \"\\\\}\", \"g\");\n                        msgstr = msgstr.replace(regexp, keywords[keyword]);\n                    }\n                }\n            }\n            return msgstr;\n        };\n    };\n};\n\nexport default i18n;\n","import Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"discussion\",\n    trigger: \"form#DiscussionSettingsEditForm\",\n\n    async init() {\n        // Async import implementation to reduce bundle size for controlpanels\n        const implementation = (await import(\"./discussion--implementation\")).default;\n        const instance = new implementation(this.el);\n        instance.init();\n    },\n});\n","/* i18n integration.\n *\n * This is a singleton.\n * Configuration is done on the body tag data-i18ncatalogurl attribute\n *     <body data-i18ncatalogurl=\"/plonejsi18n\">\n *\n *  Or, it'll default to \"/plonejsi18n\"\n */\n\nimport I18N from \"./i18n\";\n\n// we're creating a singleton here so we can potentially\n// delay the initialization of the translate catalog\n// until after the dom is available\nlet _translation_domains = {\n    plone: null,\n    widgets: null,\n};\n\nconst translate = function (domain, msgid, keywords) {\n    if (_translation_domains[domain] === null) {\n        var i18n = new I18N();\n        i18n.loadCatalog(domain);\n        _translation_domains[domain] = i18n.MessageFactory(domain);\n    }\n    return _translation_domains[domain](msgid, keywords);\n};\n\nconst translate_widgets = function (msgid, keywords) {\n    return translate(\"widgets\", msgid, keywords);\n};\n\nconst translate_plone = function (msgid, keywords) {\n    return translate(\"plone\", msgid, keywords);\n};\n\n// backwards compatibilty: \"widgets\" domain is default factory\nexport default translate_widgets;\n\n// explicit export of translation domain factories\nexport { translate_widgets, translate_plone };\n","import Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"dexterity-types-listing\",\n    trigger: \"form[action$='dexterity-types']\",\n\n    async init() {\n        // Async import implementation to reduce bundle size for controlpanels\n        const implementation = (\n            await import(\"./dexterity-types-listing--implementation\")\n        ).default;\n        const instance = new implementation(this.el);\n        instance.init();\n    },\n});\n","/**\n * Patterns logging - minimal logging framework\n *\n * Copyright 2012 Simplon B.V.\n */\n\n// source: https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind\nif (!Function.prototype.bind) {\n    Function.prototype.bind = function (oThis) {\n        if (typeof this !== \"function\") {\n            // closest thing possible to the ECMAScript 5 internal IsCallable function\n            throw new TypeError(\n                \"Function.prototype.bind - what is trying to be bound is not callable\"\n            );\n        }\n\n        var aArgs = Array.prototype.slice.call(arguments, 1),\n            fToBind = this,\n            fNOP = function () {},\n            fBound = function () {\n                return fToBind.apply(\n                    this instanceof fNOP && oThis ? this : oThis,\n                    aArgs.concat(Array.prototype.slice.call(arguments))\n                );\n            };\n        fNOP.prototype = this.prototype;\n        fBound.prototype = new fNOP();\n\n        return fBound;\n    };\n}\n\nvar root, // root logger instance\n    writer; // writer instance, used to output log entries\n\nvar Level = {\n    DEBUG: 10,\n    INFO: 20,\n    WARN: 30,\n    ERROR: 40,\n    FATAL: 50,\n};\n\nfunction ConsoleWriter() {}\n\nConsoleWriter.prototype = {\n    output: function (log_name, level, messages) {\n        if (log_name) messages.unshift(log_name + \":\");\n        if (level <= Level.DEBUG) console.debug.apply(console, messages);\n        else if (level <= Level.INFO) console.info.apply(console, messages);\n        else if (level <= Level.WARN) console.warn.apply(console, messages);\n        else console.error.apply(console, messages);\n    },\n};\n\nfunction Logger(name, parent) {\n    this._loggers = {};\n    this.name = name || \"\";\n    this._parent = parent || null;\n    if (!parent) {\n        this._enabled = true;\n        this._level = Level.WARN;\n    }\n}\n\nLogger.prototype = {\n    getLogger: function (name) {\n        var path = name.split(\".\"),\n            root = this,\n            route = this.name ? [this.name] : [];\n        while (path.length) {\n            var entry = path.shift();\n            route.push(entry);\n            if (!(entry in root._loggers))\n                root._loggers[entry] = new Logger(route.join(\".\"), root);\n            root = root._loggers[entry];\n        }\n        return root;\n    },\n\n    _getFlag: function (flag) {\n        var context = this;\n        flag = \"_\" + flag;\n        while (context !== null) {\n            if (context[flag] !== undefined) return context[flag];\n            context = context._parent;\n        }\n        return null;\n    },\n\n    setEnabled: function (state) {\n        this._enabled = !!state;\n    },\n\n    isEnabled: function () {\n        this._getFlag(\"enabled\");\n    },\n\n    setLevel: function (level) {\n        if (typeof level === \"number\") this._level = level;\n        else if (typeof level === \"string\") {\n            level = level.toUpperCase();\n            if (level in Level) this._level = Level[level];\n        }\n    },\n\n    getLevel: function () {\n        return this._getFlag(\"level\");\n    },\n\n    log: function (level, messages) {\n        if (\n            !messages.length ||\n            !this._getFlag(\"enabled\") ||\n            level < this._getFlag(\"level\")\n        )\n            return;\n        messages = Array.prototype.slice.call(messages);\n        writer.output(this.name, level, messages);\n    },\n\n    debug: function () {\n        this.log(Level.DEBUG, arguments);\n    },\n\n    info: function () {\n        this.log(Level.INFO, arguments);\n    },\n\n    warn: function () {\n        this.log(Level.WARN, arguments);\n    },\n\n    error: function () {\n        this.log(Level.ERROR, arguments);\n    },\n\n    fatal: function () {\n        this.log(Level.FATAL, arguments);\n    },\n};\n\nfunction getWriter() {\n    return writer;\n}\n\nfunction setWriter(w) {\n    writer = w;\n}\n\nsetWriter(new ConsoleWriter());\n\nroot = new Logger();\n\nvar logconfig = /loglevel(|-[^=]+)=([^&]+)/g,\n    match;\n\nwhile ((match = logconfig.exec(window.location.search)) !== null) {\n    var logger = match[1] === \"\" ? root : root.getLogger(match[1].slice(1));\n    logger.setLevel(match[2].toUpperCase());\n}\n\nvar api = {\n    Level: Level,\n    getLogger: root.getLogger.bind(root),\n    setEnabled: root.setEnabled.bind(root),\n    isEnabled: root.isEnabled.bind(root),\n    setLevel: root.setLevel.bind(root),\n    getLevel: root.getLevel.bind(root),\n    debug: root.debug.bind(root),\n    info: root.info.bind(root),\n    warn: root.warn.bind(root),\n    error: root.error.bind(root),\n    fatal: root.fatal.bind(root),\n    getWriter: getWriter,\n    setWriter: setWriter,\n};\n\nexport default api;\n","/* pat-datetime-picker  - Polyfill for input type=datetime-local */\nimport Base from \"../../core/base\";\nimport Parser from \"../../core/parser\";\nimport utils from \"../../core/utils\";\nimport dom from \"../../core/dom\";\n\nexport const parser = new Parser(\"datetime-picker\");\nparser.addArgument(\"format\", \"YYYY-MM-DD\");\nparser.addArgument(\"week-numbers\", [], [\"show\", \"hide\"]);\nparser.addArgument(\"i18n\"); // URL pointing to JSON resource with i18n values\nparser.addArgument(\"today\", \"Today\");\nparser.addArgument(\"clear\", \"Clear\");\nparser.addArgument(\"first-day\", 0);\n\nexport default Base.extend({\n    name: \"datetime-picker\",\n    trigger: \".pat-datetime-picker\",\n    parser: parser,\n    el_date: null,\n    el_time: null,\n\n    async init() {\n        const el = this.el;\n        this.options = parser.parse(this.el, this.options);\n\n        if (utils.checkInputSupport(\"datetime-local\", \"invalid date\")) {\n            return;\n        }\n\n        if (window.__patternslib_import_styles) {\n            import(\"./_datetime-picker.scss\");\n        }\n        const DatePicker = (await import(\"../date-picker/date-picker\")).default;\n\n        const value = this.el.value.split(\"T\");\n        const date_value = value[0] || \"\";\n        const time_value = value[1] || \"\";\n\n        const el_wrapper = document.createElement(\"div\");\n        el_wrapper.setAttribute(\"class\", \"pat-datetime-picker__wrapper\");\n\n        dom.hide(el);\n\n        // let the buttons be of type button otherwise they are submit buttons\n        const html_btn_now = `\n            <button type=\"button\" class=\"_btn _now\" title=\"${this.options.today}\">\n                <span class=\"_icon\"/>\n                <span class=\"_text\">${this.options.today}</span>\n            </button>`;\n        const html_btn_clear = `\n            <button type=\"button\" class=\"_btn _clear\" title=\"${this.options.clear}\">\n                <span class=\"_icon\"/>\n                <span class=\"_text\">${this.options.clear}</span>\n            </button>`;\n\n        el_wrapper.innerHTML = `\n            <input type=\"date\" placeholder=\"YYYY-MM-DD\" value=\"${date_value}\" />\n            <input type=\"time\" placeholder=\"hh:mm\" value=\"${time_value}\" />\n            ${this.options.today ? html_btn_now : \"\"}\n            ${this.options.clear ? html_btn_clear : \"\"}\n        `;\n\n        this.el_time = el_wrapper.querySelector(\"input[type=time]\");\n        this.el_time.addEventListener(\"change\", () => this.update());\n\n        this.el_date = el_wrapper.querySelector(\"input[type=date]\");\n        this.el_date.addEventListener(\"change\", () => {\n            if (!this.el_time.value) {\n                // Set time on date change, if time was empty.\n                this.el_time.value = this.isotime();\n            }\n            this.update();\n        });\n\n        const date_options = {\n            behavior: \"native\",\n            format: this.options.format,\n            weekNumbers: this.options.weekNumbers,\n            firstDay: this.options.firstDay,\n        };\n        await DatePicker.init(this.el_date, date_options);\n\n        if (this.options.today) {\n            const btn_now = el_wrapper.querySelector(\"._btn._now\");\n            btn_now.addEventListener(\"click\", (e) => {\n                e.preventDefault();\n                this.el_date.value = this.isodate();\n                this.el_time.value = this.isotime();\n                this.update();\n            });\n        }\n\n        if (this.options.clear) {\n            const btn_clear = el_wrapper.querySelector(\"._btn._clear\");\n            btn_clear.addEventListener(\"click\", (e) => {\n                e.preventDefault();\n                this.el_date.value = \"\";\n                this.el_time.value = \"\";\n                this.update();\n            });\n        }\n\n        // TODO: timezone\n        el.parentNode.insertBefore(el_wrapper, el);\n    },\n\n    update() {\n        if (this.el_date.value && this.el_time.value) {\n            this.el.value = `${this.el_date.value}T${this.el_time.value}`;\n        } else {\n            this.el.value = \"\";\n        }\n        this.el.dispatchEvent(new Event(\"change\", { bubbles: true, cancelable: true }));\n    },\n\n    isodate() {\n        const now = new Date();\n        return now.toISOString().substr(0, 10);\n    },\n\n    isotime() {\n        const now = new Date();\n        return now.toTimeString().substr(0, 5);\n    },\n});\n","// Plone extended search.\nimport $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport utils from \"../../core/utils\";\n\nexport default Base.extend({\n    name: \"search\",\n    trigger: \".pat-search\",\n    init: function () {\n        var loading = new utils.Loading();\n\n        var $filter = $(\"#search-filter\");\n        var $filterBtn = $(\"#search-filter-toggle\", $filter);\n        var $advSearchInput = $(\"#advanced-search-input\");\n        var $ctSelectAll = $(\"#pt_toggle\");\n        var $selectAllContainer = $(\".search-type-options\");\n        var $sortingContainer = $(\"#sorting-options\");\n\n        /* handle history */\n        if (window.history && window.history.pushState) {\n            $(window).on(\"popstate\", function () {\n                /* we're just going to cheat and reload the page so\n                   we aren't keep moving around state here..\n                   Here, I'm lazy, we're not using react here... */\n                window.location = window.location.href;\n            });\n        }\n\n        var pushHistory = function () {\n            if (window.history && window.history.pushState) {\n                var url =\n                    window.location.origin +\n                    window.location.pathname +\n                    \"?\" +\n                    $(\"#searchform\").serialize();\n                window.history.pushState(null, null, url);\n            }\n        };\n\n        var timeout = 0;\n        var search = function () {\n            loading.show();\n            pushHistory();\n            $.ajax({\n                url: window.location.origin + window.location.pathname + \"?ajax_load=1\",\n                data: $(\"#searchform\").serialize(),\n            }).done(function (html) {\n                var $html = $(html);\n                $(\"#search-results\").replaceWith($(\"#search-results\", $html));\n                $(\"#search-term\").replaceWith($(\"#search-term\", $html));\n                $(\"#results-count\").replaceWith($(\"#results-count\", $html));\n                loading.hide();\n            });\n        };\n        var searchDelayed = function () {\n            clearTimeout(timeout);\n            timeout = setTimeout(search, 200);\n        };\n\n        var setBatchStart = function (b_start) {\n            $(\"#search-batch-start\").attr(\"value\", b_start);\n        };\n\n        // for sorme reason the backend always flag with active class the sorting options\n        var updateSortingState = function ($el) {\n            $(\"a\", $sortingContainer).removeClass(\"active\");\n            $el.addClass(\"active\");\n        };\n        var default_sort = $(\"#search-results\").attr(\"data-default-sort\");\n        updateSortingState($(\"a[data-sort=\" + default_sort + \"]\"));\n\n        /* sorting */\n        $(\"a\", $sortingContainer).on(\"click\", function (e) {\n            e.preventDefault();\n            updateSortingState($(this));\n            var sort = $(this).attr(\"data-sort\");\n            var order = $(this).attr(\"data-order\");\n            if (sort) {\n                $('[name=\"sort_on\"]').attr(\"value\", sort);\n                if (order && order == \"reverse\") {\n                    $('[name=\"sort_order\"]').attr(\"value\", \"reverse\");\n                } else {\n                    $('[name=\"sort_order\"]').attr(\"value\", \"\");\n                }\n            } else {\n                $('[name=\"sort_on\"]').attr(\"value\", \"\");\n                $('[name=\"sort_order\"]').attr(\"value\", \"\");\n            }\n            search();\n        });\n\n        /* form submission */\n        $(\".searchPage\").on(\"submit\", function (e) {\n            e.preventDefault();\n            setBatchStart(\"0\");\n            search();\n        });\n\n        /* filters */\n        $filterBtn.on(\"click\", function (e) {\n            e.preventDefault();\n            $filter.toggleClass(\"activated\");\n            if ($filter.hasClass(\"activated\")) {\n                $advSearchInput.attr(\"value\", \"True\");\n            } else {\n                $advSearchInput.attr(\"value\", \"False\");\n            }\n        });\n\n        $ctSelectAll.on(\"change\", function () {\n            if ($ctSelectAll[0].checked) {\n                $(\"input\", $selectAllContainer).each(function () {\n                    this.checked = true;\n                });\n            } else {\n                $(\"input\", $selectAllContainer).each(function () {\n                    this.checked = false;\n                });\n            }\n        });\n\n        $(\"input\", $filter).on(\"change\", function () {\n            setBatchStart(\"0\");\n            searchDelayed();\n        });\n\n        /* pagination */\n        $(\"#searchform\").on(\"click\", \".pagination a\", function (e) {\n            var urlParams = new URLSearchParams($(e.currentTarget).attr(\"href\")),\n                b_start = urlParams.get(\"b_start:int\");\n            if (!b_start) {\n                // not plone pagination\n                return;\n            }\n            e.preventDefault();\n            setBatchStart(b_start);\n            search();\n        });\n    },\n});\n","import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport I18n from \"../../core/i18n\";\nimport utils from \"../../core/utils\";\n\nexport default Base.extend({\n    name: \"select2\",\n    trigger: \".pat-select2\",\n    parser: \"mockup\",\n    defaults: {\n        separator: \",\",\n        ajaxTimeout: 300,\n    },\n\n    initializeValues() {\n        // Init Selection ---------------------------------------------\n        if (this.options.initialValues) {\n            this.options.id = (term) => {\n                return term.id;\n            };\n            this.options.initSelection = ($el, callback) => {\n                const data = [];\n                const value = $el.val();\n                let seldefaults = this.options.initialValues;\n\n                // Create the initSelection value that contains the default selection,\n                // but in a javascript object\n                if (\n                    typeof this.options.initialValues === \"string\" &&\n                    this.options.initialValues !== \"\"\n                ) {\n                    // if default selection value starts with a '{', then treat the value as\n                    // a JSON object that needs to be parsed\n                    if (this.options.initialValues[0] === \"{\") {\n                        seldefaults = JSON.parse(this.options.initialValues);\n                    }\n                    // otherwise, treat the value as a list, separated by the defaults.separator value of\n                    // strings in the format \"id:text\", and convert it to an object\n                    else {\n                        seldefaults = {};\n                        const initial_values = $(\n                            this.options.initialValues.split(this.options.separator)\n                        );\n                        for (const it of initial_values) {\n                            const selection = it.split(\":\");\n                            const id = selection[0].trim();\n                            const text = selection[1].trim();\n                            seldefaults[id] = text;\n                        }\n                    }\n                }\n\n                const items = $(value.split(this.options.separator));\n                for (const it of items) {\n                    let text = it;\n                    if (seldefaults[it]) {\n                        text = seldefaults[it];\n                    }\n                    data.push({\n                        id: utils.removeHTML(it),\n                        text: utils.removeHTML(text),\n                    });\n                }\n                callback(data);\n            };\n        }\n    },\n\n    initializeTags() {\n        if (this.options.tags && typeof this.options.tags === \"string\") {\n            if (this.options.tags.substr(0, 1) === \"[\") {\n                this.options.tags = JSON.parse(this.options.tags);\n            } else {\n                this.options.tags = this.options.tags.split(this.options.separator);\n            }\n        }\n\n        if (this.options.tags && !this.options.allowNewItems) {\n            this.options.data = this.options.tags.map((value) => {\n                return { id: value, text: value };\n            });\n            this.options.multiple = true;\n            delete this.options.tags;\n        }\n    },\n\n    async initializeOrdering() {\n        if (!this.options.orderable) {\n            return;\n        }\n        const Sortable = (await import(\"sortablejs\")).default;\n        const _initializeOrdering = () => {\n            const sortable_el = this.$select2[0].querySelector(\".select2-choices\");\n            new Sortable(sortable_el, {\n                draggable: \"li\",\n                dragClass: \"select2-choice-dragging\",\n                chosenClass: \"dragging\",\n                onStart: () => this.$el.select2(\"onSortStart\"),\n                onEnd: () => this.$el.select2(\"onSortEnd\"),\n            });\n        };\n        this.$el.on(\"change\", _initializeOrdering.bind(this));\n        _initializeOrdering();\n    },\n\n    async initializeSelect2() {\n        import(\"select2/select2.css\");\n        import(\"./select2.scss\");\n        await import(\"select2\");\n        try {\n            // Don't load \"en\" which is the default where no separate language file exists.\n            if (this.options.language && this.options.language !== \"en\" && !this.options.language.startsWith(\"en\")) {\n                let lang = this.options.language.split(\"-\");\n                // Fix for country specific languages\n                lang = (lang.length > 1) ? `${lang[0]}-${lang[1]}` : lang[0];        \n                await import(`select2/select2_locale_${lang}`);\n            }\n        } catch {\n            console.warn(\"Language file could not be loaded\", this.options.language);\n        }\n\n        this.options.formatResultCssClass = (ob) => {\n            if (ob.id) {\n                return (\n                    \"select2-option-\" +\n                    ob.id.toLowerCase().replace(/[ \\:\\)\\(\\[\\]\\{\\}\\_\\+\\=\\&\\*\\%\\#]/g, \"-\")\n                );\n            }\n        };\n\n        function callback(action, e) {\n            if (action) {\n                if (this.options.debug) {\n                    console.debug(\"callback\", action, e);\n                }\n                if (typeof action === \"string\") {\n                    action = window[action];\n                }\n                return action(e);\n            } else {\n                return action;\n            }\n        }\n\n        this.$el.select2(this.options);\n        this.$el.on(\"select2-selected\", (e) => callback(this.options.onSelected, e));\n        this.$el.on(\"select2-selecting\", (e) => callback(this.options.onSelecting, e));\n        this.$el.on(\"select2-deselecting\", (e) =>\n            callback(this.options.onDeselecting, e)\n        );\n        this.$el.on(\"select2-deselected\", (e) => callback(this.options.onDeselected, e));\n        this.$select2 = this.$el.parent().find(\".select2-container\");\n        this.$el.parent().off(\"close.plone-modal.patterns\");\n        if (this.options.orderable) {\n            this.$select2.addClass(\"select2-orderable\");\n        }\n    },\n\n    opened() {\n        const isOpen = $(\".select2-dropdown-open\", this.$el.parent()).length === 1;\n        return isOpen;\n    },\n\n    async init() {\n        const i18n = new I18n();\n        this.options.language = i18n.currentLanguage;\n        this.options.allowNewItems = this.options.allowNewItems\n            ? JSON.parse(this.options.allowNewItems)\n            : true;\n\n        // TODO: Select2 respects the select fields multiple attribute.\n        //       Currently, only when multiple is set in the pattern options\n        //       the replacement to a hidden input field is done.\n        //       A collection's querystring widget has the multiple attribute\n        //       but must not be replaced with a hidden inout, otherwise robot\n        //       tests fail.\n        //if (this.el.hasAttribute(\"multiple\")) {\n        //    this.options.multiple = true;\n        //}\n\n        if (this.options.ajax || this.options.vocabularyUrl) {\n            if (this.options.vocabularyUrl) {\n                this.options.multiple =\n                    this.options.multiple === undefined ? true : this.options.multiple;\n                this.options.ajax = this.options.ajax || {};\n                this.options.ajax.url = this.options.vocabularyUrl;\n                // XXX removing the following function does'nt break tests. dead code?\n                this.options.initSelection = ($el, callback) => {\n                    const data = [];\n                    const value = $el.val();\n                    for (const val of value.split(this.options.separator)) {\n                        const _val = utils.removeHTML(val);\n                        data.push({ id: _val, text: _val });\n                    }\n                    callback(data);\n                };\n            }\n\n            let queryTerm = \"\";\n\n            const ajaxTimeout = parseInt(this.options.ajaxTimeout || 300, 10);\n            delete this.options.ajaxTimeout;\n            this.options.ajax = $.extend(\n                {\n                    quietMillis: ajaxTimeout,\n                    data: (term, page) => {\n                        queryTerm = term;\n                        return {\n                            query: term,\n                            page_limit: 10,\n                            page: page,\n                        };\n                    },\n                    results: (data) => {\n                        let results = data.results;\n                        if (this.options.vocabularyUrl) {\n                            const dataIds = [];\n                            for (const it of data.results) {\n                                dataIds.push(it.id);\n                            }\n                            results = [];\n\n                            const haveResult =\n                                queryTerm === \"\" || dataIds.includes(queryTerm);\n                            if (this.options.allowNewItems && !haveResult) {\n                                queryTerm = utils.removeHTML(queryTerm);\n                                results.push({\n                                    id: queryTerm,\n                                    text: queryTerm,\n                                });\n                            }\n\n                            for (const it of data.results) {\n                                results.push(it);\n                            }\n                        }\n                        return { results: results };\n                    },\n                },\n                this.options.ajax\n            );\n        } else if (this.options.multiple && this.$el.is(\"select\")) {\n            // Multiselects are converted to input[type=hidden] for Select2\n            // TODO: This should actually not be necessary.\n            //       This is kept for backwards compatibility but should be\n            //       re-checked and removed if possible.\n            this.$el.attr(\"multiple\", true);\n            const vals = this.$el.val() || [];\n            const options = [...this.el.querySelectorAll(\"option\")].map((it) => {\n                return { text: it.innerHTML, id: it.value };\n            });\n\n            const el = document.createElement(\"input\");\n            el.type = \"hidden\";\n            el.value = vals.join(this.options.separator);\n            el.className = this.el.getAttribute(\"class\");\n            el.name = this.el.name;\n            el.id = this.el.id;\n            this.el.after(el);\n            this.el.remove();\n            this.el = el;\n            this.$el = $(el);\n\n            this.options.data = options;\n        }\n        this.initializeValues();\n        this.initializeTags();\n        await this.initializeSelect2();\n        await this.initializeOrdering();\n    },\n});\n","/**\n * A Base pattern for creating scoped patterns.\n *\n * Each instance of a pattern has its own local scope.\n * A new instance is created for each DOM element on which a pattern applies.\n *\n * For usage, see basepattern.md\n */\nimport events from \"./events\";\nimport logging from \"./logging\";\nimport create_uuid from \"./uuid\";\n\nconst log = logging.getLogger(\"basepattern\");\n\nclass BasePattern {\n    static name; // name of pattern used in Registry.\n    static trigger; // A CSS selector to match elements that should trigger the pattern instantiation.\n    static parser; // Options parser.\n\n    // Parser options\n    parser_group_options = true;\n    parser_multiple = undefined;\n    parser_inherit = true;\n\n    constructor(el, options = {}) {\n        // Make static variables available on instance.\n        this.name = this.constructor.name;\n        this.trigger = this.constructor.trigger;\n        this.parser = this.constructor.parser;\n\n        if (!el) {\n            log.warn(`No element given to pattern ${this.name}.`);\n            return;\n        }\n        if (el.jquery) {\n            el = el[0];\n        }\n        this.el = el;\n        this.uuid = create_uuid();\n\n        // Notify pre-init\n        this.el.dispatchEvent(\n            new Event(`pre-init.${this.name}.patterns`, {\n                bubbles: true,\n                cancelable: true,\n            })\n        );\n\n        // Initialize asynchronously.\n        //\n        // 1) We need to call the concrete implementation of ``init``, but the\n        //    inheritance chain is not yet set up and ``init`` not available.\n        //\n        // 2) We want to wait for the init() to successfuly finish and fire an\n        //    event then.\n        //    But the constructer cannot not return a Promise, thus not be\n        //    asynchronous but only return itself.\n        //\n        // Both limitations are gone in next tick.\n        //\n        window.setTimeout(async () => {\n            if (typeof this.el[`pattern-${this.name}`] !== \"undefined\") {\n                // Do not reinstantiate\n                log.debug(`Not reinstatiating the pattern ${this.name}.`, this.el);\n\n                // Notify that not instantiated\n                this.el.dispatchEvent(\n                    new Event(`not-init.${this.name}.patterns`, {\n                        bubbles: true,\n                        cancelable: false,\n                    })\n                );\n                return;\n            }\n\n            // Create the options object by parsing the element and using the\n            // optional options as default.\n            this.options =\n                this.parser?.parse(\n                    this.el,\n                    options,\n                    this.parser_multiple,\n                    this.parser_inherit,\n                    this.parser_group_options\n                ) ?? options;\n\n            // Store pattern instance on element\n            this.el[`pattern-${this.name}`] = this;\n\n            // Initialize the pattern\n            await this.init();\n\n            // Notify that now ready\n            this.el.dispatchEvent(\n                new Event(`init.${this.name}.patterns`, {\n                    bubbles: true,\n                    cancelable: true,\n                })\n            );\n        }, 0);\n    }\n\n    async init() {\n        // Extend this method in your pattern.\n    }\n\n    emit_update(action = undefined, options = {}) {\n        options = {\n            pattern: this.name,\n            dom: this.el,\n            action: action,\n            ...options,\n        }\n        this.el.dispatchEvent(events.update_event(options));\n    }\n\n    /**\n     * Listen to an event on the element only once.\n     *\n     * @param {string} event_name - Name of the event to listen to.\n     * @param {function} callback - Callback to call when the event is thrown.\n     */\n    one(event_name, event_callback) {\n        events.add_event_listener(\n            this.el,\n            `${event_name}.${this.name}.patterns`,\n            `basepattern-one--${event_name}.${this.name}.patterns`,\n            event_callback,\n            {\n                once: true,\n            }\n        );\n    }\n\n    /**\n     * Destroy/remove/unload the pattern from the element.\n     */\n    destroy() {\n        delete this.el[`pattern-${this.name}`];\n    }\n}\n\nexport default BasePattern;\nexport { BasePattern };\n","// Patterns argument parser\nimport $ from \"jquery\";\nimport utils from \"./utils.js\";\nimport logging from \"./logging\";\n\nclass ArgumentParser {\n    constructor(name) {\n        this.order = [];\n        this.parameters = {};\n        this.attribute = \"data-pat-\" + name;\n        this.enum_values = {};\n        this.enum_conflicts = [];\n        this.groups = {};\n        this.possible_groups = {};\n        this.log = logging.getLogger(name + \".parser\");\n\n        this.group_pattern = /([a-z][a-z0-9]*)-([A-Z][a-z0-0\\-]*)/i;\n        this.json_param_pattern = /^\\s*\\[?\\s*{/i;\n        this.named_param_pattern = /^\\s*([a-z][a-z0-9\\-]*)\\s*:(.*)/is;\n        this.token_pattern = /(([\"']).*?(?!\\\\)\\2)|\\s*(\\S+)\\s*/g;\n    }\n\n    _camelCase(str) {\n        return str.replace(/\\-([a-z])/g, (__, p1) => p1.toUpperCase());\n    }\n\n    addAlias(alias, original) {\n        /* Add an alias for a previously added parser argument.\n         *\n         * Useful when you want to support both US and UK english argument\n         * names.\n         */\n        if (this.parameters[original]) {\n            this.parameters[original].alias = alias;\n        } else {\n            throw `Attempted to add an alias \"${alias}\" for a non-existing parser argument \"${original}\".`;\n        }\n    }\n\n    addGroupToSpec(spec) {\n        /* Determine wether an argument being parsed can be grouped and\n         * update its specifications object accordingly.\n         *\n         * Internal method used by addArgument and addJSONArgument\n         */\n        const m = spec.name.match(this.group_pattern);\n        if (m) {\n            const group = m[1];\n            const field = m[2];\n            if (group in this.possible_groups) {\n                const first_spec = this.possible_groups[group];\n                const first_name = first_spec.name.match(this.group_pattern)[2];\n                first_spec.group = group;\n                first_spec.dest = first_name;\n                this.groups[group] = new ArgumentParser();\n                this.groups[group].addArgument(\n                    first_name,\n                    first_spec.value,\n                    first_spec.choices,\n                    first_spec.multiple\n                );\n                delete this.possible_groups[group];\n            }\n            if (group in this.groups) {\n                this.groups[group].addArgument(\n                    field,\n                    spec.value,\n                    spec.choices,\n                    spec.multiple\n                );\n                spec.group = group;\n                spec.dest = field;\n            } else {\n                this.possible_groups[group] = spec;\n                spec.dest = this._camelCase(spec.name);\n            }\n        }\n        return spec;\n    }\n\n    addJSONArgument(name, default_value) {\n        /* Add an argument where the value is provided in JSON format.\n         *\n         * This is a different usecase than specifying all arguments to\n         * the data-pat-... attributes in JSON format, and instead is part\n         * of the normal notation except that a value is in JSON instead of\n         * for example a string.\n         */\n        this.order.push(name);\n        this.parameters[name] = this.addGroupToSpec({\n            name: name,\n            value: default_value,\n            dest: name,\n            group: null,\n            type: \"json\",\n        });\n    }\n\n    addArgument(name, default_value, choices, multiple) {\n        const spec = {\n            name: name,\n            value:\n                multiple && !Array.isArray(default_value)\n                    ? [default_value]\n                    : default_value,\n            multiple: multiple,\n            dest: name,\n            group: null,\n        };\n        if (choices && Array.isArray(choices) && choices.length) {\n            spec.choices = choices;\n            spec.type = this._typeof(choices[0]);\n            for (const choice of choices) {\n                if (this.enum_conflicts.indexOf(choice) !== -1) {\n                    continue;\n                } else if (choice in this.enum_values) {\n                    this.enum_conflicts.push(choice);\n                    delete this.enum_values[choice];\n                } else {\n                    this.enum_values[choice] = name;\n                }\n            }\n        } else if (typeof spec.value === \"string\" && spec.value.slice(0, 1) === \"$\") {\n            spec.type = this.parameters[spec.value.slice(1)].type;\n        } else {\n            // Note that this will get reset by _defaults if default_value is a function.\n            spec.type = this._typeof(multiple ? spec.value[0] : spec.value);\n        }\n        this.order.push(name);\n        this.parameters[name] = this.addGroupToSpec(spec);\n    }\n\n    _typeof(obj) {\n        if (obj === null) {\n            return \"null\";\n        }\n        return typeof obj;\n    }\n\n    _coerce(name, value) {\n        const spec = this.parameters[name];\n        if (typeof value !== spec.type)\n            try {\n                switch (spec.type) {\n                    case \"json\":\n                        value = JSON.parse(value);\n                        break;\n                    case \"boolean\":\n                        if (typeof value === \"string\") {\n                            value = value.toLowerCase();\n                            const num = parseInt(value, 10);\n                            if (!isNaN(num)) value = !!num;\n                            else\n                                value =\n                                    value === \"true\" ||\n                                    value === \"y\" ||\n                                    value === \"yes\" ||\n                                    value === \"y\" ||\n                                    value === \"on\";\n                        } else if (typeof value === \"number\") {\n                            value = !!value;\n                        } else {\n                            throw `Cannot convert value for ${name} to boolean.`;\n                        }\n                        break;\n                    case \"number\":\n                        if (typeof value === \"string\") {\n                            value = parseInt(value, 10);\n                            if (isNaN(value)) {\n                                throw `Cannot convert value for ${name} to number.`;\n                            }\n                        } else if (typeof value === \"boolean\") {\n                            value = value + 0;\n                        } else {\n                            throw `Cannot convert value for ${name} to number.`;\n                        }\n                        break;\n                    case \"string\":\n                        value = value.toString();\n                        break;\n                    case \"null\": // Missing default values\n                    case \"undefined\":\n                        break;\n                    default:\n                        throw `Do not know how to convert value for ${name} of type ${typeof value} to ${\n                            spec.type\n                        }.`;\n                }\n            } catch (e) {\n                this.log.warn(e);\n                return null;\n            }\n\n        if (spec.choices && spec.choices.indexOf(value) === -1) {\n            this.log.warn(`Illegal value for ${name}: ${value}.`);\n            return null;\n        }\n        return value;\n    }\n\n    _set(opts, name, value) {\n        if (!(name in this.parameters)) {\n            this.log.debug(`Ignoring value for unknown argument: ${name}.`);\n            return;\n        }\n        const spec = this.parameters[name];\n        let parts;\n        if (spec.multiple) {\n            if (typeof value === \"string\") {\n                parts = value.split(/,+/);\n            } else {\n                parts = value;\n            }\n            value = [];\n            for (const part of parts) {\n                const v = this._coerce(name, part.trim());\n                if (v !== null) {\n                    value.push(v);\n                }\n            }\n        } else {\n            value = this._coerce(name, value);\n            if (value === null) {\n                return;\n            }\n        }\n        opts[name] = value;\n    }\n\n    _split(text) {\n        const tokens = [];\n        text.replace(this.token_pattern, (match, quoted, __, simple) => {\n            if (quoted) {\n                tokens.push(quoted);\n            } else if (simple) {\n                tokens.push(simple);\n            }\n        });\n        return tokens;\n    }\n\n    _parseExtendedNotation(argstring) {\n        const opts = {};\n        const parts = argstring\n            .replace(/;;/g, \"\\0x1f\")\n            .replace(/&amp;/g, \"&amp\\0x1f\")\n            .split(/;/)\n            .map((el) => el.replace(new RegExp(\"\\0x1f\", \"g\"), \";\"));\n        for (const part of parts) {\n            if (!part) {\n                continue;\n            }\n            const matches = part.match(this.named_param_pattern);\n            if (!matches) {\n                this.log.warn(`Invalid parameter: ${part}: ${argstring}.`);\n                continue;\n            }\n            const name = matches[1];\n            const value = matches[2].trim();\n            const arg = Object.values(this.parameters).filter((it) => it.alias === name);\n\n            const is_alias = arg.length === 1;\n\n            if (is_alias) {\n                this._set(opts, arg[0].name, value);\n            } else if (name in this.parameters) {\n                this._set(opts, name, value);\n            } else if (name in this.groups) {\n                const subopt = this.groups[name]._parseShorthandNotation(value);\n                for (const field in subopt) {\n                    this._set(opts, name + \"-\" + field, subopt[field]);\n                }\n            } else {\n                this.log.warn(`Unknown named parameter: ${matches[1]}.`);\n                continue;\n            }\n        }\n        return opts;\n    }\n\n    _parseShorthandNotation(parameter) {\n        const parts = this._split(parameter);\n        const opts = {};\n        let i = 0;\n\n        while (parts.length) {\n            const part = parts.shift().trim();\n            let sense;\n            let flag;\n            let positional = true;\n            if (part.slice(0, 3) === \"no-\") {\n                sense = false;\n                flag = part.slice(3);\n            } else {\n                sense = true;\n                flag = part;\n            }\n            if (flag in this.parameters && this.parameters[flag].type === \"boolean\") {\n                positional = false;\n                this._set(opts, flag, sense);\n            } else if (flag in this.enum_values) {\n                positional = false;\n                this._set(opts, this.enum_values[flag], flag);\n            } else if (positional) this._set(opts, this.order[i], part);\n            else {\n                parts.unshift(part);\n                break;\n            }\n            i++;\n            if (i >= this.order.length) {\n                break;\n            }\n        }\n        if (parts.length) this.log.warn(`Ignore extra arguments: ${parts.join(\" \")}.`);\n        return opts;\n    }\n\n    _parse(parameter) {\n        if (!parameter) {\n            return {};\n        }\n        if (parameter.match(this.json_param_pattern)) {\n            try {\n                return JSON.parse(parameter);\n            } catch {\n                this.log.warn(`Invalid JSON argument found: ${parameter}.`);\n            }\n        }\n        if (parameter.match(this.named_param_pattern)) {\n            return this._parseExtendedNotation(parameter);\n        }\n        const sep = parameter.indexOf(\";\");\n        if (sep === -1) {\n            return this._parseShorthandNotation(parameter);\n        }\n        const opts = this._parseShorthandNotation(parameter.slice(0, sep));\n        const extended = this._parseExtendedNotation(parameter.slice(sep + 1));\n        for (const name in extended) {\n            opts[name] = extended[name];\n        }\n        return opts;\n    }\n\n    _defaults($el) {\n        const result = {};\n        for (const name in this.parameters) {\n            if (typeof this.parameters[name].value === \"function\") {\n                try {\n                    result[name] = this.parameters[name].value($el, name);\n                    this.parameters[name].type = typeof result[name];\n                } catch {\n                    this.log.error(`Default function for ${name} failed.`);\n                }\n            } else {\n                result[name] = this.parameters[name].value;\n            }\n        }\n        return result;\n    }\n\n    _cleanupOptions(options, group_options = true) {\n        // Resolve references\n        for (const name of Object.keys(options)) {\n            const spec = this.parameters[name];\n            if (spec === undefined) {\n                continue;\n            }\n\n            if (\n                options[name] === spec.value &&\n                typeof spec.value === \"string\" &&\n                spec.value.slice(0, 1) === \"$\"\n            ) {\n                options[name] = options[spec.value.slice(1)];\n            }\n        }\n        if (group_options) {\n            // Move options into groups and do renames\n            for (const name of Object.keys(options)) {\n                const spec = this.parameters[name];\n                let target;\n                if (spec === undefined) {\n                    continue;\n                }\n\n                if (spec.group) {\n                    if (typeof options[spec.group] !== \"object\") {\n                        options[spec.group] = {};\n                    }\n                    target = options[spec.group];\n                } else {\n                    target = options;\n                }\n\n                if (spec.dest !== name) {\n                    target[spec.dest] = options[name];\n                    delete options[name];\n                }\n            }\n        }\n        return options;\n    }\n\n    parse($el, options, multiple, inherit = true, group_options = true) {\n        if (!$el.jquery) {\n            $el = $($el);\n        }\n        if (typeof options === \"boolean\" && multiple === undefined) {\n            // Fix argument order: ``multiple`` passed instead of ``options``.\n            multiple = options;\n            options = {};\n        }\n        const stack = inherit ? [[this._defaults($el)]] : [[{}]];\n        let $possible_config_providers;\n        let final_length = 1;\n        /*\n         * XXX this is a workaround for:\n         * - https://github.com/Patternslib/Patterns/issues/393\n         *\n         * Prevents the parser to pollute the pat-modal configuration\n         * with data-pat-inject elements define in a `.pat-modal` parent element.\n         *\n         *  Probably this function should be completely revisited, see:\n         * - https://github.com/Patternslib/Patterns/issues/627\n         *\n         */\n        if (\n            !inherit ||\n            ($el.hasClass(\"pat-modal\") && this.attribute === \"data-pat-inject\")\n        ) {\n            $possible_config_providers = $el;\n        } else {\n            $possible_config_providers = $el.parents(`[${this.attribute}]`).addBack();\n        }\n\n        for (const provider of $possible_config_providers) {\n            let frame;\n            const data = ($(provider).attr(this.attribute) || \"\").trim();\n            if (!data) {\n                continue;\n            }\n            const _parse = this._parse.bind(this);\n            if (data.match(/&&/)) {\n                frame = data.split(/\\s*&&\\s*/).map(_parse);\n            } else {\n                frame = _parse(data);\n            }\n            if (!Array.isArray(frame)) {\n                frame = [frame];\n            }\n            final_length = Math.max(frame.length, final_length);\n            stack.push(frame);\n        }\n\n        if (typeof options === \"object\") {\n            if (Array.isArray(options)) {\n                stack.push(options);\n                final_length = Math.max(options.length, final_length);\n            } else {\n                stack.push([options]);\n            }\n        }\n        if (!multiple) {\n            final_length = 1;\n        }\n        const results = utils\n            .removeDuplicateObjects(utils.mergeStack(stack, final_length))\n            .map((current_value) => this._cleanupOptions(current_value, group_options));\n        return multiple ? results : results[0];\n    }\n}\n\n// BBB\nArgumentParser.prototype.add_argument = ArgumentParser.prototype.addArgument;\n\nexport default ArgumentParser;\n","import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"datatables\",\n    trigger: \".pat-datatables\",\n    parser: \"mockup\",\n    table: null,\n\n    defaults: {\n        // Default values for attributes\n    },\n\n    async init() {\n        import(\"datatables.net-bs5/css/dataTables.bootstrap5.min.css\");\n        import(\"datatables.net-buttons-bs5/css/buttons.bootstrap5.min.css\");\n        import(\"datatables.net-colreorder-bs5/css/colReorder.bootstrap5.min.css\");\n        import(\"datatables.net-fixedcolumns-bs5/css/fixedColumns.bootstrap5.min.css\"); // prettier-ignore\n        import(\"datatables.net-fixedheader-bs5/css/fixedHeader.bootstrap5.min.css\"); // prettier-ignore\n        import(\"datatables.net-rowreorder-bs5/css/rowReorder.bootstrap5.min.css\");\n        import(\"datatables.net-select-bs5/css/select.bootstrap5.min.css\");\n\n        await import(\"datatables.net\");\n        await import(\"datatables.net-bs5\");\n        await import(\"datatables.net-buttons\");\n        await import(\"datatables.net-buttons-bs5\");\n        await import(\"datatables.net-buttons/js/buttons.colVis\");\n        await import(\"datatables.net-buttons/js/buttons.html5\");\n        await import(\"datatables.net-buttons/js/buttons.print\");\n        await import(\"datatables.net-colreorder\");\n        await import(\"datatables.net-colreorder-bs5\");\n        await import(\"datatables.net-fixedcolumns\");\n        await import(\"datatables.net-fixedcolumns-bs5\");\n        await import(\"datatables.net-fixedheader\");\n        await import(\"datatables.net-fixedheader-bs5\");\n        await import(\"datatables.net-rowreorder\");\n        await import(\"datatables.net-rowreorder-bs5\");\n        await import(\"datatables.net-select\");\n        await import(\"datatables.net-select-bs5\");\n\n        $(this.el).DataTable(this.options);\n    },\n});\n","/**\n * Patterns ajax - AJAX injection for forms and anchors\n *\n * Copyright 2012-2013 Florian Friesdorf\n * Copyright 2012-2013 Marko Durkovic\n */\nimport \"../../core/polyfills\"; // SubmitEvent.submitter for Safari < 15.4 and jsDOM\nimport $ from \"jquery\";\nimport logging from \"../../core/logging\";\nimport Parser from \"../../core/parser\";\nimport registry from \"../../core/registry\";\n\nconst log = logging.getLogger(\"pat.ajax\");\n\nexport const parser = new Parser(\"ajax\");\nparser.addArgument(\"accept\", \"text/html\");\nparser.addArgument(\"url\", function ($el) {\n    const el = $el[0];\n    const value =\n        el.tagName === \"A\"\n            ? el.getAttribute(\"href\")\n            : el.tagName === \"FORM\"\n            ? el.getAttribute(\"action\")\n            : \"\";\n    return (value || \"\").split(\"#\")[0];\n});\nparser.addArgument(\"browser-cache\", \"no-cache\", [\"cache\", \"no-cache\"]); // Cache ajax requests\n\nconst xhrCount = {};\nxhrCount.get = function (a) {\n    return this[a] !== undefined ? this[a] : 0;\n};\nxhrCount.inc = function (a) {\n    this[a] = this.get(a) + 1;\n    return this.get(a);\n};\n\nconst _ = {\n    name: \"ajax\",\n    trigger: \".pat-ajax\",\n    parser: parser,\n\n    init($el) {\n        $el.off(\".pat-ajax\");\n        $el.filter(\"a\").on(\"click.pat-ajax\", _.onTriggerEvents);\n        $el.filter(\"form\")\n            .on(\"submit.pat-ajax\", _.onTriggerEvents)\n            .on(\"click.pat-ajax\", \"[type=submit]\", _.onClickSubmit);\n        $el.filter(\":not(form,a)\").each(function () {\n            log.warn(\"Unsupported element:\", this);\n        });\n        return $el;\n    },\n\n    destroy($el) {\n        $el.off(\".pat-ajax\");\n    },\n\n    onClickSubmit(event) {\n        const el = event.submitter || event.target;\n        const form = el.form;\n        const data = {};\n        if (el.name) {\n            data[el.name] = el.value;\n        }\n        $(form).data(\"pat-ajax.clicked-data\", data);\n    },\n\n    onTriggerEvents(event) {\n        if (event) {\n            event.preventDefault();\n        }\n        _.request($(this));\n    },\n\n    request($el, opts) {\n        return $el.each(function () {\n            _._request($(this), opts);\n        });\n    },\n\n    _request($el, opts) {\n        const cfg = _.parser.parse($el, opts);\n        const onError = function (jqxhr, status, error) {\n            // error can also stem from a javascript\n            // exception, not only errors described in the\n            // jqxhr.\n            log.error(\"load error for \" + cfg.url + \":\", error, jqxhr);\n            $el.trigger({\n                type: \"pat-ajax-error\",\n                jqxhr: jqxhr,\n            });\n        };\n        const seqNumber = xhrCount.inc(cfg.url);\n        const onSuccess = function (data, status, jqxhr) {\n            log.debug(\"success: jqxhr:\", jqxhr);\n            if (seqNumber === xhrCount.get(cfg.url)) {\n                // if this url is requested multiple time, only return the last result\n                $el.trigger({\n                    type: \"pat-ajax-success\",\n                    jqxhr: {\"url\": cfg.url, ...jqxhr},\n                });\n            } else {\n                // ignore\n            }\n        };\n        const temp = $el.data(\"pat-ajax.clicked-data\");\n        const clickedData = temp ? $.param(temp) : \"\";\n        const args = {\n            context: $el,\n            data: [$el.serialize(), clickedData].filter(Boolean).join(\"&\"),\n            headers: {},\n            url: cfg.url,\n            method: $el.attr(\"method\") ? $el.attr(\"method\") : \"GET\",\n            cache: cfg.browserCache === \"cache\" ? true : false,\n        };\n\n        if (cfg.accept) {\n            args.headers.Accept = cfg.accept;\n        }\n\n        if (\n            $el.is(\"form\") &&\n            $el.attr(\"method\") &&\n            $el.attr(\"method\").toUpperCase() == \"POST\"\n        ) {\n            const formdata = new FormData($el[0]);\n            for (const key in temp) {\n                formdata.append(key, temp[key]);\n            }\n            args[\"method\"] = \"POST\";\n            args[\"data\"] = formdata;\n            args[\"cache\"] = false;\n            args[\"contentType\"] = false;\n            args[\"processData\"] = false;\n            args[\"type\"] = \"POST\";\n        }\n\n        $el.removeData(\"pat-ajax.clicked-data\");\n        log.debug(\"request:\", args, $el[0]);\n\n        // Make it happen\n        const ajax_deferred = $.ajax(args);\n\n        if (ajax_deferred) ajax_deferred.done(onSuccess).fail(onError);\n    },\n};\n\nregistry.register(_);\n\nexport default _;\n","import \"../../core/polyfills\"; // SubmitEvent.submitter for Safari < 15.4 and jsDOM\nimport $ from \"jquery\";\nimport ajax from \"../ajax/ajax\";\nimport dom from \"../../core/dom\";\nimport events from \"../../core/events\";\nimport logging from \"../../core/logging\";\nimport Parser from \"../../core/parser\";\nimport registry from \"../../core/registry\";\nimport create_uuid from \"../../core/uuid\";\nimport utils from \"../../core/utils\";\n\nconst log = logging.getLogger(\"pat.inject\");\n//log.setLevel(logging.Level.DEBUG);\n\nconst TEXT_NODE = 3;\nconst COMMENT_NODE = 8;\n\nexport const parser = new Parser(\"inject\");\nparser.addArgument(\"default-selector\");\nparser.addArgument(\"target\");\nparser.addArgument(\"data-type\", \"html\");\nparser.addArgument(\"next-href\");\nparser.addArgument(\"source\");\nparser.addArgument(\"trigger\", \"default\", [\n    \"default\",\n    \"autoload\",\n    \"autoload-visible\",\n    \"idle\",\n]);\nparser.addArgument(\"delay\"); // only used in autoload\nparser.addArgument(\"browser-cache\", \"no-cache\", [\"cache\", \"no-cache\"]); // Cache ajax requests. Pass to pat-ajax.\nparser.addArgument(\"confirm\", \"class\", [\"never\", \"always\", \"form-data\", \"class\"]);\nparser.addArgument(\"confirm-message\", \"Are you sure you want to leave this page?\");\nparser.addArgument(\"loading-class\", \"injecting\"); // Add a class to the target while content is still loading.\nparser.addArgument(\"executing-class\", \"executing\"); // Add a class to the element while content is still loading.\nparser.addArgument(\"executed-class\", \"executed\"); // Add a class to the element when content is loaded.\nparser.addArgument(\"class\"); // Add a class to the injected content.\nparser.addArgument(\"history\", \"none\", [\"none\", \"record\"]);\nparser.addArgument(\"push-marker\");\nparser.addArgument(\"scroll\");\n\n// Note: this should not be here but the parser would bail on unknown\n// parameters and expand/collapsible need to pass the url to us.\nparser.addArgument(\"url\");\n\nconst inject = {\n    name: \"inject\",\n    trigger: \"a.pat-inject, form.pat-inject, .pat-subform.pat-inject\",\n    parser: parser,\n\n    async init($el, opts) {\n        // We need to wait a tick. Modern BasePattern based patterns like\n        // pat-validation do always wait a tick before initializing. The\n        // patterns registry always initializes pat-validation first but since\n        // it is waiting a tick the event handlers are registerd after the ones\n        // from pat-inject. Waiting a tick in pat-inject solves this -\n        // pat-validation's event handlers are initialized first.\n        await utils.timeout(1);\n\n        const el = utils.jqToNode($el);\n\n        const cfgs = this.extractConfig($el, opts);\n        if (cfgs.some((e) => e.history === \"record\") && !(\"pushState\" in history)) {\n            // if the injection shall add a history entry and HTML5 pushState\n            // is missing, then don't initialize the injection.\n            log.warn(\"HTML5 pushState is missing, aborting\");\n            return $el;\n        }\n        $el.data(\"pat-inject\", cfgs);\n\n        if (cfgs[0].nextHref && cfgs[0].nextHref.indexOf(\"#\") === 0) {\n            // In case the next href is an anchor, and it already\n            // exists in the page, we do not activate the injection\n            // but instead just change the anchors href.\n\n            // Note: This is used in only one project for linked fullcalendars,\n            // it's sanity is wonky and we should probably solve it differently.\n            if (el.nodeName === \"A\" && $(cfgs[0].nextHref).length > 0) {\n                log.debug(\n                    \"Skipping as next href is anchor, which already exists\",\n                    cfgs[0].nextHref\n                );\n                // TODO: reconsider how the injection enters exhausted state\n                el.setAttribute(\n                    \"href\",\n                    (window.location.href.split(\"#\")[0] || \"\") + cfgs[0].nextHref\n                );\n                return $el;\n            }\n        }\n        if (cfgs[0].pushMarker) {\n            $(\"body\").on(\"push\", (event, data) => {\n                log.debug(\"received push message: \" + data);\n                if (data == cfgs[0].pushMarker) {\n                    log.debug(\"re-injecting \" + data);\n                    this.onTrigger({ currentTarget: el });\n                }\n            });\n        }\n        if (cfgs[0].idleTrigger) {\n            this._initIdleTrigger($el, cfgs[0].idleTrigger);\n        } else {\n            switch (cfgs[0].trigger) {\n                case \"default\":\n                    for (const cfg of cfgs) {\n                        if (cfg.delay) {\n                            cfg.processDelay = cfg.delay;\n                        }\n                    }\n                    // setup event handlers\n                    if (el?.nodeName === \"FORM\") {\n                        log.debug(\"Initializing form with injection on\", el);\n                        events.add_event_listener(\n                            el,\n                            \"submit\",\n                            \"pat-inject--form-submit\",\n                            (e) => {\n                                if (\n                                    e.submitter?.matches(\n                                        \"[type=submit], button:not([type=button]), [type=image]\"\n                                    )\n                                ) {\n                                    // make sure the submitting button is sent\n                                    // with the form\n                                    ajax.onClickSubmit(e);\n                                }\n                                this.onTrigger(e);\n                            }\n                        );\n                    } else if (el?.matches(\".pat-subform\")) {\n                        log.debug(\"Initializing subform with injection\");\n                    } else {\n                        $el.on(\"click.pat-inject\", this.onTrigger.bind(this));\n                    }\n                    break;\n                case \"autoload\":\n                    if (!cfgs[0].delay) {\n                        this.onTrigger({ currentTarget: el });\n                    } else {\n                        // generate UUID\n                        const uuid = create_uuid();\n                        el.setAttribute(\"data-pat-inject-uuid\", uuid);\n\n                        // function to trigger the autoload and mark as triggered\n                        const delayed_trigger = (uuid_) => {\n                            // Check if the element has been removed from the dom\n                            const still_there = document.querySelector(\n                                `[data-pat-inject-uuid=\"${uuid_}\"]`\n                            );\n                            if (!still_there) {\n                                return false;\n                            }\n\n                            $el.data(\"pat-inject-autoloaded\", true);\n                            this.onTrigger({ currentTarget: el });\n                            // Cleanup again.\n                            still_there.removeAttribute(\"data-pat-inject-uuid\");\n                            return true;\n                        };\n                        window.setTimeout(\n                            delayed_trigger.bind(null, uuid),\n                            cfgs[0].delay\n                        );\n                    }\n                    break;\n                case \"autoload-visible\":\n                    this._initAutoloadVisible($el, cfgs);\n                    break;\n                case \"idle\":\n                    this._initIdleTrigger($el, cfgs[0].delay);\n                    break;\n            }\n        }\n\n        log.debug(\"initialised:\", el);\n        return $el;\n    },\n\n    destroy($el) {\n        $el.off(\".pat-inject\");\n        $el.data(\"pat-inject\", null);\n        return $el;\n    },\n\n    onTrigger(e) {\n        /* Injection has been triggered, either via form submission or a\n         * link has been clicked.\n         */\n\n        // Prevent the original event from doing it's work.\n        // We want an AJAX request instead.\n        e.preventDefault && e.preventDefault();\n\n        const el = e.currentTarget;\n        const $el = $(el);\n        let cfgs = $el.data(\"pat-inject\");\n        if (el.nodeName === \"FORM\" && e.type === \"submit\") {\n            const form = el;\n            const submitter = e.submitter;\n\n            // Do not submit invalid forms, if validation is active.\n            // Works with native form validation and with pat-validation.\n            if (\n                !submitter?.matches(\"[formnovalidate]\") &&\n                !form.matches(\"[novalidate]\") &&\n                form.matches(\":invalid\")\n            ) {\n                log.debug(\"Form is invalid, aborting\");\n                return;\n            }\n\n            const formaction = submitter?.getAttribute(\"formaction\");\n            if (formaction) {\n                const opts = {\n                    url: formaction,\n                };\n\n                // Support custom data-pat-inject on formaction buttons.\n                const cfg_node = submitter.closest(\"[data-pat-inject]\");\n                cfgs = this.extractConfig($(cfg_node), opts);\n            }\n\n            // store the params of the form in the config, to be used by history\n            for (const cfg of cfgs) {\n                cfg.params = $.param($el.serializeArray());\n            }\n        }\n\n        $el.trigger(\"patterns-inject-triggered\");\n        this.execute(cfgs, $el);\n    },\n\n    submitSubform($sub) {\n        /* This method is called from pat-subform\n         */\n        const $el = $($sub[0].closest(\"form\"));\n        const cfgs = $sub.data(\"pat-inject\");\n\n        // store the params of the subform in the config, to be used by history\n        for (const cfg of cfgs) {\n            cfg.params = $.param($sub.serializeArray());\n        }\n\n        try {\n            $el.trigger(\"patterns-inject-triggered\");\n        } catch (e) {\n            log.error(\"patterns-inject-triggered\", e);\n        }\n        this.execute(cfgs, $el);\n    },\n\n    extractConfig($el, options = {}) {\n        const el = utils.jqToNode($el);\n        options = Object.assign({}, options); // copy\n\n        const cfgs = parser.parse($el, options, true);\n        for (const cfg of cfgs) {\n            cfg.$context = $el;\n            // options and cfg have priority, fall back to href/action\n            cfg.url =\n                options.url ||\n                cfg.url ||\n                el?.getAttribute(\"href\") ||\n                el?.getAttribute(\"action\") ||\n                el?.closest(\"form\")?.getAttribute(\"action\") ||\n                \"\";\n\n            // separate selector from url\n            const urlparts = cfg.url.split(\"#\");\n            cfg.url = urlparts[0];\n\n            if (urlparts.length > 2) {\n                log.warn(\"Ignoring additional source ids:\", urlparts.slice(2));\n            }\n\n            if (!cfg.defaultSelector) {\n                // if no selector, check for selector as part of original url\n                cfg.defaultSelector = (urlparts[1] && \"#\" + urlparts[1]) || \"body\";\n            }\n            if (cfg.delay) {\n                try {\n                    cfg.delay = utils.parseTime(cfg.delay);\n                } catch {\n                    log.warn(\"Invalid delay value: \", cfg.delay);\n                    cfg.delay = null;\n                }\n            }\n            cfg.processDelay = 0;\n        }\n        return cfgs;\n    },\n\n    elementIsDirty(m) {\n        /* Check whether the passed in form element contains a value.\n         */\n        const data = $.map(m.find(\":input:not(select)\"), (i) => {\n            const val = $(i).val();\n            return Boolean(val) && val !== $(i).attr(\"placeholder\");\n        });\n        return $.inArray(true, data) !== -1;\n    },\n\n    askForConfirmation(cfgs) {\n        /* If configured to do so, show a confirmation dialog to the user.\n         * This is done before attempting to perform injection.\n         */\n        let should_confirm = false;\n        let message;\n\n        for (const cfg of cfgs) {\n            let _confirm = false;\n            if (cfg.confirm == \"always\") {\n                _confirm = true;\n            } else if (\n                cfg.confirm === \"form-data\" &&\n                cfg.target &&\n                cfg.target !== \"none\"\n            ) {\n                _confirm = this.elementIsDirty(cfg.$target);\n            } else if (cfg.confirm === \"class\" && cfg.target && cfg.target !== \"none\") {\n                _confirm = cfg.$target.hasClass(\"is-dirty\");\n            }\n            if (_confirm) {\n                should_confirm = true;\n                message = cfg.confirmMessage;\n            }\n        }\n        if (should_confirm) {\n            if (!window.confirm(message)) {\n                return false;\n            }\n        }\n        return true;\n    },\n\n    ensureTarget(cfg) {\n        /* Make sure that a target element exists and that it's assigned to\n         * cfg.$target.\n         */\n        // make sure target exist\n        if (cfg.target === \"none\") {\n            // special case, we don't want to inject anything\n            return true;\n        }\n        cfg.$target =\n            cfg.$target || (cfg.target === \"self\" ? cfg.$context : $(cfg.target));\n        if (cfg.$target.length === 0) {\n            if (!cfg.target) {\n                log.error(\"Need target selector\", cfg);\n                return false;\n            }\n            cfg.$target = this.createTarget(cfg.target);\n            cfg.$created_target = cfg.$target;\n        }\n        return true;\n    },\n\n    verifySingleConfig(url, cfg) {\n        /* Verify one of potentially multiple configs (i.e. argument lists).\n         *\n         * Extract modifiers such as ::element or ::after.\n         * Ensure that a target element exists.\n         */\n        if (cfg.url !== url) {\n            // in case of multi-injection, all injections need to use\n            // the same url\n            log.error(\"Unsupported different urls for multi-inject\");\n            return false;\n        }\n        // defaults\n        cfg.source = cfg.source || cfg.defaultSelector;\n        cfg.target = cfg.target || cfg.defaultSelector;\n\n        if (!this.extractModifiers(cfg)) {\n            return false;\n        }\n        if (!this.ensureTarget(cfg)) {\n            return false;\n        }\n        this.listenForFormReset(cfg);\n        return true;\n    },\n\n    verifyConfig(cfgs) {\n        /* Verify and post-process all the configurations.\n         * Each \"config\" is an arguments list separated by the &&\n         * combination operator.\n         *\n         * In case of multi-injection, only one URL is allowed, which\n         * should be specified in the first config (i.e. arguments list).\n         *\n         * Verification for each cfg in the array needs to succeed.\n         */\n        return cfgs.every((cfg) => this.verifySingleConfig(cfgs[0].url, cfg));\n    },\n\n    listenForFormReset(cfg) {\n        /* if pat-inject is used to populate target in some form and when\n         * Cancel button is pressed (this triggers reset event on the\n         * form) you would expect to populate with initial placeholder\n         */\n        if (cfg.target === \"none\") {\n            // Special case, we don't want to display any return value.\n            return;\n        }\n        const $form = cfg.$target.parents(\"form\");\n        if ($form.length !== 0 && cfg.$target.data(\"initial-value\") === undefined) {\n            cfg.$target.data(\"initial-value\", cfg.$target.html());\n            $form.on(\"reset\", () => {\n                cfg.$target.html(cfg.$target.data(\"initial-value\"));\n            });\n        }\n    },\n\n    extractModifiers(cfg) {\n        /* The user can add modifiers to the source and target arguments.\n         * Modifiers such as ::element, ::before and ::after.\n         * We identifiy and extract these modifiers here.\n         */\n        const source_re = /^(.*?)(::element)?$/;\n        const target_re = /^(.*?)(::element)?(::after|::before)?$/;\n        const source_match = source_re.exec(cfg.source);\n        const target_match = target_re.exec(cfg.target);\n\n        cfg.source = source_match[1];\n        cfg.sourceMod = source_match[2] ? \"element\" : \"content\";\n        cfg.target = target_match[1];\n        const targetMod = target_match[2] ? \"element\" : \"content\";\n        const targetPosition = (target_match[3] || \"::\").slice(2); // position relative to target\n\n        if (cfg.loadingClass) {\n            cfg.loadingClass += \" \" + cfg.loadingClass + \"-\" + targetMod;\n            if (targetPosition && cfg.loadingClass) {\n                cfg.loadingClass += \" \" + cfg.loadingClass + \"-\" + targetPosition;\n            }\n        }\n        cfg.action = targetMod + targetPosition;\n        // Once we start detecting illegal combinations, we'll\n        // return false in case of error\n        return true;\n    },\n\n    createTarget(selector) {\n        /* create a target that matches the selector\n         *\n         * Note: so far we only support #target and create a div with that id\n         * appended to the body.\n         */\n        if (selector.slice(0, 1) !== \"#\") {\n            log.error(\"only id supported for non-existing target\");\n            return null;\n        }\n        const $target = $(\"<div />\").attr({ id: selector.slice(1) });\n        $(\"body\").append($target);\n        return $target;\n    },\n\n    _performInjection(target, $el, $sources, cfg, trigger, $title) {\n        /* Called after the XHR has succeeded and we have a new $sources\n         * element to inject.\n         */\n        const wrapper = document.createElement(\"template\");\n        if ($sources.length > 0) {\n            const method = cfg.sourceMod === \"content\" ? \"innerHTML\" : \"outerHTML\";\n            // There might be multiple sources, so we need to loop over them.\n            // Access them with \"innerHTML\" or \"outerHTML\" depending on the sourceMod.\n            const sources_string = [...$sources].map(source => source[method]).join(\"\\n\");\n            wrapper.innerHTML = sources_string;\n\n            for (const img of wrapper.content.querySelectorAll(\"img\")) {\n                events.add_event_listener(\n                    img,\n                    \"load\",\n                    \"inject_img_load\",\n                    (e) => {\n                        $(e.currentTarget).trigger(\"pat-inject-content-loaded\");\n                    },\n                    { once: true }\n                );\n            }\n        }\n\n        // Copy, because after insertion wrapper.children is empty.\n        const source_nodes = [...wrapper.content.childNodes];\n\n        // Now the injection actually happens.\n        if (this._inject(trigger, source_nodes, target, cfg)) {\n            // Update history\n            this._update_history(cfg, trigger, $title);\n            // Post-injection\n            this._afterInjection($el, cfg.$created_target || $(source_nodes), cfg);\n        }\n    },\n\n    _update_history(cfg, trigger, $title) {\n        // History support. if subform is submitted, append form params\n        if (cfg.history !== \"record\" || !history?.pushState) {\n            return;\n        }\n        let url = cfg.url;\n        if (cfg.params) {\n            const glue = url.indexOf(\"?\") > -1 ? \"&\" : \"?\";\n            url = `${url}${glue}${cfg.params}`;\n        }\n        history.pushState({ url: url }, \"\", url);\n        // Also inject title element if we have one\n        if ($title?.length) {\n            const title_el = document.querySelector(\"title\");\n            if (title_el) {\n                this._inject(trigger, $title, title_el, {\n                    action: \"element\",\n                });\n            }\n        }\n    },\n\n    _afterInjection($el, $injected, cfg) {\n        /* Set a class on the injected elements and fire the\n         * patterns-injected event.\n         */\n        const el = utils.jqToNode($el);\n        $injected\n            .filter((idx, el_) => {\n                return el_.nodeType !== TEXT_NODE;\n            })\n            .data(\"pat-injected\", { origin: cfg.url });\n\n        if ($injected.length === 1 && $injected[0].nodeType == TEXT_NODE) {\n            // Only one element injected, and it was a text node.\n            // So we trigger \"patterns-injected\" on the parent.\n            // The event handler should check whether the\n            // injected element and the triggered element are\n            // the same.\n            $injected.parent().trigger(\"patterns-injected\", [cfg, el, $injected[0]]);\n        } else {\n            $injected.each((idx, el_) => {\n                // patterns-injected event will be triggered for each injected (non-text) element.\n                if (el_.nodeType !== TEXT_NODE) {\n                    $(el_)\n                        .addClass(cfg[\"class\"])\n                        .trigger(\"patterns-injected\", [cfg, el, el_]);\n                }\n            });\n        }\n\n        if (cfg.scroll && cfg.scroll !== \"none\") {\n            // Get the scroll target for\n            // 1) finding the scroll container\n            // 2) getting the element to scroll to (if not \"top\")\n            const scroll_target = [\"top\", \"target\"].includes(cfg.scroll)\n                ? cfg.$target[0]\n                : dom.querySelectorAllAndMe($injected[0], cfg.scroll);\n\n            const scroll_container = dom.find_scroll_container(\n                scroll_target,\n                null,\n                window\n            );\n\n            if (cfg.scroll === \"top\") {\n                dom.scroll_to_top(scroll_container);\n            } else if (scroll_target) {\n                dom.scroll_to_element(scroll_target, scroll_container);\n            }\n        }\n\n        el.dispatchEvent(\n            new Event(\"pat-inject-success\", { bubbles: true, cancelable: true })\n        );\n    },\n\n    async _onInjectSuccess($el, cfgs, ev) {\n        let data = ev?.jqxhr?.responseText;\n        if (!data) {\n            log.warn(\"No response content, aborting\", ev);\n            return;\n        }\n        if (cfgs[0].source === \"none\") {\n            // Special case, we want to call something, but we don't want to inject anything\n            data = \"\";\n        }\n        const sources$ = await this.callTypeHandler(cfgs[0].dataType, \"sources\", $el, [\n            cfgs,\n            data,\n            ev,\n        ]);\n        /* pick the title source for dedicated handling later\n          Title - if present - is always appended at the end. */\n        let $title;\n        if (\n            sources$ &&\n            sources$[sources$.length - 1] &&\n            sources$[sources$.length - 1][0] &&\n            sources$[sources$.length - 1][0].nodeName === \"TITLE\"\n        ) {\n            $title = sources$[sources$.length - 1];\n        }\n        cfgs.forEach((cfg, idx1) => {\n            const perform_inject = () => {\n                if (cfg.target !== \"none\") {\n                    for (const target of cfg.$target) {\n                        this._performInjection(\n                            target,\n                            $el,\n                            sources$[idx1],\n                            cfg,\n                            ev.target,\n                            $title\n                        );\n                    }\n                }\n            };\n            if (cfg.processDelay) {\n                setTimeout(() => perform_inject(), cfg.processDelay);\n            } else {\n                perform_inject();\n            }\n        });\n        if (cfgs[0].nextHref && $el.is(\"a\")) {\n            // In case next-href is specified the anchor's href will\n            // be set to it after the injection is triggered.\n            $el.attr({ href: cfgs[0].nextHref.replace(/&amp;/g, \"&\") });\n            this.destroy($el);\n        }\n        $el.off(\"pat-ajax-success.pat-inject\");\n        $el.off(\"pat-ajax-error.pat-inject\");\n    },\n\n    async _onInjectError($el, cfgs, event) {\n        let explanation = \"\";\n        const status = event.jqxhr.status;\n        const timestamp = new Date();\n        if (status % 100 == 4) {\n            explanation =\n                \"Sorry! We couldn't find the page to load. Please make a screenshot and send it to support. Thank you!\";\n        } else if (status % 100 == 5) {\n            explanation =\n                \"I am very sorry! There was an error at the server. Please make a screenshot and contact support. Thank you!\";\n        } else if (status == 0) {\n            explanation =\n                \"It seems, the server is down. Please make a screenshot and contact support. Thank you!\";\n        }\n\n        let error_page;\n        let error_page_fragment;\n        const url_params = new URLSearchParams(window.location.search);\n        if (url_params.get(\"pat-inject-errorhandler.off\") === null) {\n            // Prepare a error page to be injected into the document.\n\n            // Try to get a suitable error message from pre-configured error pages.\n            const error_page_url = document\n                ?.querySelector(`meta[name^=pat-inject-status-${status}]`)\n                ?.getAttribute(\"content\", false);\n            error_page_fragment = error_page_url?.split(\"#\")[1];\n            error_page_fragment = error_page_fragment ? `#${error_page_fragment}` : null;\n\n            if (error_page_fragment) {\n                error_page = document.createElement(\"html\");\n                error_page.innerHTML = event.jqxhr.responseText;\n                error_page = error_page.querySelector(error_page_fragment);\n            }\n\n            if (!error_page && error_page_url) {\n                try {\n                    const error_page_response = await fetch(error_page_url, {\n                        method: \"GET\",\n                    });\n                    error_page = document.createElement(\"html\");\n                    error_page.innerHTML = await error_page_response.text();\n                    error_page = error_page.querySelector(error_page_fragment || \"body\");\n                } catch {\n                    // fall back to standard error message and ignore.\n                }\n            }\n        }\n\n        // clean up\n        for (const cfg of cfgs) {\n            if (\"$created_target\" in cfg) {\n                cfg.$created_target.remove();\n            }\n            cfg.$target.removeClass(cfg.loadingClass);\n            $el.removeClass(cfg.executingClass);\n        }\n        $el.off(\"pat-ajax-success.pat-inject\");\n        $el.off(\"pat-ajax-error.pat-inject\");\n\n        if (error_page) {\n            const error_zone = document.querySelector(error_page_fragment || \"body\");\n            error_zone.innerHTML = error_page.innerHTML;\n            registry.scan(error_zone); // initialize any patterns in error page\n        } else {\n            const msg_attr = `${explanation} Status is ${status} ${event.jqxhr.statusText}, time was ${timestamp}. You can click to close this.`;\n            $(\"body\").attr(\"data-error-message\", msg_attr);\n            $(\"body\").on(\"click\", () => {\n                $(\"body\").removeAttr(\"data-error-message\");\n                window.location.href = window.location.href; // reload\n            });\n        }\n    },\n\n    execute(cfgs, $el) {\n        /* Actually execute the injection.\n         *\n         * Either by making an ajax request or by spoofing an ajax\n         * request when the content is readily available in the current page.\n         */\n        const el = utils.jqToNode($el);\n        // get a kinda deep copy, we scribble on it\n        cfgs = cfgs.map((cfg) => $.extend({}, cfg));\n        if (!this.verifyConfig(cfgs)) {\n            return;\n        }\n        if (!this.askForConfirmation(cfgs)) {\n            return;\n        }\n        if ($el.data(\"pat-inject-triggered\")) {\n            // Prevent double triggers;\n            return;\n        }\n        $el.data(\"pat-inject-triggered\", true);\n\n        for (const cfg of cfgs) {\n            // Add a execute class on the pat-inject element.\n            if (cfg?.executingClass) {\n                el.classList.add(cfg.executingClass);\n            }\n            // Add a loading class to the target.\n            // Can be used for loading-spinners.\n            if (cfg?.loadingClass && cfg?.target !== \"none\") {\n                cfg.$target.addClass(cfg.loadingClass);\n            }\n        }\n\n        $el.on(\"pat-ajax-success.pat-inject\", async (e) => {\n            this._onInjectSuccess($el, cfgs, e);\n\n            // Wait for the next tick to ensure that the close-panel listener\n            // is called before this one, even for non-async local injects.\n            await utils.timeout(1);\n            // Remove the close-panel event listener.\n            events.remove_event_listener(el, \"pat-inject--close-panel\");\n            // Only close the panel if a close-panel event was catched previously.\n            if (do_close_panel) {\n                do_close_panel = false;\n                // Re-trigger close-panel event if it was caught while injection was in progress.\n                el.dispatchEvent(\n                    new Event(\"close-panel\", { bubbles: true, cancelable: true })\n                );\n            }\n        });\n        $el.on(\"pat-ajax-error.pat-inject\", this._onInjectError.bind(this, $el, cfgs));\n        $el.on(\"pat-ajax-success.pat-inject pat-ajax-error.pat-inject\", () =>\n            $el.removeData(\"pat-inject-triggered\")\n        );\n\n        // Prevent closing the panel while injection is in progress.\n        let do_close_panel = false;\n        events.add_event_listener(el, \"close-panel\", \"pat-inject--close-panel\", (e) => {\n            e.stopPropagation();\n            e.stopImmediatePropagation();\n            do_close_panel = true;\n        });\n\n        if (cfgs[0].url.length) {\n            ajax.request($el, {\n                \"url\": cfgs[0].url,\n                \"browser-cache\": cfgs[0].browserCache,\n            });\n        } else {\n            // If there is no url specified, then content is being fetched\n            // from the same page.\n            // No need to do an ajax request for this, so we spoof the ajax\n            // event.\n            $el.trigger({\n                type: \"pat-ajax-success\",\n                jqxhr: {\n                    responseText: $(\"body\").html(),\n                },\n            });\n        }\n    },\n\n    _inject(trigger, source_nodes, target, cfg) {\n        if (cfg.source === \"none\") {\n            // Special case. Clear the target after ajax call.\n            target.replaceWith(\"\");\n            return true;\n        }\n        if (source_nodes.length === 0) {\n            log.warn(\"Aborting injection, source not found:\", source_nodes);\n            $(trigger).trigger(\"pat-inject-missingSource\", {\n                url: cfg.url,\n                selector: cfg.source,\n            });\n            return false;\n        }\n        if (cfg.target === \"none\") {\n            // Special case. Don't do anything, we don't want any result\n            return true;\n        }\n        if (!target) {\n            log.warn(\"Aborting injection, target not found:\", target);\n            $(trigger).trigger(\"pat-inject-missingTarget\", {\n                selector: cfg.target,\n            });\n            return false;\n        }\n\n        // cfg.action to DOM method mapping\n        const method = {\n            content: \"replaceChildren\",\n            contentafter: \"append\",\n            contentbefore: \"prepend\",\n            element: \"replaceWith\",\n            elementafter: \"after\",\n            elementbefore: \"before\",\n        }[cfg.action];\n\n        // Inject the content HERE!\n        target[method](...source_nodes);\n\n        return true;\n    },\n\n    _sourcesFromHtml(html, url, sources) {\n        const $html = this._parseRawHtml(html, url);\n        return sources.map((source) => {\n            if (source === \"body\") {\n                source = \"#__original_body\";\n            }\n            if (source === \"none\") {\n                return $(\"<!-- -->\");\n            }\n            const $source = $html.find(source);\n\n            if ($source.length === 0) {\n                if (source != \"title\") {\n                    log.warn(\"No source elements for selector:\", source, $html);\n                }\n            }\n\n            $source.find('a[href^=\"#\"]').each((idx, el_) => {\n                const href = el_.getAttribute(\"href\");\n                if (href.indexOf(\"#{1}\") !== -1) {\n                    // We ignore hrefs containing #{1} because they're not\n                    // valid and only applicable in the context of\n                    // pat-clone.\n                    return;\n                }\n                // Skip in-document links pointing to an id that is inside\n                // this fragment.\n                if (href.length === 1) {\n                    // Special case for top-of-page links\n                    el_.href = url;\n                } else if (!$source.find(href).length) {\n                    el_.href = url + href;\n                }\n            });\n            return $source;\n        });\n    },\n\n    _rebaseAttrs: {\n        a: \"href\",\n        form: \"action\",\n        img: \"src\",\n        object: \"data\",\n        source: \"src\",\n        video: \"src\",\n    },\n\n    _rebaseOptions: {\n        \"calendar\": [\"url\", \"event-sources\"],\n        \"collapsible\": [\"load-content\"],\n        \"date-picker\": [\"i18n\"],\n        \"datetime-picker\": [\"i18n\"],\n        \"inject\": [\"url\"],\n    },\n\n    _rebaseURL(base, url) {\n        if (url.indexOf(\"://\") !== -1 || url[0] === \"/\" || url.indexOf(\"data:\") === 0) {\n            return url;\n        }\n        base = new URL(base, window.location).href; // If base is relative make it absolute.\n        return base.slice(0, base.lastIndexOf(\"/\") + 1) + url;\n    },\n\n    _rebaseHTML(base, html) {\n        if (html === \"\") {\n            // Special case, source is none\n            return \"\";\n        }\n\n        // Parse the html string into a DOM tree.\n        const page = document.createElement(\"div\");\n        page.innerHTML = html;\n\n        // Create efficient selector for any tag with it's corresponding\n        // attribute from _rebaseAttrs. Note: the current data structure allows\n        // only for one attribute to be rebased per tag.\n        const rebase_selector = Object.entries(this._rebaseAttrs)\n            .map(([tag, attr]) => `${tag}[${attr}]`)\n            .join(\", \");\n        for (const el_ of page.querySelectorAll(rebase_selector)) {\n            const attr = this._rebaseAttrs[el_.nodeName.toLowerCase()];\n            let value = el_.getAttribute(attr);\n\n            if (\n                value &&\n                value.slice(0, 2) !== \"@@\" &&\n                value[0] !== \"#\" &&\n                value.slice(0, 7) !== \"mailto:\" &&\n                value.slice(0, 4) !== \"tel:\" &&\n                value.slice(0, 4) !== \"fax:\" &&\n                value.slice(0, 7) !== \"callto:\" &&\n                value.slice(0, 10) !== \"ts3server:\" &&\n                value.slice(0, 6) !== \"teams:\" &&\n                value.slice(0, 11) !== \"javascript:\"\n            ) {\n                value = this._rebaseURL(base, value);\n                el_.setAttribute(attr, value);\n            }\n        }\n\n        for (const [pattern_name, opts] of Object.entries(this._rebaseOptions)) {\n            for (const el_ of dom.querySelectorAllAndMe(\n                page,\n                `[data-pat-${pattern_name}]`\n            )) {\n                const pattern = registry.patterns?.[pattern_name];\n                const pattern_parser = pattern?.parser;\n                if (!pattern_parser) {\n                    continue;\n                }\n                // parse: no default options, possibly multiple configs, no grouping.\n                const options = pattern_parser.parse(el_, {}, true, false, false);\n                let changed = false;\n                for (const config of options) {\n                    for (const opt of opts) {\n                        const val = config[opt];\n                        if (!val) {\n                            continue;\n                        }\n                        changed = true;\n                        if (Array.isArray(val)) {\n                            config[opt] = val.map((it) => this._rebaseURL(base, it));\n                        } else {\n                            config[opt] = this._rebaseURL(base, val);\n                        }\n                    }\n                }\n                if (changed) {\n                    el_.setAttribute(\n                        `data-pat-${pattern_name}`,\n                        JSON.stringify(options.length === 1 ? options[0] : options)\n                    );\n                }\n            }\n        }\n\n        return page.innerHTML.trim();\n    },\n\n    _parseRawHtml(html, url = \"\") {\n        // remove script tags and head and replace body by a div\n        const title = html.match(/\\<title\\>(.*)\\<\\/title\\>/);\n        let clean_html = html\n            .replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, \"\")\n            .replace(/<head\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/head>/gi, \"\")\n            .replace(/<html([^>]*?)>/gi, \"\")\n            .replace(/<\\/html([^>]*?)>/gi, \"\")\n            .replace(/<body([^>]*?)>/gi, '<div id=\"__original_body\">')\n            .replace(/<\\/body([^>]*?)>/gi, \"</div>\");\n\n        if (title && title.length == 2) {\n            clean_html = title[0] + clean_html;\n        }\n        try {\n            clean_html = this._rebaseHTML(url, clean_html);\n        } catch (e) {\n            log.error(\"Error rebasing urls\", e);\n        }\n        const $html = $(\"<div/>\").html(clean_html);\n        if ($html.children().length === 0) {\n            log.warn(\"Parsing html resulted in empty jquery object:\", clean_html);\n        }\n        return $html;\n    },\n\n    _initAutoloadVisible($el, cfgs) {\n        if ($el.data(\"pat-inject-autoloaded\")) {\n            // ignore executed autoloads\n            return false;\n        }\n\n        const el = utils.jqToNode($el);\n\n        // delay: default is 200ms to allow scrolling over and past autoload-visible elements without loading them.\n        const delay = cfgs[0].delay || 200;\n        log.debug(`Delay time: ${delay}`);\n\n        // function to trigger the autoload and mark as triggered\n        const trigger = (event) => {\n            if ($el.data(\"pat-inject-autoloaded\")) {\n                log.debug(`autoload-visible trigger skipped ${el}`);\n                return false;\n            }\n            $el.data(\"pat-inject-autoloaded\", true);\n            this.onTrigger({ currentTarget: el });\n            event && event.preventDefault();\n            log.debug(`autoload-visible trigger run ${el}`);\n            return true;\n        };\n\n        // Config see: https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API\n        const intersection_observer_config = {\n            threshold: 0, // If even one pixel is visible, the callback will be run.\n            root: null, // Root is browser viewport. If the element is visible to the user, the callback will be run.\n            margin: \"0px\", // No margins. The element is not preloaded.\n        };\n\n        let timeout_id = null;\n        const observer = new IntersectionObserver((entries) => {\n            for (const entry of entries) {\n                if (entry.isIntersecting) {\n                    // Run the callback after 200ms to prevent loading all\n                    // visible elements when scrolling over.\n                    timeout_id = window.setTimeout(() => {\n                        observer.disconnect(); // Stop observing loaded elements.\n                        trigger();\n                    }, delay);\n                    log.debug(`autoload-visible intersecting ${el}`);\n                } else {\n                    window.clearTimeout(timeout_id);\n                    log.debug(`autoload-visible not intersecting ${el}`);\n                }\n            }\n        }, intersection_observer_config);\n        observer.observe(el);\n    },\n\n    _initIdleTrigger($el, delay) {\n        // TODO: handle item removed from DOM\n        const timeout = parseInt(delay, 10);\n        let timer;\n\n        const el = utils.jqToNode($el);\n\n        const onTimeout = () => {\n            this.onTrigger({ currentTarget: el });\n            unsub();\n            clearTimeout(timer);\n        };\n\n        const onInteraction = utils.debounce(() => {\n            if (!document.body.contains(el)) {\n                unsub();\n                return;\n            }\n            clearTimeout(timer);\n            timer = setTimeout(onTimeout, timeout);\n        }, timeout);\n\n        const unsub = () => {\n            for (const event of [\"scroll\", \"resize\"]) {\n                window.removeEventListener(event, onInteraction);\n            }\n            for (const event of [\n                \"click\",\n                \"keypress\",\n                \"keyup\",\n                \"mousemove\",\n                \"touchstart\",\n                \"touchend\",\n            ]) {\n                document.removeEventListener(event, onInteraction);\n            }\n        };\n\n        onInteraction();\n\n        for (const event of [\"scroll\", \"resize\"]) {\n            window.addEventListener(event, onInteraction);\n        }\n        for (const event of [\n            \"click\",\n            \"keypress\",\n            \"keyup\",\n            \"mousemove\",\n            \"touchstart\",\n            \"touchend\",\n        ]) {\n            document.addEventListener(event, onInteraction);\n        }\n    },\n\n    registerTypeHandler(type, handler) {\n        this.handlers[type] = handler;\n    },\n\n    async callTypeHandler(type, fn, context, params) {\n        type = type || \"html\";\n        if (this.handlers[type] && $.isFunction(this.handlers[type][fn])) {\n            return await this.handlers[type][fn].bind(this)(...params);\n        } else {\n            return null;\n        }\n    },\n\n    handlers: {\n        html: {\n            sources(cfgs, data) {\n                const sources = cfgs.map((cfg) => cfg.source);\n                sources.push(\"title\");\n                const result = this._sourcesFromHtml(data, cfgs[0].url, sources);\n                return result;\n            },\n        },\n    },\n};\n\n$(document).on(\"patterns-injected.inject\", async (ev, cfg, trigger, injected) => {\n    /* Listen for the patterns-injected event.\n     *\n     * Remove the \"loading-class\" classes from all injection targets and\n     * then scan the injected content for new patterns.\n     */\n    if (cfg?.skipPatInjectHandler) {\n        // Allow skipping this handler but still have other handlers in other\n        // patterns listen to ``patterns-injected``.\n        return;\n    }\n    if (cfg) {\n        cfg.$target.removeClass(cfg.loadingClass);\n        // Remove the executing class, add the executed class to the element with pat.inject on it.\n        $(trigger).removeClass(cfg.executingClass).addClass(cfg.executedClass);\n    }\n    if (injected.nodeType !== TEXT_NODE && injected.nodeType !== COMMENT_NODE) {\n        registry.scan(injected, null, { type: \"injection\", element: trigger });\n        $(injected).trigger(\"patterns-injected-scanned\");\n\n        await utils.timeout(10); // Wait a bit before dispatching next event.\n        injected.dispatchEvent(\n            new CustomEvent(\"patterns-injected-delayed\", {\n                bubbles: true,\n                cancelable: true,\n                detail: {\n                    injected: injected,\n                },\n            })\n        );\n    }\n});\n\n$(window).on(\"popstate\", (event) => {\n    // popstate also triggers on traditional anchors\n    if (!event.originalEvent.state && \"replaceState\" in history) {\n        try {\n            history.replaceState(\"anchor\", \"\", document.location.href);\n        } catch (e) {\n            log.debug(e);\n        }\n        return;\n    }\n    // Not only change the URL, also reload the page.\n    window.location.reload();\n});\n\n// this entry ensures that the initally loaded page can be reached with\n// the back button\nif (\"replaceState\" in history) {\n    try {\n        history.replaceState(\"pageload\", \"\", document.location.href);\n    } catch (e) {\n        log.debug(e);\n    }\n}\n\nregistry.register(inject);\nexport default inject;\n","import $ from \"jquery\";\nimport _t from \"../../core/i18n-wrapper\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"preventdoublesubmit\",\n    trigger: \".pat-preventdoublesubmit\",\n    parser: \"mockup\",\n    defaults: {\n        message: _t(\"You already clicked the submit button. Do you really want to submit this form again?\"), // prettier-ignore\n        guardClassName: \"submitting\",\n        optOutClassName: \"allowMultiSubmit\",\n    },\n    init() {\n        var self = this;\n\n        // if this is not a form just return\n        if (!self.$el.is(\"form\")) {\n            return;\n        }\n\n        $(\":submit\", self.$el).on(\"click\", function () {\n            // mark the button as clicked\n            $(\":submit\").removeAttr(\"clicked\");\n            $(this).attr(\"clicked\", \"clicked\");\n\n            // if submitting and no opt-out guardClassName is found\n            // pop up confirmation dialog\n            if (\n                $(this).hasClass(self.options.guardClassName) &&\n                !$(this).hasClass(self.options.optOutClassName)\n            ) {\n                return self._confirm.call(self);\n            }\n\n            $(this).addClass(self.options.guardClassName);\n        });\n    },\n\n    _confirm() {\n        return window.confirm(this.options.message);\n    },\n});\n","import Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"discussion-comments\",\n    trigger: \".pat-discussion\",\n\n    async init() {\n        // Async import implementation to reduce bundle size for controlpanels\n        const implementation = (await import(\"./discussion-comments--implementation\"))\n            .default;\n        const instance = new implementation(this.el);\n        instance.init();\n    },\n});\n","import utils from \"./utils\";\n\n// Event related methods and event factories\n\n// Event listener registration for easy-to-remove event listeners.\n// once Safari supports the ``signal`` option for addEventListener we can abort\n// event handlers by calling AbortController.abort().\nexport const event_listener_map = new Map();\n\n/**\n * Add an event listener to a DOM element under a unique id.\n * If a event is registered under the same id for the same element, the old handler is removed first.\n *\n * @param {DOM Node} el - The element to register the event for.\n * @param {string} event_type - The event type to listen for.\n * @param {string} id - A unique id under which the event is registered.\n * @param {function} cb - The event handler / callback function.\n * @param {Object} opts - Options for the addEventListener API.\n *\n */\nconst add_event_listener = (el, event_type, id, cb, opts = {}) => {\n    if (!el?.addEventListener) {\n        return; // nothing to do.\n    }\n    remove_event_listener(el, id); // do not register one listener twice.\n\n    // Create event_listener_map entry if not existent.\n    if (!event_listener_map.has(el)) {\n        event_listener_map.set(el, new Map());\n    }\n    let _cb = cb;\n    if (opts?.once === true) {\n        // For `once` events, also remove the entry from the event_listener_map.\n        _cb = (e) => {\n            event_listener_map.get(el)?.delete(id);\n            cb(e);\n        };\n    }\n    // Only `capture` option is necessary for `removeEventListener`.\n    event_listener_map\n        .get(el)\n        .set(id, [event_type, _cb, opts.capture ? opts : undefined]);\n    el.addEventListener(event_type, _cb, opts);\n};\n\n/**\n * Remove an event listener from a DOM element under a unique id.\n *\n * If an element and id are given, the event listeners for the given element matching the id are removed.\n * If an element but no id is given, all event listeners for that element are removed.\n * If an id but no element is given, all event listeners for any element matching the id are removed.\n * If no element and no id are given, all event listeners are removed.\n *\n * The id can be a wildcard string, e.g. `test-*-event`, which would match any\n * event which starts with \"test-\" and ends with \"-event\". The wildcard \"*\" can\n * be anywhere in the string and also be used multiple times. If no wildcard is\n * present the search string is used for an exact match.\n *\n * @param {DOM Node} [el] - The element to register the event for.\n * @param {string} [id] - A unique id under which the event is registered.\n *                        Can be a wildcard string.\n *\n */\nconst remove_event_listener = (el, id) => {\n    const els = el ? [el] : event_listener_map.keys();\n    for (const el of els) {\n        if (!el?.removeEventListener) {\n            return; // nothing to do.\n        }\n        const el_events = event_listener_map.get(el);\n        if (!el_events) {\n            return;\n        }\n        let entries;\n        if (id) {\n            // remove event listener with matching id\n            entries = [...el_events.entries()].filter((entry) =>\n                utils.regexp_from_wildcard(id).test(entry[0])\n            );\n        } else {\n            // remove all event listeners of element\n            entries = el_events.entries();\n        }\n        for (const entry of entries || []) {\n            // Remove event listener\n            el.removeEventListener(entry[1][0], entry[1][1], entry[1][2]);\n            // Delete entry from event_listener_map\n            event_listener_map.get(el).delete(entry[0]);\n            // Delete element from event_listener_map if no more events are registered.\n            if (!event_listener_map.get(el).size) {\n                event_listener_map.delete(el);\n            }\n        }\n    }\n};\n\n/**\n * Await an event to be thrown.\n *\n * Usage:\n *     await events.await_event(button, \"click\");\n *\n * @param {DOM Node} el - The element to listen on.\n * @param {String} event_name - The event name to listen for.\n *\n * @returns {Promise} - Returns a Promise which can be used for ``await`` and which will be resolved when the event is throwm.\n *\n */\nconst await_event = (el, event_name) => {\n    // See: https://stackoverflow.com/a/44746691/1337474\n    return new Promise((resolve) =>\n        el.addEventListener(event_name, resolve, { once: true })\n    );\n};\n\n/**\n * Await pattern init.\n *\n * Usage:\n *     await events.await_pattern_init(PATTERN);\n *\n * @param {Pattern instance} pattern - The pattern instance.\n *\n * @returns {Promise} - Returns a Promise which can be used for ``await`` and which will be resolved when the event is throwm.\n *\n */\nconst await_pattern_init = (pattern) => {\n    // See: https://stackoverflow.com/a/44746691/1337474\n    return new Promise((resolve, reject) => {\n        // Case initialized\n        pattern.one(\"init\", (e) => {\n            if (e.target !== pattern.el) {\n                // Don't handle bubbling init events from child elements. We\n                // want to check on init events coming directly from this\n                // Pattern's element.\n                return;\n            }\n            // Resolve promise and unregister the not-init event handler.\n            remove_event_listener(\n                pattern.el,\n                `basepattern-one--not-init.${pattern.name}.patterns`\n            );\n            resolve();\n        });\n\n        // Case not initialized\n        pattern.one(\"not-init\", (e) => {\n            if (e.target !== pattern.el) {\n                // Don't handle bubbling not-init events from child elements.\n                // We want to check on not-init events coming directly from\n                // this Pattern's element.\n                return;\n            }\n            // Reject promise and unregister the init event handler.\n            remove_event_listener(\n                pattern.el,\n                `basepattern-one--init.${pattern.name}.patterns`\n            );\n            reject();\n        });\n    }).catch(() => {\n        throw new Error(`Pattern \"${pattern.name}\" not initialized.`);\n    });\n};\n\n/**\n * Event factories\n */\n\n/** Generic event factory.\n *\n * A event factory for a bubbling and cancelable generic event.\n *\n * @param {string} name - The event name.\n * @returns {Event} - Returns a blur event.\n */\nconst generic_event = (name) => {\n    return new Event(name, {\n        bubbles: true,\n        cancelable: true,\n    });\n};\n\n\n/** Patternslib specifc event factories\n */\n\nclass UpdateEvent extends CustomEvent {\n    constructor(options) {\n        super(\"pat-update\", {\n            bubbles: true,\n            cancelable: true,\n            detail: options\n        });\n    }\n}\n\nconst update_event = (options) => {\n    return new UpdateEvent(options);\n}\n\n\n/** Web API event factories\n */\n\nconst blur_event = () => {\n    return new Event(\"blur\", {\n        bubbles: false,\n        cancelable: false,\n    });\n};\n\nconst click_event = () => {\n    return new Event(\"click\", {\n        bubbles: true,\n        cancelable: true,\n    });\n};\n\nconst change_event = () => {\n    return new Event(\"change\", {\n        bubbles: true,\n        cancelable: false,\n    });\n};\n\nconst focus_event = () => {\n    return new Event(\"focus\", {\n        bubbles: false,\n        cancelable: false,\n    });\n};\n\nconst input_event = () => {\n    return new Event(\"input\", {\n        bubbles: true,\n        cancelable: false,\n    });\n};\n\nconst mousedown_event = () => {\n    return new Event(\"mousedown\", {\n        bubbles: true,\n        cancelable: true,\n    });\n};\n\nconst mouseup_event = () => {\n    return new Event(\"mouseup\", {\n        bubbles: true,\n        cancelable: true,\n    });\n};\n\nconst scroll_event = () => {\n    return new Event(\"scroll\", {\n        bubbles: true,\n        cancelable: false,\n    });\n};\n\nconst submit_event = ({ submitter } = { submitter: undefined }) => {\n    const event = new Event(\"submit\", {\n        bubbles: true,\n        cancelable: true,\n    });\n    event.submitter = submitter; // undefined or the submitting element\n    return event;\n};\n\nconst dragstart_event = () => {\n    return new Event(\"dragstart\", {\n        bubbles: true,\n        cancelable: true,\n    });\n};\n\nconst dragend_event = () => {\n    return new Event(\"dragend\", {\n        bubbles: true,\n        cancelable: true,\n    });\n};\n\nexport default {\n    add_event_listener: add_event_listener,\n    remove_event_listener: remove_event_listener,\n    await_event: await_event,\n    await_pattern_init: await_pattern_init,\n    generic_event: generic_event,\n    update_event: update_event,\n    blur_event: blur_event,\n    click_event: click_event,\n    change_event: change_event,\n    focus_event: focus_event,\n    input_event: input_event,\n    mousedown_event: mousedown_event,\n    mouseup_event: mouseup_event,\n    scroll_event: scroll_event,\n    submit_event: submit_event,\n    dragstart_event: dragstart_event,\n    dragend_event: dragend_event,\n};\n","import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"formautofocus\",\n    trigger: \".pat-formautofocus\",\n    parser: \"mockup\",\n    defaults: {\n        condition: \"div.error\",\n        target: \"div.error :input:not(.formTabs):visible:first\",\n        always: \":input:not(.formTabs):visible:first\",\n    },\n    init() {\n        if ($(this.options.condition, this.$el).length !== 0) {\n            $(this.options.target, this.$el).focus();\n        } else {\n            $(this.options.always, this.$el).focus();\n        }\n    },\n});\n","import Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"structure\",\n    trigger: \".pat-structure\",\n    parser: \"mockup\",\n    defaults: {\n        // for implementing history changes\n        // Example: {base: 'http://mysite.com', appended: '/folder_contents'}\n        urlStructure: null,\n        vocabularyUrl: null,\n        indexOptionsUrl: null, // for querystring widget\n        contextInfoUrl: null, // for add new dropdown and other info\n        setDefaultPageUrl: null,\n        menuOptions: null, // default action menu options per item.\n        backdropSelector: \".plone-modal\", // Element upon which to apply backdrops used for popovers\n\n        activeColumnsCookie: \"activeColumns\",\n\n        attributes: [\n            \"CreationDate\",\n            \"EffectiveDate\",\n            \"ExpirationDate\",\n            \"exclude_from_nav\",\n            \"getIcon\",\n            \"getMimeIcon\",\n            \"getObjSize\",\n            \"getURL\",\n            \"id\",\n            \"is_folderish\",\n            \"last_comment_date\",\n            \"ModificationDate\",\n            \"path\",\n            \"portal_type\",\n            \"review_state\",\n            \"Subject\",\n            \"Title\",\n            \"total_comments\",\n            \"UID\",\n        ],\n\n        activeColumns: [\"ModificationDate\", \"EffectiveDate\", \"review_state\"],\n\n        availableColumns: {\n            id: \"ID\",\n            ModificationDate: \"Last modified\",\n            EffectiveDate: \"Published\",\n            ExpirationDate: \"Expiration\",\n            CreationDate: \"Created\",\n            review_state: \"Review state\",\n            Subject: \"Tags\",\n            portal_type: \"Type\",\n            is_folderish: \"Folder\",\n            exclude_from_nav: \"Excluded from navigation\",\n            getObjSize: \"Object Size\",\n            last_comment_date: \"Last comment date\",\n            total_comments: \"Total comments\",\n        },\n\n        typeToViewAction: {\n            File: \"/view\",\n            Image: \"/view\",\n            Blob: \"/view\",\n        },\n\n        defaultPageTypes: [\"Document\", \"Event\", \"News Item\", \"Collection\"],\n\n        language: \"en\",\n        dateFormat: {\n            dateStyle: \"medium\",\n            timeStyle: \"medium\",\n        },\n        rearrange: {\n            properties: {\n                id: \"ID\",\n                sortable_title: \"Title\",\n                // icon: \"plone-rearrange\",\n            },\n            url: \"/rearrange\",\n        },\n        moveUrl: null,\n\n        buttons: [\n            {\n                tooltip: \"Cut\",\n                url: \"/cut\",\n                icon: \"plone-cut\",\n            },\n            {\n                tooltip: \"Copy\",\n                url: \"/copy\",\n                icon: \"plone-copy\",\n            },\n            {\n                tooltip: \"Paste\",\n                url: \"/paste\",\n                icon: \"plone-paste\",\n            },\n            {\n                tooltip: \"Delete\",\n                url: \"/delete\",\n                context: \"danger\",\n                icon: \"plone-delete\",\n            },\n            {\n                tooltip: \"Workflow\",\n                url: \"/workflow\",\n                icon: \"plone-lock\",\n            },\n            {\n                tooltip: \"Tags\",\n                url: \"/tags\",\n                icon: \"tags\",\n            },\n            {\n                tooltip: \"Properties\",\n                url: \"/properties\",\n                icon: \"plone-edit\",\n            },\n            {\n                tooltip: \"Rename\",\n                url: \"/rename\",\n                icon: \"plone-rename\",\n            },\n        ],\n\n        datatables_options: {},\n\n        upload: {\n            uploadMultiple: true,\n            showTitle: true,\n        },\n    },\n\n    async init() {\n        import(\"./structure.scss\");\n        (await import(\"bootstrap\")).Dropdown;\n\n        // backbone paginator, loaded by app-view expects Backbone and\n        // Underscore to be in global namespace.\n        const _ = (await import(\"underscore\")).default;\n        const Backbone = (await import(\"backbone\")).default;\n        window._ = _;\n        window.Backbone = Backbone;\n\n        const AppView = (await import(\"./js/views/app\")).default;\n\n        this.browsing = true; // so all queries will be correct with QueryHelper\n        this.options.collectionUrl = this.options.vocabularyUrl;\n        this.options.pattern = this;\n        this.options.language =\n            document.querySelector(\"html\").getAttribute(\"lang\") || \"en\";\n\n        // the ``attributes`` options key is not compatible with backbone,\n        // but queryHelper that will be constructed by the default\n        // ResultCollection will expect this to be passed into it.\n        this.options.queryHelperAttributes = this.options.attributes;\n        delete this.options.attributes;\n\n        const view = new AppView(this.options);\n        await view.render();\n        this.$el.append(view.$el);\n    },\n});\n","import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport _ from \"underscore\";\nimport Backdrop from \"../backdrop/backdrop\";\nimport registry from \"@patternslib/patternslib/src/core/registry\";\nimport dom from \"@patternslib/patternslib/src/core/dom\";\nimport utils from \"../../core/utils\";\nimport _t from \"../../core/i18n-wrapper\";\n\nimport \"jquery-form\";\n\nexport default Base.extend({\n    name: \"plone-modal\",\n    trigger: \".pat-plone-modal\",\n    parser: \"mockup\",\n    createModal: null,\n    $model: null,\n    defaults: {\n        width: \"\",\n        height: \"\",\n        modalSizeClass: \"\",\n        margin: 0,\n        position: \"center middle\", // format: '<horizontal> <vertical>' -- allowed values: top, bottom, left, right, center, middle\n        triggers: [],\n        zIndexSelector: \".modal-wrapper,.modal-backdrop\",\n        backdrop: \"body\", // Element to initiate the Backdrop on.\n        backdropOptions: {\n            zIndex: \"1040\",\n            opacity: \"0.85\",\n            className: \"modal-backdrop\",\n            classActiveName: \"backdrop-active\",\n            closeOnEsc: true,\n            closeOnClick: true,\n        },\n        title: null,\n        titleSelector: \"h1:first\",\n        buttons: '.formControls > input[type=\"submit\"], .formControls > button',\n        content: \"#content\",\n        automaticallyAddButtonActions: true,\n        loadLinksWithinModal: true,\n        prependContent: \".portalMessage\",\n        onRender: null,\n        templateOptions: {\n            className: \"modal fade\",\n            classDialog: \"modal-dialog\",\n            classModal: \"modal-content\",\n            classHeaderName: \"modal-header\",\n            classBodyName: \"modal-body\",\n            classFooterName: \"modal-footer\",\n            classWrapperName: \"modal-wrapper\",\n            classWrapperInnerName: \"modal-wrapper-inner\",\n            classActiveName: \"show\",\n            classPrependName: \"\", // String, css class to be applied to the wrapper of the prepended content\n            classContentName: \"\", // String, class name to be applied to the content of the modal, useful for modal specific styling\n            template:\n                \"\" +\n                '<div class=\"<%= options.className %>\">' +\n                '  <div class=\"<%= options.classDialog %><% if (modalSizeClass) { %> <%= modalSizeClass %><% } %>\" role=\"dialog\" <% if (title) { %>aria-labelledby=\"modal-title\" <% } %> tabindex=\"-1\">' +\n                '    <div class=\"<%= options.classModal %>\" role=\"document\">' +\n                '      <div class=\"<%= options.classHeaderName %>\">' +\n                '        <% if (title) { %><h5 class=\"modal-title\" id=\"modal-title\" tabindex=\"0\"><%= title %></h5><% } %>' +\n                '        <button type=\"button\" class=\"btn-close modal-close\" aria-label=\"<%= closeButtonLabel %>\"></button>' +\n                \"      </div>\" +\n                '      <div class=\"<%= options.classBodyName %>\">' +\n                '        <div class=\"<%= options.classPrependName %>\"><%= prepend %></div> ' +\n                '        <div class=\"<%= options.classContentName %>\"><%= content %></div>' +\n                \"      </div>\" +\n                '      <div class=\"<%= options.classFooterName %>\"> ' +\n                \"        <% if (buttons) { %><%= buttons %><% } %>\" +\n                \"      </div>\" +\n                \"    </div>\" +\n                \"  </div>\" +\n                \"</div>\",\n        },\n        actions: {},\n        actionOptions: {\n            eventType: \"click\",\n            disableAjaxFormSubmit: false,\n            target: null,\n            ajaxUrl: null, // string, or function($el, options) that returns a string\n            modalFunction: null, // String, function name on self to call\n            isForm: false,\n            timeout: 5000,\n            displayInModal: true,\n            reloadWindowOnClose: true,\n            error: \".portalMessage.error, .alert-danger\",\n            formFieldError: \".field.error\",\n            onSuccess: null,\n            onError: null,\n            onFormError: null,\n            onTimeout: null,\n            redirectOnResponse: false,\n            redirectToUrl: function ($action, response) {\n                var reg;\n                reg = /<body.*data-view-url=[\\\"'](.*)[\\\"'].*/im.exec(response);\n                if (reg && reg.length > 1) {\n                    // view url as data attribute on body (Plone 5)\n                    return reg[1].split('\"')[0];\n                }\n                reg = /<body.*data-base-url=[\\\"'](.*)[\\\"'].*/im.exec(response);\n                if (reg && reg.length > 1) {\n                    // Base url as data attribute on body (Plone 5)\n                    return reg[1].split('\"')[0];\n                }\n                reg = /<base.*href=[\\\"'](.*)[\\\"'].*/im.exec(response);\n                if (reg && reg.length > 1) {\n                    // base tag available (Plone 4)\n                    return reg[1];\n                }\n                return \"\";\n            },\n        },\n        form: function (actions) {\n            var self = this;\n            var $modal = self.$modal;\n\n            if (self.options.automaticallyAddButtonActions) {\n                actions[self.options.buttons] = {};\n            }\n            actions.a = {};\n\n            $.each(actions, function (action, options) {\n                var actionKeys = _.union(_.keys(self.options.actionOptions), [\n                    \"templateOptions\",\n                ]);\n                var actionOptions = $.extend(\n                    true,\n                    {},\n                    self.options.actionOptions,\n                    _.pick(options, actionKeys)\n                );\n                options.templateOptions = $.extend(\n                    true,\n                    options.templateOptions,\n                    self.options.templateOptions\n                );\n\n                var patternKeys = _.union(_.keys(self.options.actionOptions), [\n                    \"actions\",\n                    \"actionOptions\",\n                ]);\n                var patternOptions = $.extend(\n                    true,\n                    _.omit(options, patternKeys),\n                    self.options\n                );\n                $(action, $(\".\" + options.templateOptions.classBodyName, $modal)).each(\n                    function () {\n                        var $action = $(this);\n                        $action.on(actionOptions.eventType, function (e) {\n                            e.stopPropagation();\n                            e.preventDefault();\n\n                            self.loading.show(false);\n\n                            // handle event on $action using a function on self\n                            if (actionOptions.modalFunction !== null) {\n                                self[actionOptions.modalFunction]();\n                                // handle event on input/button using jquery.form library\n                            } else if (\n                                $.nodeName($action[0], \"input\") ||\n                                $.nodeName($action[0], \"button\") ||\n                                options.isForm === true\n                            ) {\n                                self.options.handleFormAction.apply(self, [\n                                    $action,\n                                    actionOptions,\n                                    patternOptions,\n                                ]);\n                                // handle event on link with jQuery.ajax\n                            } else if (\n                                options.ajaxUrl !== null ||\n                                $.nodeName($action[0], \"a\")\n                            ) {\n                                self.options.handleLinkAction.apply(self, [\n                                    $action,\n                                    actionOptions,\n                                    patternOptions,\n                                ]);\n                            }\n                        });\n                    }\n                );\n            });\n        },\n        handleFormAction: function ($action, options, patternOptions) {\n            var self = this;\n\n            // pass action that was clicked when submiting form\n            var extraData = {};\n            extraData[$action.attr(\"name\")] = $action.attr(\"value\");\n\n            var $form;\n\n            if ($.nodeName($action[0], \"form\")) {\n                $form = $action;\n            } else {\n                $form = $action.parents(\"form:not(.disableAutoSubmit)\");\n            }\n\n            var url;\n            if (options.ajaxUrl !== null) {\n                if (typeof options.ajaxUrl === \"function\") {\n                    url = options.ajaxUrl.apply(self, [$action, options]);\n                } else {\n                    url = options.ajaxUrl;\n                }\n            } else {\n                url = $action.parents(\"form\").attr(\"action\");\n            }\n\n            if (options.disableAjaxFormSubmit) {\n                if ($action.attr(\"name\") && $action.attr(\"value\")) {\n                    $form.append(\n                        $(\n                            '<input type=\"hidden\" name=\"' +\n                            $action.attr(\"name\") +\n                            '\" value=\"' +\n                            $action.attr(\"value\") +\n                            '\" />'\n                        )\n                    );\n                }\n                $form.trigger(\"submit\");\n                return;\n            }\n            // We want to trigger the form submit event but NOT use the default\n            $form.on(\"submit\", function (e) {\n                e.preventDefault();\n            });\n            $form.trigger(\"submit\");\n\n            self.loading.show(false);\n            $form.ajaxSubmit({\n                timeout: options.timeout,\n                data: extraData,\n                url: url,\n                error: function (xhr, textStatus, errorStatus) {\n                    self.loading.hide();\n                    if (textStatus === \"timeout\" && options.onTimeout) {\n                        options.onTimeout.apply(self, xhr, errorStatus);\n                        // on \"error\", \"abort\", and \"parsererror\"\n                    } else if (options.onError) {\n                        if (typeof options.onError === \"string\") {\n                            window[options.onError](xhr, textStatus, errorStatus);\n                        } else {\n                            options.onError(xhr, textStatus, errorStatus);\n                        }\n                    } else {\n                        // window.alert(_t('There was an error submitting the form.'));\n                        console.log(\"error happened\", textStatus, \" do something\");\n                    }\n                    self.emit(\"formActionError\", [xhr, textStatus, errorStatus]);\n                },\n                success: function (response, state, xhr, form) {\n                    self.loading.hide();\n                    // if error is found (NOTE: check for both the portal errors\n                    // and the form field-level errors)\n                    if (\n                        $(options.error, response).length !== 0 ||\n                        $(options.formFieldError, response).length !== 0\n                    ) {\n                        if (options.onFormError) {\n                            if (typeof options.onFormError === \"string\") {\n                                window[options.onFormError](\n                                    self,\n                                    response,\n                                    state,\n                                    xhr,\n                                    form\n                                );\n                            } else {\n                                options.onFormError(self, response, state, xhr, form);\n                            }\n                        } else {\n                            self.redraw(response, patternOptions);\n                        }\n                        return;\n                    }\n\n                    if (options.redirectOnResponse === true) {\n                        if (typeof options.redirectToUrl === \"function\") {\n                            window.parent.location.href = options.redirectToUrl.apply(\n                                self,\n                                [$action, response, options]\n                            );\n                        } else {\n                            window.parent.location.href = options.redirectToUrl;\n                        }\n                        return; // cut out right here since we're changing url\n                    }\n\n                    if (options.onSuccess) {\n                        if (typeof options.onSuccess === \"string\") {\n                            window[options.onSuccess](self, response, state, xhr, form);\n                        } else {\n                            options.onSuccess(self, response, state, xhr, form);\n                        }\n                    }\n\n                    if (options.displayInModal === true) {\n                        self.redraw(response, patternOptions);\n                    } else {\n                        $action.trigger(\"destroy.plone-modal.patterns\");\n                        // also calls hide\n                        if (options.reloadWindowOnClose) {\n                            self.reloadWindow();\n                        }\n                    }\n                    self.emit(\"formActionSuccess\", [response, state, xhr, form]);\n                },\n            });\n        },\n        handleLinkAction: function ($action, options, patternOptions) {\n            var self = this;\n            var url;\n            if ($action.hasClass(\"pat-plone-modal\")) {\n                // if link is a modal pattern, do not reload the page\n                return;\n            }\n\n            // Figure out URL\n            if (options.ajaxUrl) {\n                if (typeof options.ajaxUrl === \"function\") {\n                    url = options.ajaxUrl.apply(self, [$action, options]);\n                } else {\n                    url = options.ajaxUrl;\n                }\n            } else {\n                url = $action.attr(\"href\");\n            }\n\n            // Non-ajax link (I know it says \"ajaxUrl\" ...)\n            if (options.displayInModal === false) {\n                if ($action.attr(\"target\") === \"_blank\") {\n                    window.open(url, \"_blank\");\n                    self.loading.hide();\n                } else {\n                    window.location = url;\n                }\n                return;\n            }\n\n            // ajax version\n            $.ajax({\n                url: url,\n            })\n                .fail(function (xhr, textStatus, errorStatus) {\n                    if (textStatus === \"timeout\" && options.onTimeout) {\n                        options.onTimeout(self.$modal, xhr, errorStatus);\n\n                        // on \"error\", \"abort\", and \"parsererror\"\n                    } else if (options.onError) {\n                        options.onError(xhr, textStatus, errorStatus);\n                    } else {\n                        window.alert(_t(\"There was an error loading modal.\"));\n                    }\n                    self.emit(\"linkActionError\", [xhr, textStatus, errorStatus]);\n                })\n                .done(function (response, state, xhr) {\n                    self.redraw(response, patternOptions);\n                    if (options.onSuccess) {\n                        if (typeof options.onSuccess === \"string\") {\n                            window[options.onSuccess](self, response, state, xhr);\n                        } else {\n                            options.onSuccess(self, response, state, xhr);\n                        }\n                    }\n\n                    self.emit(\"linkActionSuccess\", [response, state, xhr]);\n                })\n                .always(function () {\n                    self.loading.hide();\n                });\n        },\n        render: function (options) {\n            var self = this;\n\n            self.emit(\"before-render\");\n\n            if (!self.$raw) {\n                return;\n            }\n            var $raw = self.$raw.clone();\n\n            // Object that will be passed to the template\n            var tplObject = {\n                title: \"\",\n                prepend: \"<div />\",\n                content: \"\",\n                modalSizeClass: options.modalSizeClass,\n                buttons: '<div class=\"pattern-modal-buttons\"></div>',\n                options: options.templateOptions,\n                closeButtonLabel: _t(\"Close\"),\n            };\n\n            // setup the Title\n            if (options.title === null) {\n                var $title = $(options.titleSelector, $raw);\n                tplObject.title = $title.html();\n                $(options.titleSelector, $raw).remove();\n            } else {\n                tplObject.title = options.title;\n            }\n\n            // Grab items to to insert into the prepend area\n            if (options.prependContent) {\n                tplObject.prepend = $(\"<div />\")\n                    .append($(options.prependContent, $raw).clone())\n                    .html();\n                $(options.prependContent, $raw).remove();\n            }\n\n            // Filter out the content if there is a selector provided\n            if (options.content) {\n                tplObject.content = $(options.content, $raw).html();\n            } else {\n                tplObject.content = $raw.html();\n            }\n\n            // Render html\n            self.$modal = $(\n                _.template(self.options.templateOptions.template)(tplObject)\n            );\n            self.$modalDialog = $(\n                \"> .\" + self.options.templateOptions.classDialog,\n                self.$modal\n            );\n            self.$modalContent = $(\n                \"> .\" + self.options.templateOptions.classModal,\n                self.$modalDialog\n            );\n\n            // In most browsers, when you hit the enter key while a form element is focused\n            // the browser will trigger the form 'submit' event.  Google Chrome also does this,\n            // but not when when the default submit button is hidden with 'display: none'.\n            // The following code will work around this issue:\n            $(\"form\", self.$modal).on(\"keydown\", function (event) {\n                // ignore keys which are not enter, and ignore enter inside a textarea.\n                if (event.key !== \"Enter\" || event.target.nodeName === \"TEXTAREA\") {\n                    return;\n                }\n                event.preventDefault();\n                $(\"input[type=submit], button[type=submit], button:not(type)\", this)\n                    .eq(0)\n                    .trigger(\"click\");\n            });\n\n            // Setup buttons\n            $(options.buttons, self.$modal).each(function () {\n                var $button = $(this);\n                $button\n                    .on(\"click\", function (e) {\n                        e.stopPropagation();\n                        e.preventDefault();\n                    })\n                    .clone()\n                    .appendTo($(\".pattern-modal-buttons\", self.$modal))\n                    .off(\"click\")\n                    .on(\"click\", function (e) {\n                        e.stopPropagation();\n                        e.preventDefault();\n                        $button.trigger(\"click\");\n                    });\n                $button.hide();\n            });\n\n            self.emit(\"before-events-setup\");\n\n            // Wire up events\n            self.$modal[0]\n                .querySelectorAll(\n                    `.modal-header > .modal-close,\n                 .modal-footer > .pattern-modal-buttons > .modal-close,\n                 .modal-footer [name=\"form.buttons.Cancel\" i]`\n                )\n                .forEach((el) => {\n                    $(el)\n                        .off(\"click\")\n                        .on(\"click\", (e) => {\n                            e.stopPropagation();\n                            e.preventDefault();\n                            $(e.target).trigger(\"destroy.plone-modal.patterns\");\n                        });\n                });\n\n            // form\n            if (options.form) {\n                options.form.apply(self, [options.actions]);\n            }\n\n            self.$modal\n                .addClass(self.options.templateOptions.className)\n                .on(\"destroy.plone-modal.patterns\", function (e) {\n                    e.stopPropagation();\n                    self.hide();\n                })\n                .on(\"resize.plone-modal.patterns\", function (e) {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    self.positionModal();\n                })\n                .appendTo(self.$wrapperInner);\n\n            if (self.options.loadLinksWithinModal) {\n                self.$modal.on(\"click\", function (e) {\n                    e.stopPropagation();\n                    if ($.nodeName(e.target, \"a\")) {\n                        e.preventDefault();\n                        // TODO: open links inside modal\n                        // and slide modal body\n                    }\n                    self.$modal.trigger(\"modal-click\");\n                });\n            }\n            self.$modal.data(\"pattern-\" + self.name, self);\n            self.emit(\"after-render\");\n            if (options.onRender) {\n                if (typeof options.onRender === \"string\") {\n                    window[options.onRender](self);\n                } else {\n                    options.onRender(self);\n                }\n            }\n        },\n    },\n    reloadWindow: function () {\n        window.parent.location.reload();\n    },\n    init: function () {\n        import(\"./modal.scss\");\n\n        var self = this;\n        self.options.loadLinksWithinModal = $.parseJSON(\n            self.options.loadLinksWithinModal\n        );\n\n        if (self.options.backdropOptions.closeOnEsc === true) {\n            $(document).on(\"keydown\", function (e) {\n                if (self.$el.is(\".\" + self.options.templateOptions.classActiveName)) {\n                    if (e.key === \"Esc\") {\n                        // ESC key pressed\n                        self.hide();\n                    }\n                }\n            });\n        }\n\n        $(window.parent).resize(function () {\n            self.positionModal();\n        });\n\n        if (self.options.triggers) {\n            $.each(self.options.triggers, function (i, item) {\n                var e = item.substring(0, item.indexOf(\" \"));\n                var selector = item.substring(item.indexOf(\" \"), item.length);\n                $(selector || self.$el).on(e, function (e) {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    self.show();\n                });\n            });\n        }\n\n        if (self.$el.is(\"a\")) {\n            if (self.$el.attr(\"href\") && !self.options.image) {\n                if (\n                    !self.options.target &&\n                    self.$el.attr(\"href\").substr(0, 1) === \"#\" &&\n                    self.$el.attr(\"href\").length > 1\n                ) {\n                    self.options.target = self.$el.attr(\"href\");\n                    self.options.content = \"\";\n                }\n                if (\n                    !self.options.ajaxUrl &&\n                    self.$el.attr(\"href\").substr(0, 1) !== \"#\"\n                ) {\n                    self.options.ajaxUrl = function () {\n                        // Resolve ``href`` attribute later, when modal is shown.\n                        return self.$el.attr(\"href\");\n                    };\n                }\n            }\n            self.$el.on(\"click\", function (e) {\n                e.stopPropagation();\n                e.preventDefault();\n                self.show();\n            });\n        }\n        self.initModal();\n    },\n\n    createAjaxModal: function () {\n        var self = this;\n        self.emit(\"before-ajax\");\n        self.loading.show();\n\n        var ajaxUrl = self.options.ajaxUrl;\n        if (typeof ajaxUrl === \"function\") {\n            ajaxUrl = ajaxUrl.apply(self, [self.options]);\n        }\n\n        self.ajaxXHR = $.ajax({\n            url: ajaxUrl,\n            type: self.options.ajaxType,\n        })\n            .done(function (response, textStatus, xhr) {\n                self.ajaxXHR = undefined;\n                self.$raw = $(\"<div />\").append($(utils.parseBodyTag(response)));\n                self.emit(\"after-ajax\", self, textStatus, xhr);\n                self._show();\n            })\n            .fail(function (xhr, textStatus, errorStatus) {\n                var options = self.options.actionOptions;\n                if (textStatus === \"timeout\" && options.onTimeout) {\n                    options.onTimeout(self.$modal, xhr, errorStatus);\n                } else if (options.onError) {\n                    options.onError(xhr, textStatus, errorStatus);\n                } else {\n                    window.alert(_t(\"There was an error loading modal.\"));\n                    self.hide();\n                }\n                self.emit(\"linkActionError\", [xhr, textStatus, errorStatus]);\n            })\n            .always(function () {\n                self.loading.hide();\n            });\n    },\n\n    createTargetModal: function () {\n        var self = this;\n        self.$raw = $(self.options.target).clone();\n        self._show();\n    },\n\n    createBasicModal: function () {\n        var self = this;\n        self.$raw = $(\"<div/>\").html(self.$el.clone());\n        self._show();\n    },\n\n    createHtmlModal: function () {\n        var self = this;\n        var $el = $(self.options.html);\n        self.$raw = $el;\n        self._show();\n    },\n\n    createImageModal: function () {\n        var self = this;\n        self.$wrapper.addClass(\"image-modal\");\n        var src = self.$el.attr(\"href\");\n        var srcset = self.$el.attr(\"data-modal-srcset\") || \"\";\n        var title = $.trim(self.$el.context.innerText) || \"Image\";\n        // XXX aria?\n        self.$raw = $(\n            \"<div><h1>\" +\n            title +\n            '</h1><div id=\"content\"><div class=\"modal-image\"><img src=\"' +\n            src +\n            '\" srcset=\"' +\n            srcset +\n            '\" /></div></div></div>'\n        );\n        self._show();\n    },\n\n    initModal: function () {\n        var self = this;\n        if (self.options.ajaxUrl) {\n            self.createModal = self.createAjaxModal;\n        } else if (self.options.target) {\n            self.createModal = self.createTargetModal;\n        } else if (self.options.html) {\n            self.createModal = self.createHtmlModal;\n        } else if (self.options.image) {\n            self.createModal = self.createImageModal;\n        } else {\n            self.createModal = self.createBasicModal;\n        }\n    },\n\n    findPosition: function (\n        horpos,\n        vertpos,\n        margin,\n        modalWidth,\n        modalHeight,\n        wrapperInnerWidth,\n        wrapperInnerHeight\n    ) {\n        var returnpos = {};\n        var absTop, absBottom, absLeft, absRight;\n        absRight = absLeft = absTop = absLeft = \"auto\";\n\n        // -- HORIZONTAL POSITION -----------------------------------------------\n        if (horpos === \"left\") {\n            absLeft = margin + \"px\";\n            // if the width of the wrapper is smaller than the modal, and thus the\n            // screen is smaller than the modal, force the left to simply be 0\n            if (modalWidth > wrapperInnerWidth) {\n                absLeft = \"0px\";\n            }\n            returnpos.left = absLeft;\n        } else if (horpos === \"right\") {\n            absRight = margin + \"px\";\n            // if the width of the wrapper is smaller than the modal, and thus the\n            // screen is smaller than the modal, force the right to simply be 0\n            if (modalWidth > wrapperInnerWidth) {\n                absRight = \"0px\";\n            }\n            returnpos.right = absRight;\n            returnpos.left = \"auto\";\n        }\n        // default, no specified location, is to center\n        else {\n            absLeft = wrapperInnerWidth / 2 - modalWidth / 2 - margin + \"px\";\n            // if the width of the wrapper is smaller than the modal, and thus the\n            // screen is smaller than the modal, force the left to simply be 0\n            if (modalWidth > wrapperInnerWidth) {\n                absLeft = \"0px\";\n            }\n            returnpos.left = absLeft;\n        }\n\n        // -- VERTICAL POSITION -------------------------------------------------\n        if (vertpos === \"top\") {\n            absTop = margin + \"px\";\n            // if the height of the wrapper is smaller than the modal, and thus the\n            // screen is smaller than the modal, force the top to simply be 0\n            if (modalHeight > wrapperInnerHeight) {\n                absTop = \"0px\";\n            }\n            returnpos.top = absTop;\n        } else if (vertpos === \"bottom\") {\n            absBottom = margin + \"px\";\n            // if the height of the wrapper is smaller than the modal, and thus the\n            // screen is smaller than the modal, force the bottom to simply be 0\n            if (modalHeight > wrapperInnerHeight) {\n                absBottom = \"0px\";\n            }\n            returnpos.bottom = absBottom;\n            returnpos.top = \"auto\";\n        } else {\n            // default case, no specified location, is to center\n            absTop = wrapperInnerHeight / 2 - modalHeight / 2 - margin + \"px\";\n            // if the height of the wrapper is smaller than the modal, and thus the\n            // screen is smaller than the modal, force the top to simply be 0\n            if (modalHeight > wrapperInnerHeight) {\n                absTop = \"0px\";\n            }\n            returnpos.top = absTop;\n        }\n        return returnpos;\n    },\n\n    modalInitialized: function () {\n        var self = this;\n        return self.$modal !== null && self.$modal !== undefined;\n    },\n\n    activateFocusTrap: function () {\n        var self = this;\n        const modal_el = self.$modal[0];\n        var inputsBody = modal_el\n            .querySelector(`.${self.options.templateOptions.classBodyName}`)\n            .querySelectorAll(`select, input:not([type=\"hidden\"]), textarea, button, a`);\n        var inputsFooter = modal_el\n            .querySelector(`.${self.options.templateOptions.classFooterName}`)\n            .querySelectorAll(`select, input:not([type=\"hidden\"]), textarea, button, a`);\n        var inputs = [];\n\n        for (const el of [...inputsBody, ...inputsFooter]) {\n            if (dom.is_visible(el)) {\n                inputs.push(el);\n            }\n        }\n\n        if (inputs.length === 0) {\n            inputs = modal_el.querySelectorAll(\".modal-title\");\n        }\n        var firstInput = inputs.length !== 0 ? inputs[0] : null;\n        var lastInput = inputs.length !== 0 ? inputs[inputs.length - 1] : null;\n        var closeInput = modal_el.querySelector(\".modal-close\");\n\n        modal_el.addEventListener(\n            \"keydown\",\n            (e) => {\n                if (e.key === \"Tab\") {\n                    e.preventDefault();\n\n                    var target = e.target;\n                    var currentIndex = inputs.indexOf(target);\n                    if (currentIndex >= 0 && currentIndex < inputs.length) {\n                        var nextIndex = currentIndex + (e.shiftKey ? -1 : 1);\n                        if (nextIndex < 0 || nextIndex >= inputs.length) {\n                            closeInput.focus();\n                        } else {\n                            inputs[nextIndex].focus();\n                        }\n                    } else if (e.shiftKey && lastInput) {\n                        lastInput.focus();\n                    } else if (firstInput) {\n                        firstInput.focus();\n                    }\n                }\n            }\n        );\n        if (self.options.backdropOptions.closeOnClick === true) {\n            modal_el.addEventListener(\"click\", (e) => {\n                if (!e.target.closest(`.${self.options.templateOptions.classModal}`)) {\n                    self.hide();\n                }\n            });\n        }\n\n        if (firstInput && [\"INPUT\", \"SELECT\", \"TEXTAREA\"].includes(firstInput.nodeName)) {\n            // autofocus first element when opening a modal with a form\n            firstInput.focus();\n        }\n    },\n\n    positionModal: function () {\n        /* re-position modal at any point.\n         *\n         * Uses:\n         *  options.margin\n         *  options.width\n         *  options.height\n         *  options.position\n         */\n        var self = this;\n        // modal isn't initialized\n        if (!self.modalInitialized()) {\n            return;\n        }\n        // clear out any previously set styling\n        self.$modal.removeAttr(\"style\");\n\n        // if backdrop wrapper is set on body, then wrapper should have height of\n        // the window, so we can do scrolling of inner wrapper\n        if (self.$wrapper.parent().is(\"body\")) {\n            self.$wrapper.height($(window.parent).height());\n        }\n\n        var margin =\n            typeof self.options.margin === \"function\"\n                ? self.options.margin()\n                : self.options.margin;\n        let modalCss = {\n            position: \"absolute\",\n        };\n        if (margin !== \"0\") {\n            modalCss[\"padding\"] = margin;\n        }\n        self.$modal.css(modalCss);\n        self.$modalDialog.css({\n            // margin: \"0\",\n            // padding: \"0\",\n            width: self.options.width, // defaults to \"\", which doesn't override other css\n            height: self.options.height, // defaults to \"\", which doesn't override other css\n        });\n        self.$modalContent.css({\n            width: self.options.width, // defaults to \"\", which doesn't override other css\n        });\n\n        var posopt = self.options.position.split(\" \"),\n            horpos = posopt[0],\n            vertpos = posopt[1];\n        var modalWidth = self.$modalDialog.outerWidth(true);\n        var modalHeight = self.$modalDialog.outerHeight(true);\n        var wrapperInnerWidth = self.$wrapperInner.width();\n        var wrapperInnerHeight = self.$wrapperInner.height();\n        var pos = self.findPosition(\n            horpos,\n            vertpos,\n            margin,\n            modalWidth,\n            modalHeight,\n            wrapperInnerWidth,\n            wrapperInnerHeight\n        );\n        for (var key in pos) {\n            self.$modalDialog.css(key, pos[key]);\n        }\n    },\n\n    render: function (options) {\n        var self = this;\n        self.emit(\"render\");\n        self.options.render.apply(self, [options]);\n        self.emit(\"rendered\");\n    },\n\n    show: function () {\n        var self = this;\n        self.backdrop = self.createBackdrop();\n        self.createModal();\n    },\n\n    createBackdrop: function () {\n        var self = this,\n            backdrop = new Backdrop(\n                self.$el.parents(self.options.backdrop),\n                self.options.backdropOptions\n            ),\n            zIndex = self.options.backdropOptions.zIndex || 1041;\n\n        $(self.options.zIndexSelector).each(function () {\n            zIndex = Math.max(zIndex, parseInt($(this).css(\"zIndex\")) + 1 || 1041);\n        });\n\n        self.$wrapper = $(\"<div/>\")\n            .hide()\n            .css({\n                \"z-index\": zIndex,\n                \"overflow-y\": \"auto\",\n                \"position\": \"fixed\",\n                \"height\": \"100%\",\n                \"width\": \"100%\",\n                \"bottom\": \"0\",\n                \"left\": \"0\",\n                \"right\": \"0\",\n                \"top\": \"0\",\n            })\n            .addClass(self.options.templateOptions.classWrapperName)\n            .insertBefore(backdrop.$backdrop)\n            .on(\"click\", function (e) {\n                if (self.options.backdropOptions.closeOnClick) {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    backdrop.hide();\n                }\n            });\n        backdrop.on(\"hidden\", function () {\n            if (\n                self.$modal !== undefined &&\n                self.$modal.hasClass(self.options.templateOptions.classActiveName)\n            ) {\n                self.hide();\n            }\n        });\n        self.loading = new utils.Loading({\n            backdrop: backdrop,\n        });\n        self.$wrapperInner = $(\"<div/>\")\n            .addClass(self.options.classWrapperInnerName)\n            .css({\n                position: \"absolute\",\n                bottom: \"0\",\n                left: \"0\",\n                right: \"0\",\n                top: \"0\",\n            })\n            .appendTo(self.$wrapper);\n        return backdrop;\n    },\n\n    _show: function () {\n        var self = this;\n        self.render.apply(self, [self.options]);\n        self.emit(\"show\");\n        self.backdrop.show();\n        self.$wrapper.show();\n        self.loading.hide();\n        self.$el.addClass(self.options.templateOptions.classActiveName);\n        self.$modal.addClass(self.options.templateOptions.classActiveName);\n        registry.scan(self.$modal);\n        self.positionModal();\n        $(window.parent).on(\"resize.plone-modal.patterns\", function () {\n            self.positionModal();\n        });\n        $(\"body\").addClass(\"modal-open\");\n        self.emit(\"shown\");\n        self.activateFocusTrap();\n    },\n    hide: function () {\n        var self = this;\n        if (self.ajaxXHR) {\n            self.ajaxXHR.abort();\n        }\n        self.emit(\"hide\");\n        if (self._suppressHide) {\n            if (!window.confirm(self._suppressHide)) {\n                return;\n            }\n        }\n        self.loading.hide();\n        self.$el.removeClass(self.options.templateOptions.classActiveName);\n        if (self.$modal !== undefined) {\n            self.$modal.remove();\n            self.initModal();\n        }\n        self.$wrapper.remove();\n        if ($(\".modal\", $(\"body\")).length < 1) {\n            self._suppressHide = undefined;\n            self.backdrop.hide();\n            $(\"body\").removeClass(\"modal-open\");\n            $(window.parent).off(\"resize.plone-modal.patterns\");\n        }\n        self.emit(\"hidden\");\n        self.$el.focus();\n    },\n\n    redraw: function (response, options) {\n        var self = this;\n        self.emit(\"beforeDraw\");\n        self.$modal.remove();\n        self.$raw = $(\"<div />\").append($(utils.parseBodyTag(response)));\n        self.render.apply(self, [options || self.options]);\n        self.$modal.addClass(self.options.templateOptions.classActiveName);\n        self.positionModal();\n        registry.scan(self.$modal);\n        self.emit(\"afterDraw\");\n        self.activateFocusTrap();\n    },\n});\n","import Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"discussion-moderation\",\n    trigger: \"#fieldset-moderate-comments\",\n\n    async init() {\n        // Async import implementation to reduce bundle size for controlpanels\n        const implementation = (await import(\"./discussion-moderation--implementation\"))\n            .default;\n        const instance = new implementation(this.el);\n        instance.init();\n    },\n});\n","import Base from \"@patternslib/patternslib/src/core/base\";\n\nfunction loadScript(src) {\n    var s,\n        i,\n        head,\n        scripts = document.getElementsByTagName(\"script\");\n\n    // Check script element doesn't already exist\n    for (i = 0; i < scripts.length; i++) {\n        if (scripts[i].src.indexOf(src) !== -1) {\n            return;\n        }\n    }\n\n    // If not, add it to page\n    s = document.createElement(\"script\");\n    s.type = \"text/javascript\";\n    s.async = true;\n    s.src = src;\n    // use head tag to find a place to insert the script node\n    head = document.getElementsByTagName(\"head\")[0];\n    head.insertBefore(s, head.firstChild);\n}\nfunction htmlToElement(html) {\n    var htmltmp = document.createElement(\"div\");\n    html = html.trim(); // Never return a text node of whitespace as the result\n    htmltmp.innerHTML = html;\n    return htmltmp.firstElementChild;\n}\n\nexport default Base.extend({\n    name: \"passwordstrength\",\n    trigger: \".pat-passwordstrength\",\n    parser: \"mockup\",\n    defaults: {\n        zxcvbn: \"//cdnjs.cloudflare.com/ajax/libs/zxcvbn/4.4.2/zxcvbn.js\",\n    },\n    init: function () {\n        var self = this,\n            pwfield = this.el,\n            pwmeterContainer = htmlToElement(\n                '<div class=\"progress my-3\"><div class=\"progress-bar\" role=\"progressbar\" aria-valuemin=\"0\" aria-valuemax=\"100\" aria-valuenow=\"0\"></div></div>'\n            ),\n            pwmeter = pwmeterContainer.firstChild,\n            indicators = {\n                0: \"bg-transparent\",\n                1: \"bg-danger\",\n                2: \"bg-warning\",\n                3: \"bg-warning\",\n                4: \"bg-success\",\n            };\n        function setLevel() {\n            var score = 0;\n\n            if (pwfield.value.length > 0) {\n                // Run zxcvbn, supplying the value of any other widgets in the form\n                score = Math.max(\n                    1,\n                    window.zxcvbn(\n                        pwfield.value,\n                        [].map\n                            .call(\n                                (pwfield.form || { elements: [] }).elements,\n                                function (inp) {\n                                    if (inp === pwfield) {\n                                        return null;\n                                    }\n                                    return inp.value || null;\n                                }\n                            )\n                            .filter(function (x) {\n                                return x;\n                            })\n                    ).score\n                );\n            }\n            var wclass = \"\";\n            if (score != 0) {\n                wclass = \" w-\" + 25 * score;\n            }\n            pwmeter.className = \"progress-bar\" + wclass + \" \" + indicators[score];\n            pwmeter.setAttribute(\"aria-valuenow\", 25 * score);\n        }\n\n        pwfield.parentNode.insertBefore(pwmeterContainer, pwfield.nextSibling);\n        // set up key strokes to change the meter\n        pwfield.onkeyup = function () {\n            setLevel();\n        };\n        // init zxcvbn\n        if (typeof window.zxcvbn !== \"function\") {\n            // No zxcvbn yet, try and load it\n            loadScript(self.options.zxcvbn);\n        }\n        // initial pwmeter setting\n        setLevel();\n    },\n});\n","/**\n * @license\n * Patterns @VERSION@ jquery-ext - various jQuery extensions\n *\n * Copyright 2011 Humberto Sermeño\n */\n\nimport $ from \"jquery\";\n\nvar methods = {\n    init: function (options) {\n        var settings = {\n            time: 3 /* time it will wait before moving to \"timeout\" after a move event */,\n            initialTime: 8 /* time it will wait before first adding the \"timeout\" class */,\n            exceptionAreas: [] /* IDs of elements that, if the mouse is over them, will reset the timer */,\n        };\n        return this.each(function () {\n            var $this = $(this),\n                data = $this.data(\"timeout\");\n\n            if (!data) {\n                if (options) {\n                    $.extend(settings, options);\n                }\n                $this.data(\"timeout\", {\n                    lastEvent: new Date(),\n                    trueTime: settings.time,\n                    time: settings.initialTime,\n                    untouched: true,\n                    inExceptionArea: false,\n                });\n\n                $this.on(\"mouseover.timeout\", methods.mouseMoved);\n                $this.on(\"mouseenter.timeout\", methods.mouseMoved);\n\n                $(settings.exceptionAreas).each(function () {\n                    $this\n                        .find(this)\n                        .live(\n                            \"mouseover.timeout\",\n                            { parent: $this },\n                            methods.enteredException\n                        )\n                        .live(\n                            \"mouseleave.timeout\",\n                            { parent: $this },\n                            methods.leftException\n                        );\n                });\n\n                if (settings.initialTime > 0) $this.timeout(\"startTimer\");\n                else $this.addClass(\"timeout\");\n            }\n        });\n    },\n\n    enteredException: function (event) {\n        var data = event.data.parent.data(\"timeout\");\n        data.inExceptionArea = true;\n        event.data.parent.data(\"timeout\", data);\n        event.data.parent.trigger(\"mouseover\");\n    },\n\n    leftException: function (event) {\n        var data = event.data.parent.data(\"timeout\");\n        data.inExceptionArea = false;\n        event.data.parent.data(\"timeout\", data);\n    },\n\n    destroy: function () {\n        return this.each(function () {\n            var $this = $(this),\n                data = $this.data(\"timeout\");\n\n            $(window).off(\".timeout\");\n            data.timeout.remove();\n            $this.removeData(\"timeout\");\n        });\n    },\n\n    mouseMoved: function () {\n        var $this = $(this),\n            data = $this.data(\"timeout\");\n\n        if ($this.hasClass(\"timeout\")) {\n            $this.removeClass(\"timeout\");\n            $this.timeout(\"startTimer\");\n        } else if (data.untouched) {\n            data.untouched = false;\n            data.time = data.trueTime;\n        }\n\n        data.lastEvent = new Date();\n        $this.data(\"timeout\", data);\n    },\n\n    startTimer: function () {\n        var $this = $(this),\n            data = $this.data(\"timeout\");\n        var fn = function () {\n            var data = $this.data(\"timeout\");\n            if (data && data.lastEvent) {\n                if (data.inExceptionArea) {\n                    setTimeout(fn, Math.floor(data.time * 1000));\n                } else {\n                    var now = new Date();\n                    var diff = Math.floor(data.time * 1000) - (now - data.lastEvent);\n                    if (diff > 0) {\n                        // the timeout has not ocurred, so set the timeout again\n                        setTimeout(fn, diff + 100);\n                    } else {\n                        // timeout ocurred, so set the class\n                        $this.addClass(\"timeout\");\n                    }\n                }\n            }\n        };\n\n        setTimeout(fn, Math.floor(data.time * 1000));\n    },\n};\n\n$.fn.timeout = function (method) {\n    if (methods[method]) {\n        return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));\n    } else if (typeof method === \"object\" || !method) {\n        return methods.init.apply(this, arguments);\n    } else {\n        $.error(\"Method \" + method + \" does not exist on jQuery.timeout\");\n    }\n};\n\n// Custom jQuery selector to find elements with scrollbars\n$.extend($.expr[\":\"], {\n    scrollable: function (element) {\n        var vertically_scrollable, horizontally_scrollable;\n        if (\n            $(element).css(\"overflow\") === \"scroll\" ||\n            $(element).css(\"overflowX\") === \"scroll\" ||\n            $(element).css(\"overflowY\") === \"scroll\"\n        )\n            return true;\n\n        vertically_scrollable =\n            element.clientHeight < element.scrollHeight &&\n            ($.inArray($(element).css(\"overflowY\"), [\"scroll\", \"auto\"]) !== -1 ||\n                $.inArray($(element).css(\"overflow\"), [\"scroll\", \"auto\"]) !== -1);\n\n        if (vertically_scrollable) return true;\n\n        horizontally_scrollable =\n            element.clientWidth < element.scrollWidth &&\n            ($.inArray($(element).css(\"overflowX\"), [\"scroll\", \"auto\"]) !== -1 ||\n                $.inArray($(element).css(\"overflow\"), [\"scroll\", \"auto\"]) !== -1);\n        return horizontally_scrollable;\n    },\n});\n\n// Make Visible in scroll\n$.fn.makeVisibleInScroll = function (parent_id) {\n    var absoluteParent = null;\n    if (typeof parent_id === \"string\") {\n        absoluteParent = $(\"#\" + parent_id);\n    } else if (parent_id) {\n        absoluteParent = $(parent_id);\n    }\n\n    return this.each(function () {\n        var $this = $(this),\n            parent;\n        if (!absoluteParent) {\n            parent = $this.parents(\":scrollable\");\n            if (parent.length > 0) {\n                parent = $(parent[0]);\n            } else {\n                parent = $(window);\n            }\n        } else {\n            parent = absoluteParent;\n        }\n\n        var elemTop = $this.position().top;\n        var elemBottom = $this.height() + elemTop;\n\n        var viewTop = parent.scrollTop();\n        var viewBottom = parent.height() + viewTop;\n\n        if (elemTop < viewTop) {\n            parent.scrollTop(elemTop);\n        } else if (elemBottom > viewBottom - parent.height() / 2) {\n            parent.scrollTop(elemTop - (parent.height() - $this.height()) / 2);\n        }\n    });\n};\n\n//Work around warning for jQuery 3.x:\n//JQMIGRATE: jQuery.fn.offset() requires an element connected to a document\n$.fn.safeOffset = function () {\n    var docElem,\n        elem = this[0],\n        origin = { top: 0, left: 0 };\n\n    if (!elem || !elem.nodeType) {\n        return origin;\n    }\n\n    docElem = (elem.ownerDocument || document).documentElement;\n    if (!$.contains(docElem, elem)) {\n        return origin;\n    }\n\n    return $.fn.offset.apply(this, arguments);\n};\n\n//Make absolute location\n$.fn.setPositionAbsolute = function (element, offsettop, offsetleft) {\n    return this.each(function () {\n        // set absolute location for based on the element passed\n        // dynamically since every browser has different settings\n        var $this = $(this);\n        var thiswidth = $(this).width();\n        var pos = element.safeOffset();\n        var width = element.width();\n        var height = element.height();\n        var setleft = pos.left + width - thiswidth + offsetleft;\n        var settop = pos.top + height + offsettop;\n        $this.css({\n            \"z-index\": 1,\n            \"position\": \"absolute\",\n            \"marginLeft\": 0,\n            \"marginTop\": 0,\n            \"left\": setleft + \"px\",\n            \"top\": settop + \"px\",\n            \"width\": thiswidth,\n        });\n        $this.remove().appendTo(\"body\").show();\n    });\n};\n\n$.fn.positionAncestor = function (selector) {\n    var left = 0;\n    var top = 0;\n    this.each(function () {\n        // check if current element has an ancestor matching a selector\n        // and that ancestor is positioned\n        var $ancestor = $(this).closest(selector);\n        if ($ancestor.length && $ancestor.css(\"position\") !== \"static\") {\n            var $child = $(this);\n            var childMarginEdgeLeft =\n                $child.safeOffset().left - parseInt($child.css(\"marginLeft\"), 10);\n            var childMarginEdgeTop =\n                $child.safeOffset().top - parseInt($child.css(\"marginTop\"), 10);\n            var ancestorPaddingEdgeLeft =\n                $ancestor.safeOffset().left +\n                parseInt($ancestor.css(\"borderLeftWidth\"), 10);\n            var ancestorPaddingEdgeTop =\n                $ancestor.safeOffset().top +\n                parseInt($ancestor.css(\"borderTopWidth\"), 10);\n            left = childMarginEdgeLeft - ancestorPaddingEdgeLeft;\n            top = childMarginEdgeTop - ancestorPaddingEdgeTop;\n            // we have found the ancestor and computed the position\n            // stop iterating\n            return false;\n        }\n    });\n    return {\n        left: left,\n        top: top,\n    };\n};\n\n$.fn.findInclusive = function (selector) {\n    return this.find(\"*\").addBack().filter(selector);\n};\n\n$.fn.slideIn = function (speed, easing, callback) {\n    return this.animate({ width: \"show\" }, speed, easing, callback);\n};\n\n$.fn.slideOut = function (speed, easing, callback) {\n    return this.animate({ width: \"hide\" }, speed, easing, callback);\n};\n\n// case-insensitive :contains\n$.expr[\":\"].Contains = function (a, i, m) {\n    return $(a).text().toUpperCase().indexOf(m[3].toUpperCase()) >= 0;\n};\n\n$.fn.scopedFind = function (selector) {\n    /*  If the selector starts with an object id do a global search,\n     *  otherwise do a local search.\n     */\n    if (selector.indexOf(\"#\") === 0) {\n        return $(selector);\n    } else {\n        return this.find(selector);\n    }\n};\n\nexport default undefined;\n","import Base from \"../../core/base\";\nimport Parser from \"../../core/parser\";\nimport dom from \"../../core/dom\";\nimport events from \"../../core/events\";\nimport utils from \"../../core/utils\";\nimport \"../../core/jquery-ext\";\n\nexport const parser = new Parser(\"checklist\");\nparser.addArgument(\"select\", \".select-all\");\nparser.addArgument(\"deselect\", \".deselect-all\");\nparser.addArgument(\"toggle\", \".toggle-all\");\n\nexport default Base.extend({\n    name: \"checklist\",\n    trigger: \".pat-checklist\",\n    jquery_plugin: true,\n    all_selects: [],\n    all_deselects: [],\n    all_toggles: [],\n    all_checkboxes: [],\n    all_radios: [],\n\n    init() {\n        this.options = parser.parse(this.el, this.options, false);\n        this.$el.on(\"patterns-injected\", this._init.bind(this));\n\n        this.change_handler = utils.debounce(() => {\n            this.change_buttons_and_toggles();\n            this.change_checked();\n        }, 50);\n\n        this._init();\n    },\n\n    _init() {\n        this.all_checkboxes = this.el.querySelectorAll(`input[type=checkbox]`);\n        this.all_radios = this.el.querySelectorAll(\"input[type=radio]\");\n\n        this.all_selects = dom.find_scoped(this.el, this.options.select);\n        for (const btn of this.all_selects) {\n            events.add_event_listener(\n                btn,\n                \"click\",\n                \"pat-checklist--select-all--click\",\n                this.select_all.bind(this)\n            );\n        }\n\n        this.all_deselects = dom.find_scoped(this.el, this.options.deselect);\n        for (const btn of this.all_deselects) {\n            events.add_event_listener(\n                btn,\n                \"click\",\n                \"pat-checklist--deselect-all--click\",\n                this.deselect_all.bind(this)\n            );\n        }\n\n        this.all_toggles = dom.find_scoped(this.el, this.options.toggle);\n        for (const btn of this.all_toggles) {\n            events.add_event_listener(\n                btn,\n                \"click\",\n                \"pat-checklist--toggle-all--click\",\n                this.toggle_all.bind(this)\n            );\n        }\n\n        // update select/deselect button status\n        this.change_buttons_and_toggles();\n        this.change_checked();\n        events.add_event_listener(\n            this.el,\n            \"change\",\n            \"pat-checklist--change-handler--change\",\n            this.change_handler.bind(this)\n        );\n    },\n\n    destroy() {\n        for (const it of this.all_selects) {\n            events.remove_event_listener(it, \"pat-checklist--select-all--click\");\n        }\n        for (const it of this.all_deselects) {\n            events.remove_event_listener(it, \"pat-checklist--deselect-all--click\");\n        }\n        for (const it of this.all_toggles) {\n            events.remove_event_listener(it, \"pat-checklist--toggle-all--click\");\n        }\n        events.remove_event_listener(this.el, \"pat-checklist--change-handler--change\");\n        this.$el.off(\"patterns_injected\");\n    },\n\n    find_siblings(el, sel) {\n        // Looks for the closest elements within the `el` tree that match the\n        // `sel` selector\n        let res;\n        let parent = el.parentNode;\n        while (parent) {\n            res = parent.querySelectorAll(`${sel}:not(${this.options.toggle})`);\n            if (res.length || parent === this.el) {\n                // return if results were found or we reached the pattern top\n                return res;\n            }\n            parent = parent.parentNode;\n        }\n    },\n\n    find_checkboxes(ref_el, sel) {\n        let chkbxs = [];\n        if (this.options.select.indexOf(\"#\") === 0) {\n            chkbxs = this.el.querySelectorAll(sel);\n        } else {\n            chkbxs = this.find_siblings(ref_el, sel);\n        }\n        return chkbxs;\n    },\n\n    change_buttons_and_toggles() {\n        let chkbxs;\n        for (const btn of this.all_selects) {\n            chkbxs = this.find_checkboxes(btn, \"input[type=checkbox]\");\n            btn.disabled = [...chkbxs]\n                .map((el) => el.matches(\":checked\"))\n                .every((it) => it === true);\n        }\n        for (const btn of this.all_deselects) {\n            chkbxs = this.find_checkboxes(btn, \"input[type=checkbox]\");\n            btn.disabled = [...chkbxs]\n                .map((el) => el.matches(\":checked\"))\n                .every((it) => it === false);\n        }\n        for (const tgl of this.all_toggles) {\n            chkbxs = this.find_checkboxes(tgl, \"input[type=checkbox]\");\n            tgl.checked = [...chkbxs]\n                .map((el) => el.matches(\":checked\"))\n                .every((it) => it === true);\n        }\n    },\n\n    select_all(e) {\n        e.preventDefault();\n        const chkbxs = this.find_checkboxes(\n            e.target,\n            \"input[type=checkbox]:not(:checked)\"\n        );\n        for (const box of chkbxs) {\n            box.checked = true;\n            box.dispatchEvent(events.change_event());\n            box.dispatchEvent(events.input_event());\n        }\n    },\n\n    deselect_all(e) {\n        e.preventDefault();\n        const chkbxs = this.find_checkboxes(e.target, \"input[type=checkbox]:checked\");\n        for (const box of chkbxs) {\n            box.checked = false;\n            box.dispatchEvent(events.change_event());\n            box.dispatchEvent(events.input_event());\n        }\n    },\n\n    toggle_all(e) {\n        e.preventDefault();\n        const checked = e.target.checked;\n        const chkbxs = this.find_checkboxes(e.target, \"input[type=checkbox]\");\n        for (const box of chkbxs) {\n            box.checked = checked;\n            box.dispatchEvent(events.change_event());\n            box.dispatchEvent(events.input_event());\n        }\n    },\n\n    change_checked() {\n        for (const it of [...this.all_checkboxes, ...this.all_radios]) {\n            for (const label of it.labels) {\n                label.classList.remove(\"checked\", \"unchecked\");\n                label.classList.add(it.checked ? \"checked\" : \"unchecked\");\n            }\n        }\n\n        for (const fieldset of dom.querySelectorAllAndMe(this.el, \"fieldset\")) {\n            if (\n                fieldset.querySelectorAll(\n                    `input[type=checkbox]:checked:not(${this.options.toggle}), input[type=radio]:checked`\n                ).length\n            ) {\n                fieldset.classList.remove(\"unchecked\");\n                fieldset.classList.add(\"checked\");\n            } else {\n                fieldset.classList.remove(\"checked\");\n                fieldset.classList.add(\"unchecked\");\n            }\n        }\n    },\n});\n","/**\n * Patterns registry - Central registry and scan logic for patterns\n *\n * Copyright 2012-2013 Simplon B.V.\n * Copyright 2012-2013 Florian Friesdorf\n * Copyright 2013 Marko Durkovic\n * Copyright 2013 Rok Garbas\n * Copyright 2014-2015 Syslab.com GmBH, JC Brand\n */\n\n/*\n * changes to previous patterns.register/scan mechanism\n * - if you want initialised class, do it in init\n * - init returns set of elements actually initialised\n * - handle once within init\n * - no turnstile anymore\n * - set pattern.jquery_plugin if you want it\n */\nimport $ from \"jquery\";\nimport dom from \"./dom\";\nimport logging from \"./logging\";\nimport utils from \"./utils\";\n\nconst log = logging.getLogger(\"registry\");\nconst disable_re = /patterns-disable=([^&]+)/g;\nconst dont_catch_re = /patterns-dont-catch/g;\nconst disabled = {};\nlet dont_catch = false;\nlet match;\n\nwhile ((match = disable_re.exec(window.location.search)) !== null) {\n    disabled[match[1]] = true;\n    log.info(\"Pattern disabled via url config:\", match[1]);\n}\n\nwhile ((match = dont_catch_re.exec(window.location.search)) !== null) {\n    dont_catch = true;\n    log.info(\"I will not catch init exceptions\");\n}\n\n/**\n * Global pattern registry.\n *\n * This is a singleton and shared among any instance of the Patternslib\n * registry since Patternslib version 8.\n *\n * You normally don't need this as the registry handles it for you.\n */\nif (typeof window.__patternslib_registry === \"undefined\") {\n    window.__patternslib_registry = {};\n}\nexport const PATTERN_REGISTRY = window.__patternslib_registry;\nif (typeof window.__patternslib_registry_initialized === \"undefined\") {\n    window.__patternslib_registry_initialized = false;\n}\n\nconst registry = {\n    patterns: PATTERN_REGISTRY, // reference to global patterns registry\n    // as long as the registry is not initialized, pattern\n    // registration just registers a pattern. Once init is called,\n    // the DOM is scanned. After that registering a new pattern\n    // results in rescanning the DOM only for this pattern.\n    init() {\n        dom.document_ready(() => {\n            if (window.__patternslib_registry_initialized) {\n                // Do not reinitialize a already initialized registry.\n                return;\n            }\n            window.__patternslib_registry_initialized = true;\n            log.debug(\"Loaded: \" + Object.keys(registry.patterns).sort().join(\", \"));\n            registry.scan(document.body);\n            log.debug(\"Finished initial scan.\");\n        });\n    },\n\n    clear() {\n        // Removes all patterns from the registry. Currently only being\n        // used in tests.\n        for (const name in registry.patterns) {\n            delete registry.patterns[name];\n        }\n    },\n\n    transformPattern(name, content) {\n        /* Call the transform method on the pattern with the given name, if\n         * it exists.\n         */\n        if (disabled[name]) {\n            log.debug(`Skipping disabled pattern: ${name}.`);\n            return;\n        }\n\n        const pattern = registry.patterns[name];\n        const transform = pattern.transform || pattern.prototype?.transform;\n        if (transform) {\n            try {\n                transform($(content));\n            } catch (e) {\n                if (dont_catch) {\n                    throw e;\n                }\n                log.error(`Transform error for pattern ${name}.`, e);\n            }\n        }\n    },\n\n    initPattern(name, el, trigger) {\n        /* Initialize the pattern with the provided name and in the context\n         * of the passed in DOM element.\n         */\n        const $el = $(el);\n        const pattern = registry.patterns[name];\n        const plog = logging.getLogger(`pat.${name}`);\n        if (el.matches(pattern.trigger)) {\n            plog.debug(\"Initialising.\", el);\n            try {\n                if (pattern.init) {\n                    // old style initialisation\n                    pattern.init($el, null, trigger);\n                } else {\n                    // class based pattern initialisation\n                    new pattern($el, null, trigger);\n                }\n\n                plog.debug(\"done.\");\n            } catch (e) {\n                if (dont_catch) {\n                    throw e;\n                }\n                plog.error(\"Caught error:\", e);\n            }\n        }\n    },\n\n    orderPatterns(patterns) {\n        // Always add pat-validation as first pattern, so that it can prevent\n        // other patterns from reacting to submit events if form validation\n        // fails.\n        if (patterns.includes(\"validation\")) {\n            patterns.splice(patterns.indexOf(\"validation\"), 1);\n            patterns.unshift(\"validation\");\n        }\n        // Add clone-code to the very beginning - we want to copy the markup\n        // before any other patterns changed the markup.\n        if (patterns.includes(\"clone-code\")) {\n            patterns.splice(patterns.indexOf(\"clone-code\"), 1);\n            patterns.unshift(\"clone-code\");\n        }\n\n        return patterns;\n    },\n\n    scan(content, patterns, trigger) {\n        if (!content) {\n            return;\n        }\n\n        if (typeof content === \"string\") {\n            content = document.querySelector(content);\n        } else if (content instanceof Text) {\n            // No need to scan a TextNode.\n            return;\n        } else if (content.jquery) {\n            content = content[0];\n        }\n\n        const selectors = [];\n        patterns = this.orderPatterns(patterns || Object.keys(registry.patterns));\n        for (const name of patterns) {\n            this.transformPattern(name, content);\n            const pattern = registry.patterns[name];\n            if (pattern.trigger) {\n                selectors.unshift(pattern.trigger);\n            }\n        }\n\n        // Clean up selectors:\n        // - Remove whitespace,\n        // - Remove trailing commas,\n        // - Join to selecto string.\n        const selector_string = selectors.map(\n            (selector) => selector.trim().replace(/,$/, \"\")\n        ).join(\",\");\n\n        // Exit, if no selector.\n        if (!selector_string) {\n            return;\n        }\n\n        let matches = dom.querySelectorAllAndMe(\n            content,\n            selector_string\n        );\n        matches = matches.filter((el) => {\n            // Filter out patterns:\n            // - with class ``.disable-patterns`` or wrapped within.\n            // - wrapped in ``<pre>`` elements\n            // - wrapped in ``<template>`` elements (not reachable anyways)\n            return (\n                !el?.closest?.(\".disable-patterns\") &&\n                !el?.parentNode?.closest?.(\"pre\") &&\n                // BBB. TODO: Remove with next major version.\n                !el?.closest?.(\".cant-touch-this\")\n            );\n        });\n\n        // walk list backwards and initialize patterns inside-out.\n        for (const el of matches.reverse()) {\n            for (const name of patterns) {\n                this.initPattern(name, el, trigger);\n            }\n        }\n        document.body.classList.add(\"patterns-loaded\");\n    },\n\n    register(pattern, name) {\n        name = name || pattern.name;\n        if (!name) {\n            log.error(\"Pattern lacks a name.\", pattern);\n            return false;\n        }\n\n        // Do not register blacklisted patterns.\n        let BLACKLIST = window.__patternslib_patterns_blacklist;\n        if (!Array.isArray(BLACKLIST)) {\n            BLACKLIST = [];\n        }\n        if (BLACKLIST.includes(name)) {\n            log.warn(`Pattern name ${name} is blacklisted.`);\n            return false;\n        }\n\n        if (registry.patterns[name]) {\n            log.debug(`Already have a pattern called ${name}.`);\n            return false;\n        }\n        // register pattern to be used for scanning new content\n        registry.patterns[name] = pattern;\n\n        // register pattern as jquery plugin\n        if (pattern.jquery_plugin) {\n            const plugin_name = (\"pat-\" + name).replace(\n                /-([a-zA-Z])/g,\n                function (match, p1) {\n                    return p1.toUpperCase();\n                }\n            );\n            $.fn[plugin_name] = utils.jqueryPlugin(pattern);\n            // BBB 2012-12-10 and also for Mockup patterns.\n            $.fn[plugin_name.replace(/^pat/, \"pattern\")] = $.fn[plugin_name];\n        }\n        log.debug(`Registered pattern ${name}`, pattern);\n        if (window.__patternslib_registry_initialized) {\n            // Once the first initialization has been done, do only scan for\n            // newly registered patterns.\n            registry.scan(document.body, [name]);\n            log.debug(`Re-scanned dom with newly registered pattern ${name}.`);\n        }\n        return true;\n    },\n};\n\nexport default registry;\n","import Base from \"@patternslib/patternslib/src/core/base\";\nimport dom from \"@patternslib/patternslib/src/core/dom\";\nimport utils from \"../../core/utils\";\n\nexport default Base.extend({\n    name: \"markspeciallinks\",\n    trigger: \".pat-markspeciallinks\",\n    parser: \"mockup\",\n\n    defaults: {\n        external_links_open_new_window: false,\n        mark_special_links: true,\n    },\n\n    protocol_icon_map: {\n        // For a list of supported default protocol hander, see:\n        // https://developer.mozilla.org/en-US/docs/Web/API/Navigator/registerProtocolHandler#permitted_schemes\n        https: \"link-45deg\",\n        http: \"link-45deg\",\n        ftp: \"cloud-download\", // deprecated\n        callto: \"telephone\", // non-standard for skype\n        bitcoin: \"credit-card\", // no bitcoin icon yet\n        geo: \"geo-alt\",\n        im: \"chat\",\n        irc: \"chat\",\n        ircs: \"chat\",\n        magnet: \"link-45deg\",\n        mailto: \"envelope\",\n        mms: \"chat\",\n        news: \"newspaper\",\n        nntp: \"newspaper\",\n        openpgp4fpr: \"key\",\n        sip: \"telephone\",\n        sms: \"chat\",\n        smsto: \"chat\",\n        ssh: \"lock\",\n        tel: \"telephone\",\n        urn: \"link-45deg\",\n        webcal: \"calendar\",\n        wtai: \"telephone\",\n        xmpp: \"chat\",\n    },\n\n    async init() {\n        // first make external links open in a new window, afterwards do the\n        // normal plone link wrapping in only the content area\n\n        let open_new_window = false;\n        if (typeof this.options.external_links_open_new_window === \"string\") {\n            open_new_window =\n                this.options.external_links_open_new_window.toLowerCase() === \"true\";\n        } else if (typeof this.options.external_links_open_new_window === \"boolean\") {\n            open_new_window = this.options.external_links_open_new_window;\n        }\n\n        let mark_special_links = false;\n        if (typeof this.options.mark_special_links === \"string\") {\n            mark_special_links =\n                this.options.mark_special_links.toLowerCase() === \"true\";\n        } else if (typeof this.options.mark_special_links === \"boolean\") {\n            mark_special_links = this.options.mark_special_links;\n        }\n\n        if (mark_special_links) {\n            import(\"./markspeciallinks.scss\");\n        }\n\n        // All links with an http href (without the link-plain class), not within this site,\n        // and no img children should be wrapped in a link-external span\n        const url = window.location.protocol + \"//\" + window.location.host;\n        const links = this.el.querySelectorAll(\n            `a[href]:not(.link-plain):not([href^=\"${url}\"]):not([href^=\"#\"])`\n        );\n        //:not(:has(img))\n        for (const link of links) {\n            let link_url;\n            try {\n                link_url = new URL(link.getAttribute(\"href\"));\n            } catch {\n                // Not a valid URL.\n                // Ignore and continue.\n                continue;\n            }\n\n            if (open_new_window && link_url.protocol.startsWith(\"http\")) {\n                link.setAttribute(\"target\", \"_blank\");\n                link.setAttribute(\"rel\", \"noopener\");\n            }\n\n            if (mark_special_links) {\n                const icon_name =\n                    this.protocol_icon_map[link_url.protocol.split(\":\")[0]];\n                if (icon_name) {\n                    const icon = await utils.resolveIcon(icon_name);\n                    const icon_el = dom.create_from_string(icon);\n                    icon_el.querySelector(\"svg\").classList.add(\"markspeciallinks__icon\");\n                    link.parentNode.insertBefore(icon_el, link);\n                }\n            }\n        }\n    },\n});\n","import $ from \"jquery\";\nimport logging from \"@patternslib/patternslib/src/core/logging\";\n\nconst logger = logging.getLogger(\"core utils\");\n\nvar QueryHelper = function (options) {\n    /* if pattern argument provided, it can implement the interface of:\n     *    - browsing: boolean if currently browsing\n     *    - currentPath: string of current path to apply to search if browsing\n     *    - basePath: default path to provide if no subpath used\n     */\n\n    var self = this;\n    var defaults = {\n        pattern: null, // must be passed in\n        vocabularyUrl: null,\n        searchParam: \"SearchableText\", // query string param to pass to search url\n        pathOperator: \"plone.app.querystring.operation.string.path\",\n        attributes: [\"UID\", \"Title\", \"Description\", \"getURL\", \"portal_type\"],\n        batchSize: 10, // number of results to retrive\n        baseCriteria: [],\n        sort_on: \"is_folderish\",\n        sort_order: \"reverse\",\n        pathDepth: 1,\n    };\n    self.options = $.extend({}, defaults, options);\n\n    self.pattern = self.options.pattern;\n    if (self.pattern === undefined || self.pattern === null) {\n        self.pattern = {\n            browsing: false,\n            basePath: \"/\",\n        };\n    }\n\n    if (self.options.url && !self.options.vocabularyUrl) {\n        self.options.vocabularyUrl = self.options.url;\n    } else if (self.pattern.vocabularyUrl) {\n        self.options.vocabularyUrl = self.pattern.vocabularyUrl;\n    }\n    self.valid = Boolean(self.options.vocabularyUrl);\n\n    self.getBatch = function (page) {\n        return {\n            page: page ? page : 1,\n            size: self.options.batchSize,\n        };\n    };\n\n    self.getCurrentPath = function () {\n        var pattern = self.pattern;\n        var currentPath;\n        /* If currentPath is set on the QueryHelper object, use that first.\n         * Then, check on the pattern.\n         * Finally, see if it is a function and call it if it is.\n         */\n        if (self.currentPath) {\n            currentPath = self.currentPath;\n        } else {\n            currentPath = pattern.currentPath;\n        }\n        if (typeof currentPath === \"function\") {\n            currentPath = currentPath();\n        }\n        var path = currentPath;\n        if (!path) {\n            if (pattern.basePath) {\n                path = pattern.basePath;\n            } else if (pattern.options.basePath) {\n                path = pattern.options.basePath;\n            } else {\n                path = \"/\";\n            }\n        }\n        return path;\n    };\n\n    self.getCriterias = function (term, searchOptions) {\n        if (searchOptions === undefined) {\n            searchOptions = {};\n        }\n        searchOptions = $.extend(\n            {},\n            {\n                useBaseCriteria: true,\n                additionalCriterias: [],\n            },\n            searchOptions\n        );\n\n        var criterias = [];\n        if (searchOptions.useBaseCriteria) {\n            criterias = self.options.baseCriteria.slice(0);\n        }\n        if (term) {\n            term += \"*\";\n            criterias.push({\n                i: self.options.searchParam,\n                o: \"plone.app.querystring.operation.string.contains\",\n                v: term,\n            });\n        }\n        if (searchOptions.searchPath) {\n            criterias.push({\n                i: \"path\",\n                o: self.options.pathOperator,\n                v: searchOptions.searchPath + \"::\" + self.options.pathDepth,\n            });\n        } else if (self.pattern.browsing) {\n            criterias.push({\n                i: \"path\",\n                o: self.options.pathOperator,\n                v: self.getCurrentPath() + \"::\" + self.options.pathDepth,\n            });\n        }\n        criterias = criterias.concat(searchOptions.additionalCriterias);\n        return criterias;\n    };\n\n    self.getQueryData = function (term, page) {\n        var data = {\n            query: JSON.stringify({\n                criteria: self.getCriterias(term),\n                sort_on: self.options.sort_on,\n                sort_order: self.options.sort_order,\n            }),\n            attributes: JSON.stringify(self.options.attributes),\n        };\n        if (page) {\n            data.batch = JSON.stringify(self.getBatch(page));\n        }\n        return data;\n    };\n\n    self.getUrl = function () {\n        var url = self.options.vocabularyUrl;\n        if (url.indexOf(\"?\") === -1) {\n            url += \"?\";\n        } else {\n            url += \"&\";\n        }\n        return url + $.param(self.getQueryData());\n    };\n\n    self.selectAjax = function () {\n        return {\n            url: self.options.vocabularyUrl,\n            dataType: \"JSON\",\n            quietMillis: 100,\n            data: function (term, page) {\n                return self.getQueryData(term, page);\n            },\n            results: function (data, page) {\n                var more = page * 10 < data.total; // whether or not there are more results available\n                // notice we return the value of more so Select2 knows if more results can be loaded\n                return {\n                    results: data.results,\n                    more: more,\n                };\n            },\n        };\n    };\n\n    self.search = function (term, operation, value, callback, useBaseCriteria, type) {\n        if (useBaseCriteria === undefined) {\n            useBaseCriteria = true;\n        }\n        if (type === undefined) {\n            type = \"GET\";\n        }\n        var criteria = [];\n        if (useBaseCriteria) {\n            criteria = self.options.baseCriteria.slice(0);\n        }\n        criteria.push({\n            i: term,\n            o: operation,\n            v: value,\n        });\n        var data = {\n            query: JSON.stringify({\n                criteria: criteria,\n            }),\n            attributes: JSON.stringify(self.options.attributes),\n        };\n        $.ajax({\n            url: self.options.vocabularyUrl,\n            dataType: \"JSON\",\n            data: data,\n            type: type,\n            success: callback,\n        });\n    };\n\n    return self;\n};\n\nvar Loading = function (options) {\n    /*\n     * Options:\n     *   backdrop(pattern): if you want to have the progress indicator work\n     *                      seamlessly with backdrop pattern\n     *   zIndex(integer or function): to override default z-index used\n     */\n    var self = this;\n    self.className = \"spinner-border\";\n    var defaults = {\n        backdrop: null,\n        zIndex: 10005, // can be a function\n    };\n    if (!options) {\n        options = {};\n    }\n    self.options = $.extend({}, defaults, options);\n\n    self.init = function () {\n        self.$el = $(\".\" + self.className);\n        if (self.$el.length === 0) {\n            self.$el = $(\"<div><div></div></div>\");\n            self.$el.addClass(self.className).hide().appendTo(\"body\");\n        }\n    };\n\n    self.show = function (closable) {\n        self.init();\n        self.$el.show();\n        self.$el.css(\"position\", \"absolute\");\n        self.$el.css(\"top\", \"50%\");\n        self.$el.css(\"left\", \"50%\");\n        var zIndex = self.options.zIndex;\n        if (typeof zIndex === \"function\") {\n            zIndex = Math.max(zIndex(), 10005);\n        } else {\n            // go through all modals and backdrops and make sure we have a higher\n            // z-index to use\n            zIndex = 10005;\n            $(\".modal-wrapper,.-modal-backdrop\").each(function () {\n                zIndex = Math.max(zIndex, $(this).css(\"zIndex\") || 10005);\n            });\n            zIndex += 1;\n        }\n        self.$el.css(\"zIndex\", zIndex);\n\n        if (closable === undefined) {\n            closable = true;\n        }\n        if (self.options.backdrop) {\n            self.options.backdrop.closeOnClick = closable;\n            self.options.backdrop.closeOnEsc = closable;\n            self.options.backdrop.init();\n            self.options.backdrop.show();\n        }\n    };\n\n    self.hide = function () {\n        self.init();\n        self.$el.hide();\n    };\n\n    return self;\n};\n\nvar getAuthenticator = function () {\n    var $el = $('input[name=\"_authenticator\"]');\n    if ($el.length === 0) {\n        $el = $('a[href*=\"_authenticator\"]');\n        if ($el.length > 0) {\n            return $el.attr(\"href\").split(\"_authenticator=\")[1];\n        }\n        return \"\";\n    } else {\n        return $el.val();\n    }\n};\n\nvar generateId = function (prefix) {\n    if (prefix === undefined) {\n        prefix = \"id\";\n    }\n    return (\n        prefix +\n        Math.floor((1 + Math.random()) * 0x10000)\n            .toString(16)\n            .substring(1)\n    );\n};\n\nvar setId = function ($el, prefix) {\n    if (prefix === undefined) {\n        prefix = \"id\";\n    }\n    var id = $el.attr(\"id\");\n    if (id === undefined) {\n        id = generateId(prefix);\n    } else {\n        /* hopefully we don't screw anything up here... changing the id\n         * in some cases so we get a decent selector */\n        id = id.replace(/\\./g, \"-\");\n    }\n    $el.attr(\"id\", id);\n    return id;\n};\n\nvar getWindow = function () {\n    var win = window;\n    if (win.parent !== window) {\n        win = win.parent;\n    }\n    return win;\n};\n\nvar parseBodyTag = function (txt) {\n    return $(\n        /<body[^>]*>[^]*<\\/body>/im\n            .exec(txt)[0]\n            .replace(\"<body\", \"<div\")\n            .replace(\"</body>\", \"</div>\")\n    )\n        .eq(0)\n        .html();\n};\n\nvar featureSupport = {\n    /* Well tested feature support for things we use in mockup.\n     * All gathered from: http://diveintohtml5.info/everything.html\n     * Alternative to using some form of modernizr.\n     */\n    dragAndDrop: function () {\n        return \"draggable\" in document.createElement(\"span\");\n    },\n    fileApi: function () {\n        return typeof FileReader != \"undefined\";\n    },\n    history: function () {\n        return !!(window.history && window.history.pushState);\n    },\n};\n\nvar bool = function (val) {\n    if (typeof val === \"string\") {\n        val = val.trim(val).toLowerCase();\n    }\n    return [\"false\", false, \"0\", 0, \"\", undefined, null].indexOf(val) === -1;\n};\n\nvar escapeHTML = function (val) {\n    return $(\"<div/>\").text(val).html();\n};\n\nvar removeHTML = function (val) {\n    return val.replace(/<[^>]+>/gi, \"\");\n};\n\nvar storage = {\n    // Simple local storage wrapper, which doesn't break down if it's not available.\n    get: function (name) {\n        if (window.localStorage) {\n            var val = window.localStorage[name];\n            return typeof val === \"string\" ? JSON.parse(val) : undefined;\n        }\n    },\n\n    set: function (name, val) {\n        if (window.localStorage) {\n            window.localStorage[name] = JSON.stringify(val);\n        }\n    },\n};\n\nexport const ICON_CACHE = new Map();\n\n/**\n * Return a <svg> element from a icon name.\n *\n * Example:\n *     const dropdownIcon: await utils.resolveIcon('plone-settings');\n *\n * @param {String} name - The name of the icon as stored in the plone registry.\n * @returns {String} - The SVG markup for the icon.\n */\nconst resolveIcon = async function (name) {\n    // if (name === 'plone.icon.plone-rearrange'){debugger}\n    const icon_lookup_name = `plone.icon.${name}`;\n    const cache_key = icon_lookup_name;\n\n    // ATTENTION: async/await trick ahead!\n    if (!ICON_CACHE.has(cache_key)) {\n        // 1) Immediately set the asynchronous function call to _resolve_icon in the icon cache.\n        // Subsequent calls will not re-set this because the cache_key is already set.\n        ICON_CACHE.set(cache_key, _resolve_icon());\n        logger.debug(`Loading icon \"${icon_lookup_name}\"`);\n    }\n    // 2) Await the promise for resolving the icon or just return the icon itself.\n    return await ICON_CACHE.get(cache_key);\n\n    async function _resolve_icon() {\n        // Do the actual loading.\n\n        let icon = \"\";\n        const base_url = document.body.getAttribute(\"data-portal-url\");\n        if (base_url) {\n            const url = base_url + \"/@@iconresolver\";\n            if (url) {\n                try {\n                    // Fetch timeout\n                    const controller = new AbortController();\n                    // 5 second timeout:\n                    setTimeout(() => controller.abort(), 5000);\n\n                    const resp = await fetch(`${url}/${name}`, {\n                        signal: controller.signal,\n                    });\n                    icon = await resp.text();\n                } catch (e) {\n                    logger.warn(`Loading icon \"${name}\" from URL ${url} failed.`);\n                    console.warn(e);\n                }\n            }\n        }\n        if (!icon) {\n            // fallback\n            name = icon_lookup_name;\n            try {\n                import(\"../styles/icons.scss\");\n                const iconmap = await import(\"../iconmap.json\");\n                const parts = iconmap[name]?.split?.(\"/\");\n                if (parts[0].includes(\"bootstrap-icons\")) {\n                    icon = await import(`bootstrap-icons/icons/${parts[1]}`);\n                    icon = icon?.default;\n                }\n            } catch (e) {\n                // import error\n                logger.warn(`Loading icon \"${icon_lookup_name}\" failed from fallback.`);\n                console.warn(e);\n            }\n        }\n        return icon;\n    }\n};\n\nexport default {\n    bool: bool,\n    escapeHTML: escapeHTML,\n    removeHTML: removeHTML,\n    featureSupport: featureSupport,\n    generateId: generateId,\n    getAuthenticator: getAuthenticator,\n    getWindow: getWindow,\n    Loading: Loading,\n    loading: new Loading(), // provide default loader\n    parseBodyTag: parseBodyTag,\n    QueryHelper: QueryHelper,\n    resolveIcon: resolveIcon,\n    setId: setId,\n    storage: storage,\n};\n","import $ from \"jquery\";\nimport _ from \"underscore\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport DisplayTemplate from \"./templates/display.xml\";\nimport FormTemplate from \"./templates/form.xml\";\nimport OccurrenceTemplate from \"./templates/occurrence.xml\";\nimport Modal from \"../modal/modal\";\nimport utils from \"../../core/utils\";\n\n// Formatting function (mostly) from jQueryTools dateinput\nvar Re = /d{1,4}|m{1,4}|yy(?:yy)?|\"[^\"]*\"|'[^']*'/g;\n\nfunction zeropad(val, len) {\n    val = val.toString();\n    len = len || 2;\n    while (val.length < len) {\n        val = \"0\" + val;\n    }\n    return val;\n}\n\nfunction format(date, fmt, conf) {\n    var d = date.getDate(),\n        D = date.getDay(),\n        m = date.getMonth(),\n        y = date.getFullYear(),\n        flags = {\n            d: d,\n            dd: zeropad(d),\n            ddd: conf.localization.shortWeekdays[D],\n            dddd: conf.localization.weekdays[D],\n            m: m + 1,\n            mm: zeropad(m + 1),\n            mmm: conf.localization.shortMonths[m],\n            mmmm: conf.localization.months[m],\n            yy: String(y).slice(2),\n            yyyy: y,\n        };\n\n    var result = fmt.replace(Re, function ($0) {\n        return Object.prototype.hasOwnProperty.call(flags, $0)\n            ? flags[$0]\n            : $0.slice(1, $0.length - 1);\n    });\n\n    return result;\n}\n\nfunction widgetSaveToRfc5545(form, RDATE, EXDATE, conf, tz) {\n    var value = form.find(\"select[name=rirtemplate]\").val();\n    var rtemplate = conf.rtemplate[value];\n    var result = \"RRULE:\" + rtemplate.rrule;\n    var human = conf.localization.rtemplate[value];\n    var interval, month, year, occurrences, day;\n    var weekdays, i18nweekdays, input, monthlyType, index;\n    var yearlyType, rangeType;\n\n    for (const field_id of rtemplate.fields) {\n        const field = form.find(`#${field_id}`);\n\n        switch (field.attr(\"id\")) {\n            case \"ridailyinterval\":\n                interval = field.find(\"input[name=ridailyinterval]\").val();\n                if (interval !== \"1\") {\n                    result += `;INTERVAL=${interval}`;\n                }\n                human = `${interval} ${conf.localization.dailyInterval2}`;\n                break;\n\n            case \"riweeklyinterval\":\n                interval = field.find(\"input[name=riweeklyinterval]\").val();\n                if (interval !== \"1\") {\n                    result += `;INTERVAL=${interval}`;\n                }\n                human = `${interval} ${conf.localization.weeklyInterval2}`;\n                break;\n\n            case \"riweeklyweekdays\":\n                weekdays = [];\n                i18nweekdays = [];\n                for (let j = 0; j < conf.weekdays.length; j++) {\n                    input = field.find(`input[name=riweeklyweekdays${j}]`);\n                    if (input.is(\":checked\")) {\n                        weekdays.push(conf.weekdays[j]);\n                        i18nweekdays.push(conf.localization.weekdays[j]);\n                    }\n                }\n                if (weekdays.length > 0) {\n                    result += `;BYDAY=${weekdays.join(\",\")}`;\n                    human += ` ${\n                        conf.localization.weeklyWeekdaysHuman\n                    } ${i18nweekdays.join(\",\")}`;\n                }\n                break;\n\n            case \"rimonthlyinterval\":\n                interval = field.find(\"input[name=rimonthlyinterval]\").val();\n                if (interval !== \"1\") {\n                    result += `;INTERVAL=${interval}`;\n                }\n                human = `${interval} ${conf.localization.monthlyInterval2}`;\n                break;\n\n            case \"rimonthlyoptions\":\n                monthlyType = $(\"input[name=rimonthlytype]:checked\", form).val();\n                if (monthlyType === \"DAYOFMONTH\") {\n                    day = $(\"select[name=rimonthlydayofmonthday]\", form).val();\n                    result += `;BYMONTHDAY=${day}`;\n                    human += `, ${conf.localization.monthlyDayOfMonth1Human} ${day} ${conf.localization.monthlyDayOfMonth2}`;\n                } else if (monthlyType === \"WEEKDAYOFMONTH\") {\n                    index = $(\"select[name=rimonthlyweekdayofmonthindex]\", form).val();\n                    day =\n                        conf.weekdays[\n                            $(\"select[name=rimonthlyweekdayofmonth]\", form).val()\n                        ];\n                    if ([\"MO\", \"TU\", \"WE\", \"TH\", \"FR\", \"SA\", \"SU\"].includes(day)) {\n                        result += `;BYDAY=${index}${day}`;\n                        human += `, ${conf.localization.monthlyWeekdayOfMonth1Human} `;\n                        human += `${\n                            conf.localization.orderIndexes[\n                                conf.orderIndexes.indexOf(index)\n                            ]\n                        } ${conf.localization.monthlyWeekdayOfMonth2} `;\n                        human += `${\n                            conf.localization.weekdays[conf.weekdays.indexOf(day)]\n                        } ${conf.localization.monthlyDayOfMonth2}`;\n                    }\n                }\n                break;\n\n            case \"riyearlyinterval\":\n                interval = field.find(\"input[name=riyearlyinterval]\").val();\n                if (interval !== \"1\") {\n                    result += `;INTERVAL=${interval}`;\n                }\n                human = `${interval} ${conf.localization.yearlyInterval2}`;\n                break;\n\n            case \"riyearlyoptions\":\n                yearlyType = $(\"input[name=riyearlyType]:checked\", form).val();\n                month = \"\";\n\n                if (yearlyType === \"DAYOFMONTH\") {\n                    month = $(\"select[name=riyearlydayofmonthmonth]\", form).val();\n                    day = $(\"select[name=riyearlydayofmonthday]\", form).val();\n                    result += `;BYMONTH=${month};BYMONTHDAY=${day}`;\n                    human += `, ${conf.localization.yearlyDayOfMonth1Human} ${\n                        conf.localization.months[month - 1]\n                    } ${day}`;\n                } else if (yearlyType === \"WEEKDAYOFMONTH\") {\n                    index = $(\"select[name=riyearlyweekdayofmonthindex]\", form).val();\n                    day =\n                        conf.weekdays[\n                            $(\"select[name=riyearlyweekdayofmonthday]\", form).val()\n                        ];\n                    month = $(\"select[name=riyearlyweekdayofmonthmonth]\", form).val();\n                    result += `;BYMONTH=${month}`;\n                    if ([\"MO\", \"TU\", \"WE\", \"TH\", \"FR\", \"SA\", \"SU\"].includes(day)) {\n                        result += `;BYDAY=${index}${day}`;\n                        human += \", \" + conf.localization.yearlyWeekdayOfMonth1Human;\n                        human +=\n                            \" \" +\n                            conf.localization.orderIndexes[\n                                $.inArray(index, conf.orderIndexes)\n                            ];\n                        human += \" \" + conf.localization.yearlyWeekdayOfMonth2;\n                        human +=\n                            \" \" +\n                            conf.localization.weekdays[$.inArray(day, conf.weekdays)];\n                        human += \" \" + conf.localization.yearlyWeekdayOfMonth3;\n                        human += \" \" + conf.localization.months[month - 1];\n                        human += \" \" + conf.localization.yearlyWeekdayOfMonth4;\n                    }\n                }\n                break;\n\n            case \"rirangeoptions\":\n                rangeType = form.find(\"input[name=rirangetype]:checked\").val();\n                if (rangeType === \"BYOCCURRENCES\") {\n                    occurrences = form\n                        .find(\"input[name=rirangebyoccurrencesvalue]\")\n                        .val();\n                    result += `;COUNT=${occurrences}`;\n                    human += `, ${conf.localization.rangeByOccurrences1Human} ${occurrences} ${conf.localization.rangeByOccurrences2}`;\n                } else if (rangeType === \"BYENDDATE\") {\n                    let date = form.find(\"input[name=rirangebyenddatecalendar]\").val();\n                    if (date === \"\") {\n                        const today = new Date();\n                        date = `${today.getFullYear()}-${(today.getMonth() + 1)\n                            .toString()\n                            .padStart(2, \"0\")}-${today.getDate()}`;\n                    }\n                    result += `;UNTIL=${date.replaceAll(\"-\", \"\")}T000000${\n                        tz === true ? \"Z\" : \"\"\n                    }`;\n                    human += `, ${conf.localization.rangeByEndDateHuman} `;\n                    var date_parts = date.split(\"-\");\n                    human += format(\n                        new Date(date_parts[0], date_parts[1] - 1, date_parts[2]),\n                        conf.localization.longDateFormat,\n                        conf\n                    );\n                }\n                break;\n        }\n    }\n\n    if (RDATE.length) {\n        RDATE.sort();\n        let tmp_dates = [];\n        let tmp_human = [];\n\n        // make sure our additional RDATE dates have the same start time\n        // XXX: not used, remove if superfluous\n        //const rdate_time = start_date\n        //    ? `T${start_date.getHours()}:${start_date.getMinutes()}:00`\n        //    : \"T00:00:00\";\n\n        for (let rdate of RDATE) {\n            if (rdate !== \"\") {\n                // RDATE values are \"YYYY-MM-DD\"\n                // by adding \"T000000\" the recurrence sequence generator of\n                // plone.event.recurrence adds the current start time correctly\n                rdate += rdate.length === 10 ? \"T000000\" : \"\";\n                rdate += tz ? \"Z\" : \"\";\n                tmp_dates.push(rdate);\n\n                // human readable RDATE\n                year = parseInt(rdate.substring(0, 4), 10);\n                month = parseInt(rdate.substring(5, 7), 10) - 1;\n                day = parseInt(rdate.substring(8, 10), 10);\n                tmp_human.push(\n                    format(\n                        new Date(year, month, day),\n                        conf.localization.longDateFormat,\n                        conf\n                    )\n                );\n            }\n        }\n        if (tmp_dates.length) {\n            result += `\\nRDATE:${tmp_dates.join(\",\")}`;\n            human += `${conf.localization.including} ${tmp_human.join(\"; \")}`;\n        }\n    }\n\n    if (EXDATE.length) {\n        EXDATE.sort();\n        let tmp_dates = [];\n        let tmp_human = [];\n        for (let exdate of EXDATE) {\n            if (exdate !== \"\") {\n                // EXDATE values are \"YYYYMMDDTHHMMZ\"\n                tmp_dates.push(exdate);\n\n                // human readable EXDATE\n                year = parseInt(exdate.substring(0, 4), 10);\n                month = parseInt(exdate.substring(4, 6), 10) - 1;\n                day = parseInt(exdate.substring(6, 8), 10);\n                tmp_human.push(\n                    format(\n                        new Date(year, month, day),\n                        conf.localization.longDateFormat,\n                        conf\n                    )\n                );\n            }\n        }\n        if (tmp_dates.length) {\n            result += `\\nEXDATE:${tmp_dates.join(\",\")}`;\n            human += `${conf.localization.except} ${tmp_human.join(\"; \")}`;\n        }\n    }\n\n    return { result: result, description: human };\n}\n\nfunction parseLine(icalline) {\n    var result = {};\n    var pos = icalline.indexOf(\":\");\n    var property = icalline.substring(0, pos);\n    result.value = icalline.substring(pos + 1);\n\n    if (property.indexOf(\";\") !== -1) {\n        pos = property.indexOf(\";\");\n        result.parameters = property.substring(pos + 1);\n        result.property = property.substring(0, pos);\n    } else {\n        result.parameters = null;\n        result.property = property;\n    }\n    return result;\n}\n\nfunction cleanDates(dates) {\n    // Get rid of timezones\n    // TODO: We could parse dates and range here, maybe?\n    var result = [];\n\n    for (const date of dates.split(\",\")) {\n        if (date.indexOf(\"Z\") !== -1) {\n            result.push(date.substring(0, 15));\n        } else {\n            result.push(date);\n        }\n    }\n    return result;\n}\n\nfunction parseIcal(icaldata) {\n    var lines = [];\n    var result = {\n        RRULE: \"\",\n        RDATE: [],\n        EXDATE: [],\n    };\n    var line = null;\n    var nextline;\n\n    lines = icaldata.split(\"\\n\");\n    lines.reverse();\n    while (line !== \"\") {\n        if (lines.length > 0) {\n            nextline = lines.pop();\n            if (nextline.charAt(0) === \" \" || nextline.charAt(0) === \"\\t\") {\n                // Line continuation:\n                line = line + nextline;\n                continue;\n            }\n        } else {\n            nextline = \"\";\n        }\n\n        // New line; the current one is finished, add it to the result.\n        if (line !== null) {\n            line = parseLine(line);\n            // We ignore properties for now\n            if (line.property === \"RDATE\" || line.property === \"EXDATE\") {\n                result[line.property] = cleanDates(line.value);\n            } else {\n                result[line.property] = line.value;\n            }\n        }\n\n        line = nextline;\n    }\n    return result;\n}\n\nfunction widgetLoadFromRfc5545(form, conf, icaldata, force) {\n    var unsupportedFeatures = [];\n    var matches, rtemplate, d, input, index;\n    var selectors, field, radiobutton;\n    var freq, interval, byday, bymonth, bymonthday, count, until;\n    var day, month, year, weekday;\n\n    if (icaldata.RRULE === undefined) {\n        unsupportedFeatures.push(conf.localization.noRule);\n        if (!force) {\n            return -1; // Fail!\n        }\n    } else {\n        matches = /FREQ=([^;]+);?/.exec(icaldata.RRULE);\n        if (matches) {\n            freq = matches[1];\n        } else {\n            freq = \"DAILY\";\n        }\n\n        matches = /INTERVAL=([0-9]+);?/.exec(icaldata.RRULE);\n        if (matches) {\n            interval = matches[1];\n        } else {\n            interval = \"1\";\n        }\n\n        matches = /BYDAY=([^;]+);?/.exec(icaldata.RRULE);\n        if (matches) {\n            byday = matches[1];\n        } else {\n            byday = \"\";\n        }\n\n        matches = /BYMONTHDAY=([^;]+);?/.exec(icaldata.RRULE);\n        if (matches) {\n            bymonthday = matches[1].split(\",\");\n        } else {\n            bymonthday = null;\n        }\n\n        matches = /BYMONTH=([^;]+);?/.exec(icaldata.RRULE);\n        if (matches) {\n            bymonth = matches[1].split(\",\");\n        } else {\n            bymonth = null;\n        }\n\n        matches = /COUNT=([0-9]+);?/.exec(icaldata.RRULE);\n        if (matches) {\n            count = matches[1];\n        } else {\n            count = null;\n        }\n\n        matches = /UNTIL=([0-9T]+);?/.exec(icaldata.RRULE);\n        if (matches) {\n            until = matches[1];\n        } else {\n            until = null;\n        }\n\n        matches = /BYSETPOS=([^;]+);?/.exec(icaldata.RRULE);\n        if (matches) {\n            unsupportedFeatures.push(conf.localization.bysetpos);\n        }\n\n        // Find the best rule:\n        if (Object.prototype.hasOwnProperty.call(conf.rtemplate, freq.toLowerCase())) {\n            rtemplate = conf.rtemplate[freq.toLowerCase()];\n        } else {\n            for (freq of conf.rtemplate) {\n                /* fallback to first available template if no match above*/\n                rtemplate = conf.rtemplate[freq];\n                break;\n            }\n            unsupportedFeatures.push(conf.localization.noTemplateMatch);\n        }\n\n        // set rirtemplate selector to computed value\n        form.find(\"select[name='rirtemplate']\").val(freq.toLowerCase());\n\n        for (const field_id of rtemplate.fields) {\n            field = form.find(`#${field_id}`);\n            switch (field.attr(\"id\")) {\n                case \"ridailyinterval\":\n                    field.find(\"input[name=ridailyinterval]\").val(interval);\n                    break;\n\n                case \"riweeklyinterval\":\n                    field.find(\"input[name=riweeklyinterval]\").val(interval);\n                    break;\n\n                case \"riweeklyweekdays\":\n                    if (byday.length === 0) break;\n                    byday = byday.split(\",\");\n                    for (d = 0; d < conf.weekdays.length; d++) {\n                        input = field.find(`input[name=\"riweeklyweekdays${d}\"]`);\n                        if (input.length === 0) continue;\n                        day = conf.weekdays[d];\n                        input.attr(\"checked\", byday.includes(day));\n                    }\n                    break;\n\n                case \"rimonthlyinterval\":\n                    field.find(\"input[name=rimonthlyinterval]\").val(interval);\n                    break;\n\n                case \"rimonthlyoptions\":\n                    var monthlyType = \"DAYOFMONTH\"; // Default to using BYMONTHDAY\n\n                    if (bymonthday) {\n                        monthlyType = \"DAYOFMONTH\";\n                        if (bymonthday.length > 1) {\n                            // No support for multiple days in one month\n                            unsupportedFeatures.push(\n                                conf.localization.multipleDayOfMonth\n                            );\n                            // Just keep the first\n                            bymonthday = bymonthday[0];\n                        }\n                        field\n                            .find(\"select[name=rimonthlydayofmonthday]\")\n                            .val(bymonthday);\n                    }\n\n                    if (byday) {\n                        monthlyType = \"WEEKDAYOFMONTH\";\n\n                        if (byday.indexOf(\",\") !== -1) {\n                            // No support for multiple days in one month\n                            unsupportedFeatures.push(\n                                conf.localization.multipleDayOfMonth\n                            );\n                            byday = byday.split(\",\")[0];\n                        }\n                        index = byday.slice(0, -2);\n                        if (index.charAt(0) !== \"+\" && index.charAt(0) !== \"-\") {\n                            index = \"+\" + index;\n                        }\n                        weekday = byday.slice(-2);\n                        field\n                            .find(\"select[name=rimonthlyweekdayofmonthindex]\")\n                            .val(index);\n                        const day_index = conf.weekdays.indexOf(weekday);\n                        field.find(\"select[name=rimonthlyweekdayofmonth]\").val(day_index);\n                    }\n\n                    selectors = field.find(\"input[name=rimonthlytype]\");\n                    for (index = 0; index < selectors.length; index++) {\n                        radiobutton = selectors[index];\n                        $(radiobutton).attr(\n                            \"checked\",\n                            radiobutton.value === monthlyType\n                        );\n                    }\n                    break;\n\n                case \"riyearlyinterval\":\n                    field.find(\"input[name=riyearlyinterval]\").val(interval);\n                    break;\n\n                case \"riyearlyoptions\":\n                    var yearlyType = \"DAYOFMONTH\"; // Default to using BYMONTHDAY\n\n                    if (bymonthday) {\n                        yearlyType = \"DAYOFMONTH\";\n                        if (bymonthday.length > 1) {\n                            // No support for multiple days in one month\n                            unsupportedFeatures.push(\n                                conf.localization.multipleDayOfMonth\n                            );\n                            bymonthday = bymonthday[0];\n                        }\n                        field.find(\"select[name=riyearlydayofmonthmonth]\").val(bymonth);\n                        field.find(\"select[name=riyearlydayofmonthday]\").val(bymonthday);\n                    }\n\n                    if (byday) {\n                        yearlyType = \"WEEKDAYOFMONTH\";\n\n                        if (byday.indexOf(\",\") !== -1) {\n                            // No support for multiple days in one month\n                            unsupportedFeatures.push(\n                                conf.localization.multipleDayOfMonth\n                            );\n                            byday = byday.split(\",\")[0];\n                        }\n                        index = byday.slice(0, -2);\n                        if (index.charAt(0) !== \"+\" && index.charAt(0) !== \"-\") {\n                            index = \"+\" + index;\n                        }\n                        weekday = byday.slice(-2);\n                        field\n                            .find(\"select[name=riyearlyweekdayofmonthindex]\")\n                            .val(index);\n\n                        const weekday_index = conf.weekdays.indexOf(weekday);\n                        field\n                            .find(\"select[name=riyearlyweekdayofmonthday]\")\n                            .val(weekday_index);\n                        field\n                            .find(\"select[name=riyearlyweekdayofmonthmonth]\")\n                            .val(bymonth);\n                    }\n\n                    selectors = field.find(\"input[name=riyearlyType]\");\n                    for (index = 0; index < selectors.length; index++) {\n                        radiobutton = selectors[index];\n                        $(radiobutton).attr(\"checked\", radiobutton.value === yearlyType);\n                    }\n                    break;\n\n                case \"rirangeoptions\":\n                    // default value per configuration\n                    var rangeType = conf.hasRepeatForeverButton ? \"NOENDDATE\" : \"BYOCCURRENCES\";\n\n                    if (count) {\n                        rangeType = \"BYOCCURRENCES\";\n                        field.find(\"input[name=rirangebyoccurrencesvalue]\").val(count);\n                    }\n\n                    if (until) {\n                        rangeType = \"BYENDDATE\";\n                        input = field.find(\"input[name=rirangebyenddatecalendar]\");\n                        year = until.slice(0, 4);\n                        month = until.slice(4, 6);\n                        day = until.slice(6, 8);\n                        input.val(`${year}-${month}-${day}`);\n                    }\n\n                    selectors = field.find(\"input[name=rirangetype]\");\n                    for (index = 0; index < selectors.length; index++) {\n                        radiobutton = selectors[index];\n                        $(radiobutton).attr(\"checked\", radiobutton.value === rangeType);\n                    }\n                    break;\n            }\n        }\n    }\n\n    var messagearea = form.find(\"#messagearea\");\n    if (unsupportedFeatures.length !== 0) {\n        messagearea.text(\n            conf.localization.unsupportedFeatures + \" \" + unsupportedFeatures.join(\"; \")\n        );\n        messagearea.show();\n        return 1;\n    } else {\n        messagearea.text(\"\");\n        messagearea.hide();\n        return 0;\n    }\n}\n\nconst RecurrenceInput = function (conf, textarea) {\n    var self = this;\n    var $textarea = $(textarea);\n\n    // initalize parsed icaldata\n    if (textarea.innerHTML) {\n        textarea[\"ical\"] = parseIcal(textarea.innerHTML);\n    } else {\n        textarea[\"ical\"] = {\n            RRULE: \"\",\n            RDATE: [],\n            EXDATE: [],\n        };\n    }\n\n    // Extend conf with non-configurable data used by templates.\n    var orderedWeekdays = [];\n    var now_date = new Date().toISOString().substring(0, 10);\n    var index;\n\n    for (let i = 0; i < 7; i++) {\n        index = i + conf.firstDay;\n        if (index > 6) {\n            index = index - 7;\n        }\n        orderedWeekdays.push(index);\n    }\n\n    conf = {\n        ...conf,\n        orderIndexes: [\"+1\", \"+2\", \"+3\", \"+4\", \"-1\"],\n        weekdays: [\"SU\", \"MO\", \"TU\", \"WE\", \"TH\", \"FR\", \"SA\"],\n        orderedWeekdays: orderedWeekdays,\n    };\n\n    // The recurrence type dropdown should show certain fields depending\n    // on selection:\n    function displayFields(selector) {\n        // First hide all the fields\n        self.$modalForm.find(\".rifield\").hide();\n        // Then show the ones that should be shown.\n        var value = selector.val();\n        if (value) {\n            for (const rtField of conf.rtemplate[value].fields) {\n                self.$modalForm.find(`#${rtField}`).show();\n            }\n        }\n    }\n\n    function occurrenceExclude(event) {\n        event.preventDefault();\n        textarea[\"ical\"].EXDATE.push(this.attributes.date.value);\n        var $this = $(this);\n        $this.addClass(\"exdate\");\n        $this.parent().parent().addClass(\"exdate\");\n        $this.off(\"click\").on(\"click\", occurrenceInclude);\n    }\n\n    function occurrenceInclude(event) {\n        event.preventDefault();\n        textarea[\"ical\"].EXDATE.splice(\n            $.inArray(this.attributes.date.value, textarea[\"ical\"].EXDATE),\n            1\n        );\n        var $this = $(this);\n        $this.removeClass(\"exdate\");\n        $this.parent().parent().removeClass(\"exdate\");\n        $this.off(\"click\").on(\"click\", occurrenceExclude);\n    }\n\n    function occurrenceDelete(event) {\n        event.preventDefault();\n        textarea[\"ical\"].RDATE.splice(\n            $.inArray(this.attributes.date.value, textarea[\"ical\"].RDATE),\n            1\n        );\n        $(this)\n            .parent()\n            .parent()\n            .hide(\"slow\", function () {\n                $(this).remove();\n            });\n    }\n\n    function occurrenceAdd(event) {\n        event.preventDefault();\n        var datevalue = self.$modalForm.find(\".riaddoccurrence input#adddate\").val();\n        var date_parts = datevalue.split(\"-\");\n        datevalue += datevalue.length === 10 ? \"T000000\" : \"\";\n        var errorarea = self.$modalForm.find(\".riaddoccurrence div.alert\");\n        errorarea.text(\"\");\n        errorarea.hide();\n\n        // Add date only if it is not already in RDATE\n        if (!textarea[\"ical\"].RDATE.includes(datevalue)) {\n            textarea[\"ical\"].RDATE.push(datevalue);\n            var $newdate =\n                $(`<div class=\"d-flex justify-content-between occurrence rdate\">\n                <span class=\"rdate\">\n                    ${format(\n                        new Date(date_parts[0], date_parts[1] - 1, date_parts[2]),\n                        conf.localization.longDateFormat,\n                        conf\n                    )},\n                    <span class=\"rlabel\">${conf.localization.additionalDate}</span>\n                </span>\n                <span class=\"action\">\n                    <a date=\"${datevalue}\" href=\"#\" class=\"btn btn-sm btn-secondary rdate\" >\n                        ${conf.icons.remove}\n                    </a>\n                </span>\n                </div>`);\n            $newdate.hide();\n            self.$modalForm.find(\"div.rioccurrences\").prepend($newdate);\n            $newdate.slideDown();\n            $newdate.find(\"a.rdate\").on(\"click\", occurrenceDelete);\n        } else {\n            errorarea.text(conf.localization.alreadyAdded).show();\n        }\n    }\n\n    // element is where to find the tag in question. Can be the form\n    // or the display widget. Defaults to the self.$modalForm.\n    function loadOccurrences(startdate, rfc5545, start, readonly) {\n        var element, occurrenceDiv;\n\n        if (!readonly) {\n            element = self.$modalForm;\n        } else {\n            element = self.display;\n        }\n\n        occurrenceDiv = element.find(\".rioccurrences\");\n        occurrenceDiv.hide();\n\n        const year = startdate.getFullYear();\n        const month = startdate.getMonth() + 1;\n        const day = startdate.getDate();\n\n        var data = {\n            year: year,\n            month: month, // Sending January as 0? I think not.\n            day: day,\n            rrule: rfc5545,\n            format: conf.localization.longDateFormat,\n            start: start,\n        };\n\n        $.ajax({\n            url: conf.ajaxURL,\n            async: false, // Can't be tested if it's asynchronous, annoyingly.\n            type: \"post\",\n            dataType: \"json\",\n            contentType: conf.ajaxContentType,\n            cache: false,\n            data: data,\n            success: function (resp) {\n                var result;\n\n                resp.readOnly = readonly;\n                resp.localization = conf.localization;\n                resp.icons = conf.icons;\n\n                // Format dates:\n                var date, y, m, d;\n                for (let occurrence of resp.occurrences) {\n                    date = occurrence.date;\n                    y = parseInt(date.substring(0, 4), 10);\n                    m = parseInt(date.substring(4, 6), 10) - 1; // jan=0\n                    d = parseInt(date.substring(6, 8), 10);\n                    occurrence.date = `${y}-${zeropad(m+1)}-${zeropad(d)}T000000`;\n                    occurrence.formattedDate = format(\n                        new Date(y, m, d),\n                        conf.localization.longDateFormat,\n                        conf\n                    );\n                }\n\n                result = _.template(OccurrenceTemplate)(resp);\n                occurrenceDiv.replaceWith(result);\n\n                // Add the batch actions:\n                element.find(\".rioccurrences .batching a\").on(\"click\", function (event) {\n                    event.stopPropagation();\n                    event.preventDefault();\n                    loadOccurrences(\n                        startdate,\n                        rfc5545,\n                        this.attributes.start.value,\n                        readonly\n                    );\n                });\n\n                // Add the delete/undelete actions:\n                if (!readonly) {\n                    element\n                        .find(\".rioccurrences .action a.rrule\")\n                        .on(\"click\", occurrenceExclude);\n                    element\n                        .find(\".rioccurrences .action a.exdate\")\n                        .on(\"click\", occurrenceInclude);\n                    element\n                        .find(\".rioccurrences .action a.rdate\")\n                        .on(\"click\", occurrenceDelete);\n                }\n                // Show the new div\n                occurrenceDiv.show();\n            },\n            error: function (jqXHR, textStatus) {\n                alert(textStatus);\n            },\n        });\n    }\n\n    function getField(field) {\n        // See if it is a field already\n        var realField = $(field);\n        if (!realField.length) {\n            // Otherwise, we assume it's an id:\n            realField = $(\"#\" + field);\n        }\n        if (!realField.length) {\n            // Still not? Then it's a name.\n            realField = $(\"input[name='\" + field + \"']\");\n        }\n        return realField;\n    }\n    function findStartDate() {\n        var startdate = null;\n        var startField, startFieldYear, startFieldMonth, startFieldDay;\n\n        // Find the default byday and bymonthday from the start date, if any:\n        if (conf.startField) {\n            startField = getField(conf.startField);\n            if (!startField.length) {\n                // Field not found\n                return null;\n            }\n            startdate = startField.val();\n            if (startdate === \"\") {\n                // Probably not an input at all. Try to see if it contains a date\n                startdate = startField.text();\n            }\n\n            if (typeof startdate === \"string\") {\n                // convert human readable, non ISO8601 dates, like\n                // '2014-04-24 19:00', where the 'T' separator is missing.\n                startdate = startdate.replace(\" \", \"T\");\n            }\n\n            startdate = new Date(startdate);\n        } else if (conf.startFieldYear && conf.startFieldMonth && conf.startFieldDay) {\n            startFieldYear = getField(conf.startFieldYear);\n            startFieldMonth = getField(conf.startFieldMonth);\n            startFieldDay = getField(conf.startFieldDay);\n            if (\n                !startFieldYear.length &&\n                !startFieldMonth.length &&\n                !startFieldDay.length\n            ) {\n                // Field not found\n                return null;\n            }\n            startdate = new Date(\n                startFieldYear.val(),\n                startFieldMonth.val() - 1,\n                startFieldDay.val()\n            );\n        }\n        if (startdate === null) {\n            return null;\n        }\n        // We have some sort of startdate:\n        if (isNaN(startdate)) {\n            return null;\n        }\n        return startdate;\n    }\n    function findEndDate() {\n        var endField, enddate;\n\n        endField = self.$modalForm.find(\"input[name=rirangebyenddatecalendar]\");\n        enddate = endField.val();\n        enddate = new Date(enddate);\n\n        // if the end date is incorrect or the field is left empty\n        if (isNaN(enddate) || endField.val() === \"\") {\n            return null;\n        }\n        return enddate;\n    }\n    function findIntField(fieldName) {\n        var field, num;\n\n        field = self.$modalForm.find(\"input[name=\" + fieldName + \"]\");\n\n        num = field.val();\n\n        // if it's not a number or the field is left empty\n        if (isNaN(num) || num.toString().indexOf(\".\") !== -1 || field.val() === \"\") {\n            return null;\n        }\n        return num;\n    }\n\n    // Loading (populating) display and form widget with\n    // passed RFC5545 string (data)\n    function loadData(form) {\n        widgetLoadFromRfc5545(form, conf, textarea[\"ical\"], true);\n\n        const startdate = findStartDate();\n\n        if (startdate !== null) {\n            // If the date is a real date, set the defaults in the form\n            document.querySelector(\"select[name=rimonthlydayofmonthday]\").value =\n                startdate.getDate();\n            const dayindex =\n                conf.orderIndexes[Math.floor((startdate.getDate() - 1) / 7)];\n            const day = conf.weekdays[startdate.getDay()];\n            document.querySelector(\"select[name=rimonthlyweekdayofmonthindex]\").value =\n                dayindex;\n            document.querySelector(\"select[name=rimonthlyweekdayofmonth]\").value = day;\n\n            document.querySelector(\"select[name=riyearlydayofmonthmonth]\").value =\n                startdate.getMonth() + 1;\n            document.querySelector(\"select[name=riyearlydayofmonthday]\").value =\n                startdate.getDate();\n            document.querySelector(\"select[name=riyearlyweekdayofmonthindex]\").value =\n                dayindex;\n            document.querySelector(\"select[name=riyearlyweekdayofmonthday]\").value = day;\n            document.querySelector(\"select[name=riyearlyweekdayofmonthmonth]\").value =\n                startdate.getMonth() + 1;\n\n            // Now when we have a start date, we can also do an ajax call to calculate occurrences:\n            var rfc5545 =\n                textarea.innerHTML ||\n                widgetSaveToRfc5545(\n                    form,\n                    textarea[\"ical\"].RDATE,\n                    textarea[\"ical\"].EXDATE,\n                    conf,\n                    false\n                ).result;\n\n            loadOccurrences(startdate, rfc5545, 0, false);\n\n            // Show the add and refresh buttons:\n            document.querySelector(\"div.rioccurrencesactions\").style.display = \"block\";\n        } else {\n            // No EXDATE/RDATE support\n            document.querySelector(\"div.rioccurrencesactions\").style.display = \"none\";\n        }\n\n        displayFields(form.find(\"select[name=rirtemplate]\"));\n    }\n\n    function recurrenceOn(form) {\n        var RFC5545 = widgetSaveToRfc5545(\n            form,\n            textarea[\"ical\"].RDATE,\n            textarea[\"ical\"].EXDATE,\n            conf,\n            false\n        );\n        var label = self.display.find(\"label[class=ridisplay-label]\");\n        label.text(conf.localization.displayActivate + \" \" + RFC5545.description);\n        textarea[\"ical\"] = parseIcal(RFC5545.result);\n        textarea.innerHTML = RFC5545.result;\n        $textarea.trigger(\"change\");\n        var startdate = findStartDate();\n        if (startdate !== null) {\n            loadOccurrences(startdate, RFC5545.result, 0, true);\n        }\n        self.display.find('a[name=\"riedit\"]').text(conf.localization.edit_rules);\n        self.display.find('a[name=\"ridelete\"]').show();\n    }\n\n    function recurrenceOff() {\n        var label = self.display.find(\"label[class=ridisplay-label]\");\n        label.text(conf.localization.displayUnactivate);\n        // reset ical object\n        textarea[\"ical\"] = {\n            RRULE: \"\",\n            RDATE: [],\n            EXDATE: [],\n        };\n        textarea.innerHTML = \"\";\n        $textarea.trigger(\"change\"); // Clear the textarea.\n        self.display.find(\".rioccurrences\").hide();\n        self.display.find('a[name=\"riedit\"]').text(conf.localization.add_rules);\n        self.display.find('a[name=\"ridelete\"]').hide();\n    }\n\n    function checkFields(form) {\n        var startDate, endDate, num, messagearea;\n        startDate = findStartDate();\n\n        // Hide any error message from before\n        messagearea = self.$modalForm.find(\"#messagearea\");\n        messagearea.text(\"\");\n        messagearea.hide();\n\n        // Hide add field errors\n        self.$modalForm.find(\".riaddoccurrence div.alert\").text(\"\").hide();\n\n        // Repeats Daily\n        if (self.$modalForm.find(\"#ridailyinterval\").css(\"display\") === \"block\") {\n            // Check repeat every field\n            num = findIntField(\"ridailyinterval\", form);\n            if (!num || num < 1 || num > 1000) {\n                messagearea.text(conf.localization.noRepeatEvery).show();\n                return false;\n            }\n        }\n\n        // Repeats Weekly\n        if (self.$modalForm.find(\"#riweeklyinterval\").css(\"display\") === \"block\") {\n            // Check repeat every field\n            num = findIntField(\"riweeklyinterval\", form);\n            if (!num || num < 1 || num > 1000) {\n                messagearea.text(conf.localization.noRepeatEvery).show();\n                return false;\n            }\n        }\n\n        // Repeats Monthly\n        if (self.$modalForm.find(\"#rimonthlyinterval\").css(\"display\") === \"block\") {\n            // Check repeat every field\n            num = findIntField(\"rimonthlyinterval\", form);\n            if (!num || num < 1 || num > 1000) {\n                messagearea.text(conf.localization.noRepeatEvery).show();\n                return false;\n            }\n\n            // Check repeat on\n            if (self.$modalForm.find(\"#rimonthlyoptions input:checked\").length === 0) {\n                messagearea.text(conf.localization.noRepeatOn).show();\n                return false;\n            }\n        }\n\n        // Repeats Yearly\n        if (self.$modalForm.find(\"#riyearlyinterval\").css(\"display\") === \"block\") {\n            // Check repeat every field\n            num = findIntField(\"riyearlyinterval\", form);\n            if (!num || num < 1 || num > 1000) {\n                messagearea.text(conf.localization.noRepeatEvery).show();\n                return false;\n            }\n\n            // Check repeat on\n            if (self.$modalForm.find(\"#riyearlyoptions input:checked\").length === 0) {\n                messagearea.text(conf.localization.noRepeatOn).show();\n                return false;\n            }\n        }\n\n        // End recurrence fields\n\n        // If after N occurences is selected, check its value\n        if (\n            self.$modalForm.find('input[value=\"BYOCCURRENCES\"]:visible:checked').length >\n            0\n        ) {\n            num = findIntField(\"rirangebyoccurrencesvalue\", form);\n            if (!num || num < 1 || num > 1000) {\n                messagearea.text(conf.localization.noEndAfterNOccurrences).show();\n                return false;\n            }\n        }\n\n        // If end date is selected, check its value\n        if (\n            self.$modalForm.find('input[value=\"BYENDDATE\"]:visible:checked').length > 0\n        ) {\n            endDate = findEndDate(form);\n            if (!endDate) {\n                // if endDate is null that means the field is empty\n                messagearea.text(conf.localization.noEndDate).show();\n                return false;\n            } else if (endDate < startDate) {\n                // the end date cannot be before start date\n                messagearea.text(conf.localization.pastEndDate).show();\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    function save(event) {\n        event.preventDefault();\n        // if no field errors, process the request\n        if (checkFields(self.$modalForm)) {\n            // close modal\n            self.modal.hide();\n            recurrenceOn(self.$modalForm);\n            self.$modalForm = null;\n        }\n    }\n\n    function cancel(event) {\n        event.preventDefault();\n        // close modal\n        self.modal.hide();\n        self.$modalForm = null;\n    }\n\n    function updateOccurrences() {\n        var startDate;\n        startDate = findStartDate();\n\n        // if no field errors, process the request\n        if (checkFields(form)) {\n            loadOccurrences(\n                startDate,\n                widgetSaveToRfc5545(\n                    self.$modalForm,\n                    textarea[\"ical\"].RDATE,\n                    textarea[\"ical\"].EXDATE,\n                    conf,\n                    false\n                ).result,\n                0,\n                false\n            );\n        }\n    }\n\n    function initModalForm() {\n        var enddate = self.$modalForm.find(\"input[name=rirangebyenddatecalendar]\");\n        if (!enddate.val()) {\n            var start_date = findStartDate();\n            start_date.setDate(start_date.getDate() + 1);\n            enddate.val(start_date.toISOString().substring(0, 10));\n        }\n\n        self.$modalForm.find(\"input#addaction\").on(\"click\", occurrenceAdd);\n\n        // When selecting template, update what fieldsets are visible and the occurrences.\n        self.$modalForm.find('select[name=\"rirtemplate\"]').on(\"change\", function () {\n            displayFields($(this));\n            updateOccurrences();\n        });\n\n        // Update the selected dates section\n        self.$modalForm\n            .find(\n                `\n                input:radio,\n                input:checkbox,\n                .riweeklyweekday > input,\n                input[name=ridailyinterval],\n                input[name=riweeklyinterval],\n                input[name=rimonthlyinterval],\n                input[name=riyearlyinterval],\n                input[name=rirangebyoccurrencesvalue],\n                input[name=rirangebyenddatecalendar],\n                #rimonthlyoptions select,\n                #riyearlyoptions select,\n                #riyearlyinterval select`\n            )\n            .on(\"change\", function () {\n                // Update only if the occurances are shown\n                if (self.$modalForm.find(\".rioccurrencesactions:visible\").length !== 0) {\n                    updateOccurrences();\n                }\n            });\n\n        // initialize occurrence adddate value\n        self.$modalForm.find(\"div.riaddoccurrence input#adddate\").val(now_date);\n\n        /*\n        Save and cancel methods:\n        */\n        self.$modalForm.find(\".ricancelbutton\").on(\"click\", cancel);\n        self.$modalForm.find(\".risavebutton\").on(\"click\", save);\n    }\n\n    /*\n      Load the templates\n    */\n\n    self.display = $(_.template(DisplayTemplate)(conf));\n    var form = $(_.template(FormTemplate)(conf));\n\n    form.appendTo(\"body\");\n    form.hide();\n\n    // Make an modal and hide it\n    self.modal = new Modal(form, {\n        content: \"div.riform\",\n        buttons: \".ributtons > button\",\n        modalSizeClass: \"modal-lg\",\n        backdropOptions: {\n            opacity: \"0.5\",\n        },\n    });\n\n    if (textarea.innerHTML) {\n        var result = widgetLoadFromRfc5545(form, conf, textarea[\"ical\"], false);\n        if (result === -1) {\n            var label = self.display.find(\"label[class=ridisplay-label]\");\n            label.text(conf.localization.noRule);\n        } else {\n            recurrenceOn(form);\n        }\n    }\n\n    /*\n      Do all the GUI stuff:\n    */\n\n    // When you click \"Delete...\", the recurrence rules should be cleared.\n    self.display.find('a[name=\"ridelete\"]').on(\"click\", function (e) {\n        e.preventDefault();\n        recurrenceOff();\n    });\n\n    // Show form modal when you click on the \"Edit...\" link\n    self.display.find('a[name=\"riedit\"]').on(\"click\", function (e) {\n        // Load the form to set up the right fields to show, etc.\n        e.preventDefault();\n        self.modal.show();\n        self.$modalForm = $(\"form\", self.modal.$modalContent);\n        loadData(self.$modalForm);\n        initModalForm();\n    });\n};\n\nexport default Base.extend({\n    name: \"recurrence\",\n    trigger: \".pat-recurrence\",\n    parser: \"mockup\",\n    defaults: {\n        localization: {\n            displayUnactivate: \"Does not repeat\",\n            displayActivate: \"Repeats every\",\n            add_rules: \"Add\",\n            edit_rules: \"Edit\",\n            delete_rules: \"Delete\",\n            add: \"Add\",\n            refresh: \"Refresh\",\n\n            title: \"Repeat\",\n            preview: \"Selected dates\",\n            addDate: \"Add date\",\n\n            recurrenceType: \"Repeats:\",\n\n            dailyInterval1: \"Repeat every:\",\n            dailyInterval2: \"days\",\n\n            weeklyInterval1: \"Repeat every:\",\n            weeklyInterval2: \"week(s)\",\n            weeklyWeekdays: \"Repeat on:\",\n            weeklyWeekdaysHuman: \"on:\",\n\n            monthlyInterval1: \"Repeat every:\",\n            monthlyInterval2: \"month(s)\",\n            monthlyDayOfMonth1: \"Day\",\n            monthlyDayOfMonth1Human: \"on day\",\n            monthlyDayOfMonth2: \"of the month\",\n            monthlyDayOfMonth3: \"month(s)\",\n            monthlyWeekdayOfMonth1: \"The\",\n            monthlyWeekdayOfMonth1Human: \"on the\",\n            monthlyWeekdayOfMonth2: \"\",\n            monthlyWeekdayOfMonth3: \"of the month\",\n            monthlyRepeatOn: \"Repeat on:\",\n\n            yearlyInterval1: \"Repeat every:\",\n            yearlyInterval2: \"year(s)\",\n            yearlyDayOfMonth1: \"Every\",\n            yearlyDayOfMonth1Human: \"on\",\n            yearlyDayOfMonth2: \"\",\n            yearlyDayOfMonth3: \"\",\n            yearlyWeekdayOfMonth1: \"The\",\n            yearlyWeekdayOfMonth1Human: \"on the\",\n            yearlyWeekdayOfMonth2: \"\",\n            yearlyWeekdayOfMonth3: \"of\",\n            yearlyWeekdayOfMonth4: \"\",\n            yearlyRepeatOn: \"Repeat on:\",\n\n            range: \"End recurrence:\",\n            rangeNoEnd: \"Never\",\n            rangeByOccurrences1: \"After\",\n            rangeByOccurrences1Human: \"ends after\",\n            rangeByOccurrences2: \"occurrence(s)\",\n            rangeByEndDate: \"On\",\n            rangeByEndDateHuman: \"ends on\",\n\n            including: \", and also\",\n            except: \", except for\",\n\n            cancel: \"Cancel\",\n            save: \"Save\",\n\n            recurrenceStart: \"Start of the recurrence\",\n            additionalDate: \"Additional date\",\n            include: \"Include\",\n            exclude: \"Exclude\",\n            remove: \"Remove\",\n\n            orderIndexes: [\"first\", \"second\", \"third\", \"fourth\", \"last\"],\n            months: [\n                \"January\",\n                \"February\",\n                \"March\",\n                \"April\",\n                \"May\",\n                \"June\",\n                \"July\",\n                \"August\",\n                \"September\",\n                \"October\",\n                \"November\",\n                \"December\",\n            ],\n            shortMonths: [\n                \"Jan\",\n                \"Feb\",\n                \"Mar\",\n                \"Apr\",\n                \"May\",\n                \"Jun\",\n                \"Jul\",\n                \"Aug\",\n                \"Sep\",\n                \"Oct\",\n                \"Nov\",\n                \"Dec\",\n            ],\n            weekdays: [\n                \"Sunday\",\n                \"Monday\",\n                \"Tuesday\",\n                \"Wednesday\",\n                \"Thursday\",\n                \"Friday\",\n                \"Saturday\",\n            ],\n            shortWeekdays: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n\n            longDateFormat: \"mmmm dd, yyyy\",\n            shortDateFormat: \"mm/dd/yyyy\",\n\n            unsupportedFeatures:\n                \"Warning: This event uses recurrence features not \" +\n                \"supported by this widget. Saving the recurrence \" +\n                \"may change the recurrence in unintended ways:\",\n            noTemplateMatch: \"No matching recurrence template\",\n            multipleDayOfMonth:\n                \"This widget does not support multiple days in monthly or yearly recurrence\",\n            bysetpos: \"BYSETPOS is not supported\",\n            noRule: \"No RRULE in RRULE data\",\n            noRepeatEvery: 'Error: The \"Repeat every\"-field must be between 1 and 1000',\n            noEndDate: \"Error: End date is not set. Please set a correct value\",\n            noRepeatOn: 'Error: \"Repeat on\"-value must be selected',\n            pastEndDate: \"Error: End date cannot be before start date\",\n            noEndAfterNOccurrences:\n                'Error: The \"After N occurrences\"-field must be between 1 and 1000',\n            alreadyAdded: \"This date was already added\",\n\n            rtemplate: {\n                daily: \"Daily\",\n                mondayfriday: \"Monday and Friday\",\n                weekdays: \"Weekday\",\n                weekly: \"Weekly\",\n                monthly: \"Monthly\",\n                yearly: \"Yearly\",\n            },\n        },\n\n        readOnly: false,\n        firstDay: 0,\n\n        // \"REMOTE\" FIELD\n        startField: null,\n        startFieldYear: null,\n        startFieldMonth: null,\n        startFieldDay: null,\n        ajaxURL: null,\n        ajaxContentType: \"application/json; charset=utf8\",\n        ributtonExtraClass: \"\",\n\n        // INPUT CONFIGURATION\n        hasRepeatForeverButton: true,\n\n        // JQUERY TEMPLATE NAMES\n        template: {\n            form: \"#jquery-recurrenceinput-form-tmpl\",\n            display: \"#jquery-recurrenceinput-display-tmpl\",\n        },\n\n        // RECURRENCE TEMPLATES\n        rtemplate: {\n            daily: {\n                rrule: \"FREQ=DAILY\",\n                fields: [\"ridailyinterval\", \"rirangeoptions\"],\n            },\n            mondayfriday: {\n                rrule: \"FREQ=WEEKLY;BYDAY=MO,FR\",\n                fields: [\"rirangeoptions\"],\n            },\n            weekdays: {\n                rrule: \"FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR\",\n                fields: [\"rirangeoptions\"],\n            },\n            weekly: {\n                rrule: \"FREQ=WEEKLY\",\n                fields: [\"riweeklyinterval\", \"riweeklyweekdays\", \"rirangeoptions\"],\n            },\n            monthly: {\n                rrule: \"FREQ=MONTHLY\",\n                fields: [\"rimonthlyinterval\", \"rimonthlyoptions\", \"rirangeoptions\"],\n            },\n            yearly: {\n                rrule: \"FREQ=YEARLY\",\n                fields: [\"riyearlyinterval\", \"riyearlyoptions\", \"rirangeoptions\"],\n            },\n        },\n    },\n\n    load_icons: async function () {\n        return {\n            reload: await utils.resolveIcon(\"arrow-clockwise\"),\n            remove: await utils.resolveIcon(\"trash\"),\n            exclude: await utils.resolveIcon(\"calendar-x\"),\n            include: await utils.resolveIcon(\"plus-circle\"),\n        };\n    },\n\n    init: async function () {\n        // tmpl BEFORE recurrenceinput\n        import(\"./recurrence.scss\");\n\n        this.el.classList.add(\"recurrence-widget\");\n        var icons = await this.load_icons();\n\n        var config = {\n            ...this.options,\n            ...this.options.configuration,\n            icons: icons,\n        };\n\n        // our recurrenceinput widget instance\n        var recurrenceinput = new RecurrenceInput(config, this.el);\n        // hide textarea and place display widget after textarea\n        this.$el.after(recurrenceinput.display);\n\n        // hide the textarea\n        this.el.style.display = \"none\";\n    },\n});\n","/* Utilities for DOM traversal or navigation */\nimport events from \"./events\";\nimport logging from \"./logging\";\nimport create_uuid from \"./uuid\";\n\nconst logger = logging.getLogger(\"core dom\");\n\nconst DATA_PREFIX = \"__patternslib__data_prefix__\";\nconst DATA_STYLE_DISPLAY = \"__patternslib__style__display\";\n\nconst INPUT_SELECTOR = \"input, select, textarea, button\";\n\n/**\n * Wait for the document to be ready.\n *\n * @param {Function} fn - The function to call when the document is ready.\n */\nconst document_ready = (fn) => {\n    const event_id = create_uuid();\n\n    const _ready = () => {\n        if (document.readyState !== \"loading\") {\n            // Remove the event listener for this callback.\n            events.remove_event_listener(document, event_id);\n            // call on next available tick\n            setTimeout(fn, 1);\n        }\n    };\n\n    // Listen for the document to be ready and call _ready() when it is.\n    events.add_event_listener(document, \"readystatechange\", event_id, _ready);\n\n    // Also check the ready state immediately in case we missed the event.\n    _ready();\n};\n\n/**\n * Return an array of DOM nodes.\n *\n * @param {Node|NodeList|jQuery} nodes - The DOM node to start the search from.\n *\n * @returns {Array} - An array of DOM nodes.\n */\nconst toNodeArray = (nodes) => {\n    if (nodes.jquery || nodes instanceof NodeList) {\n        // jQuery or document.querySelectorAll\n        nodes = [...nodes];\n    } else if (nodes instanceof Array === false) {\n        nodes = [nodes];\n    }\n    return nodes;\n};\n\n/**\n * Like querySelectorAll but including the element where it starts from.\n * Returns an Array, not a NodeList\n *\n * @param {Node} el - The DOM node to start the search from.\n *\n * @returns {Array} - The DOM nodes found.\n */\nconst querySelectorAllAndMe = (el, selector) => {\n    if (!el || !el.querySelectorAll) {\n        return [];\n    }\n\n    const all = [...el.querySelectorAll(selector)];\n    if (el.matches(selector)) {\n        all.unshift(el); // start element should be first.\n    }\n    return all;\n};\n\n/**\n * Wrap a element with a wrapper element.\n *\n * The element to be wrapped will be moved into the wrapper element and the\n * wrapper element is placed just before the old element was.\n *\n * @param {Node} el - The DOM node to wrap.\n * @param {Node} wrapper - The wrapper element.\n */\nconst wrap = (el, wrapper) => {\n    // See: https://stackoverflow.com/a/13169465/1337474\n    el.parentNode.insertBefore(wrapper, el);\n    wrapper.appendChild(el);\n};\n\n/**\n * Hides the element with ``display: none`` and stores the current display value.\n *\n * @param {Node} el - The DOM node to hide.\n */\nconst hide = (el) => {\n    if (el.style.display === \"none\") {\n        // Nothing to do.\n        return;\n    }\n    if (el.style.display) {\n        el[DATA_STYLE_DISPLAY] = el.style.display;\n    }\n    el.style.display = \"none\";\n};\n\n/**\n * Shows element by removing ``display: none`` and restoring the display value\n * to whatever it was before.\n *\n * @param {Node} el - The DOM node to show.\n */\nconst show = (el) => {\n    const val = el[DATA_STYLE_DISPLAY] || null;\n    el.style.display = val;\n    delete el[DATA_STYLE_DISPLAY];\n};\n\n/**\n * Test, if a element is visible or not.\n *\n * @param {Node} el - The DOM node to test.\n * @returns {Boolean} - True if the element is visible.\n */\nconst is_visible = (el) => {\n    // Check, if element is visible in DOM.\n    // https://stackoverflow.com/a/19808107/1337474\n    return el.offsetWidth > 0 && el.offsetHeight > 0;\n};\n\n/**\n * Test, if a element is a input-type element.\n *\n * This is taken from Sizzle/jQuery at:\n * https://github.com/jquery/sizzle/blob/f2a2412e5e8a5d9edf168ae3b6633ac8e6bd9f2e/src/sizzle.js#L139\n * https://github.com/jquery/sizzle/blob/f2a2412e5e8a5d9edf168ae3b6633ac8e6bd9f2e/src/sizzle.js#L1773\n *\n * @param {Node} el - The DOM node to test.\n * @returns {Boolean} - True if the element is a input-type element.\n */\nconst is_input = (el) => {\n    const re_input = /^(?:input|select|textarea|button)$/i;\n    return re_input.test(el.nodeName);\n};\n\n/**\n * Test, if a element is a button-like input type.\n *\n * @param {Node} el - The DOM node to test.\n * @returns {Boolean} - True if the element is a input-type element.\n */\nconst is_button = (el) => {\n    return el.matches(`\n        button,\n        input[type=image],\n        input[type=button],\n        input[type=reset],\n        input[type=submit]\n    `);\n};\n\n\n\n/**\n * Return all direct parents of ``el`` matching ``selector``.\n * This matches against all parents but not the element itself.\n * The order of elements is from the search starting point up to higher\n * DOM levels.\n *\n * @param {Node} el - The DOM node to start the search from.\n * @param {String} selector - CSS selector to match against.\n * @returns {Array} - List of matching DOM nodes.\n */\nconst find_parents = (el, selector) => {\n    const ret = [];\n    let parent = el;\n    while (parent) {\n        parent = parent.parentNode?.closest?.(selector);\n        if (parent) ret.push(parent);\n    }\n    return ret;\n};\n\n/**\n * Find an element in the whole DOM tree if the selector is an ID selector,\n * otherwise use the given element as the starting point.\n *\n * @param {Node} el - The DOM node to start the search from.\n * @param {String} selector - The CSS selector to search for.\n *\n * @returns {NodeList} - The DOM nodes found.\n *\n */\nconst find_scoped = (el, selector) => {\n    // If the selector starts with an object id do a global search,\n    // otherwise do a local search.\n    return (selector.indexOf(\"#\") === 0 ? document : el).querySelectorAll(selector);\n};\n\n/**\n * Return all HTMLElement parents of el, starting from the direct parent of el.\n * The document itself is excluded because it's not a real DOM node.\n *\n * @param {Node} el - The DOM node to start the search from.\n *\n * @returns {Array} - The DOM nodes found.\n */\nconst get_parents = (el) => {\n    // Return all HTMLElement parents of el, starting from the direct parent of el.\n    const parents = [];\n    let parent = el?.parentNode;\n    while (parent) {\n        parents.push(parent);\n        parent = parent?.parentNode;\n        parent = parent instanceof HTMLElement ? parent : null;\n    }\n    return parents;\n};\n\n/**\n * Return the value of the first attribute found in the list of parents.\n *\n * @param {Node} el - The DOM element to start the acquisition search for the given attribute.\n * @param {string} attribute - Name of the attribute to search for.\n * @param {Boolean} include_empty - Also return empty values.\n * @param {Boolean} include_all - Return a list of attribute values found in all parents.\n *\n * @returns {*} - Returns the value of the searched attribute or a list of all attributes.\n */\nconst acquire_attribute = (\n    el,\n    attribute,\n    include_empty = false,\n    include_all = false\n) => {\n    let _el = el;\n    const ret = []; // array for ``include_all`` mode.\n    while (_el) {\n        const val = _el.getAttribute(attribute);\n        if (val || (include_empty && val === \"\")) {\n            if (!include_all) {\n                return val;\n            }\n            ret.push(val);\n        }\n        _el = _el.parentElement;\n    }\n    if (include_all) {\n        return ret;\n    }\n};\n\n/**\n * Return a DocumentFragment from a given string.\n *\n * @param {String} string - The HTML structure as a string.\n *\n * @returns {DocumentFragment} - The DOM nodes as a DocumentFragment.\n */\nconst create_from_string = (string) => {\n    // See: https://davidwalsh.name/convert-html-stings-dom-nodes\n    return document.createRange().createContextualFragment(string.trim());\n};\n\n/**\n * Return a CSS property value for a given DOM node.\n * For length-values, relative values are converted to pixels.\n * Optionally parse as pixels, if applicable.\n *\n * Note: The element must be attached to the body to make CSS caluclations work.\n *\n * @param {Node} el - DOM node.\n * @param {String} property - CSS property to query on DOM node.\n * @param {Boolean} [as_pixels=false] - Convert value to pixels, if applicable.\n * @param {Boolean} [as_float=false] - Convert value to float, if applicable.\n *\n * @returns {(String|Number)} - The CSS value to return.\n */\nfunction get_css_value(el, property, as_pixels = false, as_float = false) {\n    let value = window.getComputedStyle(el).getPropertyValue(property);\n    if (as_pixels || as_float) {\n        value = parseFloat(value) || 0.0;\n    }\n    if (as_pixels && !as_float) {\n        value = parseInt(Math.round(value), 10);\n    }\n    return value;\n}\n\n/**\n * Find a scrollable element up in the DOM tree.\n *\n * Note: Setting the ``overflow`` shorthand property also sets the individual overflow-y and overflow-y properties.\n *\n * @param {Node} el - The DOM element to start the search on.\n * @param {String} [direction=] - Not given: Search for any scrollable element up in the DOM tree.\n *                                ``x``: Search for a horizontally scrollable element.\n *                                ``y``: Search for a vertically scrollable element.\n * @param {(Node|null)} [fallback=document.body] - Fallback, if no scroll container can be found.\n *                                                     The default is to use document.body.\n *\n * @returns {Node} - Return the first scrollable element.\n *                   If no other element could be found, document.body would be returned.\n */\nconst find_scroll_container = (el, direction, fallback = document.body) => {\n    while (el && el !== document.body) {\n        if (!direction || direction === \"y\") {\n            let overflow_y = get_css_value(el, \"overflow-y\");\n            if ([\"auto\", \"scroll\"].includes(overflow_y)) {\n                return el;\n            }\n        }\n        if (!direction || direction === \"x\") {\n            let overflow_x = get_css_value(el, \"overflow-x\");\n            if ([\"auto\", \"scroll\"].includes(overflow_x)) {\n                return el;\n            }\n        }\n        el = el.parentElement;\n    }\n    return fallback;\n};\n\n/**\n * Get the horizontal scroll position.\n *\n * @param {Node} scroll_reference - The element to get the scroll position from.\n *\n * @returns {number} The horizontal scroll position.\n */\nconst get_scroll_x = (scroll_reference) => {\n    // scroll_listener == window: window.scrollX\n    // scroll_listener == html: html.scrollLeft == window.scrollX\n    // scroll_listener == DOM node: node.scrollLeft\n    return typeof scroll_reference.scrollLeft !== \"undefined\"\n        ? scroll_reference.scrollLeft\n        : scroll_reference.scrollX;\n};\n\n/**\n * Get the vertical scroll position.\n *\n * @param {Node} scroll_reference - The element to get the scroll position from.\n *\n * @returns {number} The vertical scroll position.\n */\nconst get_scroll_y = (scroll_reference) => {\n    // scroll_listener == window: window.scrollY\n    // scroll_listener == html: html.scrollTop == window.scrollY\n    // scroll_listener == DOM node: node.scrollTop\n    return typeof scroll_reference.scrollTop !== \"undefined\"\n        ? scroll_reference.scrollTop\n        : scroll_reference.scrollY;\n};\n\n/**\n * Get the elements position relative to another element.\n *\n * @param {Node} el - The DOM element to get the position for.\n * @param {Node} [reference_el=document.body] - The DOM element to get the position relative to.\n *\n * @returns {{top: number, left: number}} - The position of the element relative to the other element.\n */\nconst get_relative_position = (el, reference_el = document.body) => {\n    // Get the reference element to which against we calculate\n    // the relative position of the target.\n    // In case of a scroll container of window, we do not have\n    // getBoundingClientRect method, so get the body instead.\n    if (reference_el === window) {\n        reference_el = document.body;\n    }\n\n    // Calculate absolute [¹] position difference between\n    // scroll_container and scroll_target.\n    // Substract the container's border from the scrolling\n    // value, as this one isn't respected by\n    // getBoundingClientRect [²] and would lead to covered\n    // items [³].\n    // ¹) so that it doesn't make a difference, if the element\n    // is below or above the scrolling container. We just need\n    // to know the absolute difference.\n    // ²) Calculations are based from the viewport.\n    // ³) See:\n    //      https://docs.microsoft.com/en-us/previous-versions//hh781509(v=vs.85)\n    //      https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect\n    const left = Math.abs(\n        el.getBoundingClientRect().left +\n            reference_el.scrollLeft -\n            reference_el.getBoundingClientRect().left -\n            dom.get_css_value(reference_el, \"border-left-width\", true)\n    );\n    const top = Math.abs(\n        el.getBoundingClientRect().top +\n            reference_el.scrollTop -\n            reference_el.getBoundingClientRect().top -\n            dom.get_css_value(reference_el, \"border-top-width\", true)\n    );\n\n    return { top, left };\n};\n\n/**\n * Scroll to a given element.\n * The element will be scrolled to the top of the scroll container.\n *\n * @param {Node} el - The element which should be scrolled to.\n * @param {Node} scroll_container - The element which is scrollable.\n * @param {number} [offset=0] - Optional offset in pixels to stop scrolling before the target position. Can also be a negative number.\n * @param {string} [direction=\"top\"] - The direction to scroll to. Can be either \"top\", \"left\" or \"both\".\n */\nconst scroll_to_element = (el, scroll_container, offset = 0, direction = \"top\") => {\n    // Get the position of the element relative to the scroll container.\n    const position = get_relative_position(el, scroll_container);\n\n    const options = { behavior: \"auto\" };\n    if (direction === \"top\" || direction === \"both\") {\n        options.top = position.top - offset;\n    }\n    if (direction === \"left\" || direction === \"both\") {\n        options.left = position.left - offset;\n    }\n\n    // Scroll to the target position.\n    scroll_container.scrollTo(options);\n};\n\n/**\n * Scroll to the top of a scrolling container.\n *\n * @param {Node} [scroll_container = document.body] - The element which is scrollable.\n * @param {number} [offset=0] - Optional offset in pixels to stop scrolling before the target position. Can also be a negative number.\n */\nconst scroll_to_top = (scroll_container = document.body, offset = 0) => {\n    // Just scroll up, period.\n    scroll_container.scrollTo({ top: 0 - offset, behavior: \"auto\" });\n};\n\n/**\n * Scroll to the bottom of a scrolling container.\n *\n * @param {Node} [scroll_container = document.body] - The element which is scrollable.\n * @param {number} [offset=0] - Optional offset in pixels to stop scrolling before the target position. Can also be a negative number.\n */\nconst scroll_to_bottom = (scroll_container = document.body, offset = 0) => {\n    // Just scroll up, period.\n    //\n    const top = (scroll_container === window ? document.body : scroll_container)\n        .scrollHeight;\n    scroll_container.scrollTo({ top: top - offset, behavior: \"auto\" });\n};\n\n/**\n * Get data stored directly on the node instance.\n * We are using a prefix to make sure the data doesn't collide with other attributes.\n *\n * @param el {Node} - The DOM node from which we want to retrieve the data.\n * @param name {String} - The name of the variable. Note - this is stored on\n *                        the DOM node prefixed with the DATA_PREFIX.\n * @param default_value {Any} - Optional default value.\n * @returns {Any} - The value which is stored on the DOM node.\n */\nconst get_data = (el, name, default_value) => {\n    return el[`${DATA_PREFIX}${name}`] || default_value;\n};\n\n/**\n * Set and store data directly on the node instance.\n * We are using a prefix to make sure the data doesn't collide with other attributes.\n *\n * @param el {Node} - The DOM node which we want to store the data on.\n * @param name {String} - The name of the variable. Note - this is stored on\n *                        the DOM node prefixed with the DATA_PREFIX.\n * @param value {Any} - The value we want to store on the DOM node.\n */\nconst set_data = (el, name, value) => {\n    el[`${DATA_PREFIX}${name}`] = value;\n};\n\n/**\n * Delete a variable from the node instance.\n * We are using a prefix to make sure the data doesn't collide with other attributes.\n *\n * @param el {Node} - The DOM node which we want to delete the variable from.\n * @param name {String} - The name of the variable. Note - this is stored on\n *                        the DOM node prefixed with the DATA_PREFIX.\n */\nconst delete_data = (el, name) => {\n    delete el[`${DATA_PREFIX}${name}`];\n};\n\n/**\n * Simple template engine, based on JS template literal\n *\n * NOTE: This uses eval and would break if Content-Security-Policy does not\n *       allow 'unsafe-eval'.\n *       Because of this CSR problem the use of this method is not recommended.\n *\n * Please note: You cannot pass a template literal as template_string.\n * JavaScript itself would try to expand it and would fail.\n *\n * See: https://stackoverflow.com/a/37217166/1337474\n *\n * @param {String} template_string - The template string as a JavaScript template literal.\n *                                   For each variable in the template you have to use ``this``.\n *                                   E.g. if you pass ``{message: \"ok\"}`` as template_variables, you can use it like so:\n *                                   `<h1>${this.message}</h1>`\n * @param {Object} template_variables - Object literal with all the variables which should be used in the template.\n *\n * @returns {String} - Returns the a string as template expanded with the template_variables.\n */\nconst template = (template_string, template_variables = {}) => {\n    logger.warn(\n        \"Using dom.template is not recommended due to a problem with Content-Security-Policy.\"\n    );\n    return new Function(\"return `\" + template_string + \"`;\").call(template_variables);\n};\n\n/**\n * Get the visible ratio of an element compared to container.\n * If no container is given, the viewport is used.\n *\n * Note: currently only vertical ratio is supported.\n *\n * @param {Node} el - The element to get the visible ratio from.\n * @param {Node} [container] - The container to compare the element to.\n * @returns {number} - The visible ratio of the element.\n *                    0 means the element is not visible.\n *                    1 means the element is fully visible.\n */\nconst get_visible_ratio = (el, container) => {\n    if (!el) {\n        return 0;\n    }\n\n    const rect = el.getBoundingClientRect();\n    const container_rect =\n        container !== window\n            ? container.getBoundingClientRect()\n            : {\n                  top: 0,\n                  bottom: window.innerHeight,\n              };\n\n    let visible_ratio = 0;\n    if (rect.top < container_rect.bottom && rect.bottom > container_rect.top) {\n        const rect_height = rect.bottom - rect.top;\n        const visible_height =\n            Math.min(rect.bottom, container_rect.bottom) -\n            Math.max(rect.top, container_rect.top);\n        visible_ratio = visible_height / rect_height;\n    }\n\n    return visible_ratio;\n};\n\n/**\n * Get an escaped CSS selector for a given id string.\n *\n * id selectors should - but don't have to - start with a letter.\n * If the id starts with a number or a dash, it should be escaped.\n * This method does that for you.\n *\n * Alse see:\n * - https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/id\n * - https://developer.mozilla.org/en-US/docs/Web/API/CSS/escape\n *\n * @param {String} id - The id to escape.\n *\n * @returns {String} - The escaped CSS selector.\n *\n * @example\n * escape_css_id_selector(\"#123\"); // returns \"#\\\\31 23\"\"\n * escape_css_id_selector(\"#-123\"); // returns \"#-\\\\31 23\"\n */\nconst escape_css_id = (id) => {\n    return `#${CSS.escape(id.split(\"#\")[1])}`;\n};\n\n/**\n * Set and get a universally unique id (uuid) for a DOM element.\n *\n * This method returns a uuid for the given element. On the first call it will\n * generate a uuid and store it on the element.\n *\n * @param {Node} el - The DOM node to get the uuid for.\n * @returns {String} - The uuid.\n */\nconst element_uuid = (el) => {\n    if (!get_data(el, \"uuid\", false)) {\n        set_data(el, \"uuid\", create_uuid());\n    }\n    return get_data(el, \"uuid\");\n};\n\n/**\n * Find a related form element.\n *\n * @param {Node} el - The DOM node to start the search from.\n * @returns {Node} - The closest form element.\n *\n * @example\n * find_form(document.querySelector(\"input\"));\n */\nconst find_form = (el) => {\n    // Prefer input.form which allows for input outside form elements and fall\n    // back to search for a parent form.\n    const form =\n        el.closest(\".pat-subform\") || // Special Patternslib subform concept has precedence.\n        el.form ||\n        el.querySelector(INPUT_SELECTOR)?.form ||\n        el.closest(\"form\");\n    return form;\n};\n\n/**\n * Find any input type.\n */\nconst find_inputs = (el) => {\n    return querySelectorAllAndMe(el, INPUT_SELECTOR);\n};\n\nconst dom = {\n    document_ready: document_ready,\n    toNodeArray: toNodeArray,\n    querySelectorAllAndMe: querySelectorAllAndMe,\n    wrap: wrap,\n    hide: hide,\n    show: show,\n    find_inputs: find_inputs,\n    find_parents: find_parents,\n    find_scoped: find_scoped,\n    get_parents: get_parents,\n    acquire_attribute: acquire_attribute,\n    is_visible: is_visible,\n    is_input: is_input,\n    is_button: is_button,\n    create_from_string: create_from_string,\n    get_css_value: get_css_value,\n    find_scroll_container: find_scroll_container,\n    get_scroll_x: get_scroll_x,\n    get_scroll_y: get_scroll_y,\n    get_relative_position: get_relative_position,\n    scroll_to_element: scroll_to_element,\n    scroll_to_top: scroll_to_top,\n    scroll_to_bottom: scroll_to_bottom,\n    get_data: get_data,\n    set_data: set_data,\n    delete_data: delete_data,\n    template: template,\n    get_visible_ratio: get_visible_ratio,\n    escape_css_id: escape_css_id,\n    element_uuid: element_uuid,\n    find_form: find_form,\n};\n\nexport default dom;\n","import $ from \"jquery\";\nimport Modal from \"../modal/modal\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport logger from \"@patternslib/patternslib/src/core/logging\";\nimport utils from \"../../core/utils\";\nimport _t from \"../../core/i18n-wrapper\";\n\nconst log = logger.getLogger(\"pat-manage-portlets\");\n\nexport default Base.extend({\n    name: \"manage-portlets\",\n    trigger: \".pat-manage-portlets\",\n    parser: \"mockup\",\n    messageTimeout: 0,\n    submitTimeout: 0,\n    switchTimeout: 0,\n    isModal: false,\n    dirty: false,\n    init: async function () {\n        (await import(\"jquery-form\")).default;\n        var that = this;\n        var $modal = that.$el.parents(\".plone-modal\");\n        if ($modal.length === 1) {\n            this.isModal = true;\n            /* want to do something on exit from modal now */\n            var modal = $modal.data(\"pattern-plone-modal\");\n            modal.on(\"hide\", function () {\n                if (that.dirty) {\n                    window.location.reload();\n                }\n            });\n            that.loading = modal.loading;\n        } else {\n            that.loading = utils.loading;\n        }\n        that.bind();\n    },\n    bind: function () {\n        var that = this;\n        that.setupAddDropdown();\n        that.setupSwitchPortletManager();\n        that.setupSavePortletsSettings();\n        that.setupPortletEdit();\n        if (that.isModal) {\n            /* if we're in a modal, it's possible we have a link to\n            parent case, bind the link so we can reload modal */\n            $(\".portlets-link-to-parent\")\n                .off(\"click\")\n                .on(\"click\", function (e) {\n                    that.loading.show();\n                    var $el = $(this);\n                    e.preventDefault();\n                    $.ajax({\n                        url: $el.attr(\"href\"),\n                        data: {\n                            ajax_load: 1,\n                        },\n                    }).done(function (html) {\n                        var $body = $(utils.parseBodyTag(html));\n                        var $modal = $el.parents(\".plone-modal-body\");\n                        $modal.empty();\n                        var $content = $(\"#content\", $body);\n                        var $h1 = $(\"h1\", $content);\n                        $(\".plone-modal-header\", $modal.parent())\n                            .find(\"h2\")\n                            .html($h1.html());\n                        $h1.remove();\n                        $modal.append($content);\n                        that.rebind($(\".pat-manage-portlets\", $content), true);\n                        that.loading.hide();\n                    });\n                });\n        }\n    },\n    rebind: function ($el, suppress) {\n        log.info(\"rebind\");\n        if ($.contains(document, this.$el[0])) {\n            // $el is not detached, replace it\n            this.$el.replaceWith($el);\n        }\n        this.$el = $el;\n        this.bind();\n        if (!suppress) {\n            this.statusMessage();\n        }\n        this.dirty = true;\n    },\n    statusMessage: function (msg) {\n        if (msg === undefined) {\n            msg = _t(\"Portlet changes saved\");\n        }\n        var that = this;\n\n        var $message = $(\"#portlet-message\");\n        if ($message.length === 0) {\n            $message = $(\n                '<div class=\"alert alert-info\" role=\"alert\" id=\"portlet-message\" style=\"opacity: 0\"></div>'\n            );\n            if (that.isModal) {\n                $(\".plone-modal-body:visible\").prepend($message);\n            } else {\n                $(\"#content-core\").prepend($message);\n            }\n        }\n        $message.html('<strong class=\"mr-1\">' + _t(\"Info\") + \"</strong>\" + msg);\n        clearTimeout(that.messageTimeout);\n        $message.fadeTo(500, 1);\n        that.messageTimeout = window.setTimeout(function () {\n            $message.fadeTo(500, 0.6);\n        }, 3000);\n    },\n    showEditPortlet: function (url) {\n        log.info(\"show edit portlet in modal\");\n        var that = this;\n        var $a = $(\"<a/>\");\n        $(\"body\").append($a);\n        var pattern = new Modal($a, {\n            ajaxUrl: url,\n            actionOptions: {\n                displayInModal: false,\n                reloadWindowOnClose: false,\n                isForm: true,\n                onSuccess: function (modal, html) {\n                    pattern.hide();\n                    var $body = $(utils.parseBodyTag(html));\n                    that.rebind($(\"#\" + that.$el.attr(\"id\"), $body).eq(0));\n                    that.statusMessage(_t(\"Portlet added\"));\n                },\n            },\n        });\n        pattern.on(\"after-render\", function () {\n            var $el = $(\"#\" + that.$el.attr(\"id\"), pattern.$raw);\n            /* this is a check that the add form doesn't just automatically\n            create the portlet without an actual form.\n            If element is found here, we can short circuit and\n            continue on. */\n            if ($el.length === 1) {\n                /* hacky, trying to prevent modal parts from flickering here */\n                $el = $el.clone();\n                pattern.on(\"shown\", function () {\n                    pattern.hide();\n                });\n                that.rebind($el);\n                that.statusMessage(_t(\"Portlet added\"));\n            }\n        });\n        pattern.show();\n    },\n    setupPortletEdit: function () {\n        var that = this;\n        $(\".managedPortlet .portletHeader > a\", that.$el).on(\"click\", function (e) {\n            e.preventDefault();\n            that.showEditPortlet($(this).attr(\"href\"));\n        });\n    },\n    setupAddDropdown: function () {\n        var that = this;\n        $(\".add-portlet\", that.$el).on(\"change\", function (e) {\n            e.preventDefault();\n            var $select = $(this);\n            var $form = $select.parents(\"form\");\n            var contextUrl = $select.attr(\"data-context-url\");\n            var url =\n                contextUrl +\n                $select.val() +\n                \"?_authenticator=\" +\n                $('[name=\"_authenticator\"]').val() +\n                \"&referer=\" +\n                $('[name=\"referer\"]', $form).val();\n            that.showEditPortlet(url);\n        });\n    },\n    setupSavePortletsSettings: function () {\n        var that = this;\n        $(\".portlets-settings, form.portlet-action\", that.$el).ajaxForm({\n            beforeSubmit: function () {\n                that.loading.show();\n            },\n            success: function (html) {\n                that.loading.hide();\n                log.info(\"form submit\");\n                var $body = $(utils.parseBodyTag(html));\n                that.rebind($(\"#\" + that.$el.attr(\"id\"), $body).eq(0));\n            },\n        });\n        // Block/unblock inherited portlets (parent, group and content type portlets)\n        $(\".portlets-settings select\", that.$el).on(\"change\", function () {\n            log.info(\"select change\");\n            clearTimeout(that.submitTimeout);\n            that.submitTimeout = window.setTimeout(function () {\n                $(\".portlets-settings\", that.$el).trigger(\"submit\");\n            }, 100);\n        });\n    },\n    setupSwitchPortletManager: function () {\n        var that = this;\n        $(\"#main-container\").on(\"change\", \".switch-portlet-manager\", function (e) {\n            e.stopImmediatePropagation();\n            log.info(\"switch portlet manager\");\n            var url_ = $(this).val();\n            clearTimeout(that.switchTimeout);\n            that.switchTimeout = window.setTimeout(function () {\n                that._reloadPortletManager(url_);\n            }, 100);\n        });\n        // Handle back/forward browser buttons\n        $(window).on(\"popstate\", function (e) {\n            e.stopImmediatePropagation();\n            if (e && e.state === undefined) {\n                var url_ = window.location.href;\n                log.info(\"redirecting to: \" + url_);\n                that._reloadPortletManager(url_, true);\n            }\n        });\n    },\n    _reloadPortletManager: function (url_, is_popstate) {\n        var that = this;\n        that.loading.show();\n        $.get(url_, { ajax_load: 1 }).done(function (html) {\n            var $html = $(utils.parseBodyTag(html));\n            var $content = (\"#content\", $html);\n            $(\"#content\").html($content);\n            that.rebind($(\".pat-manage-portlets\", $content), true);\n            if (!is_popstate) {\n                window.history.pushState(null, null, url_);\n            } else {\n                window.history.replaceState(null, null, url_);\n            }\n            that.loading.hide();\n        });\n    },\n});\n","import $ from \"jquery\";\nimport _ from \"underscore\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport _t from \"../../core/i18n-wrapper\";\nimport utils from \"../../core/utils\";\nimport registry from \"@patternslib/patternslib/src/core/registry\";\nimport Select2 from \"../select2/select2\";\n\nconst KEY = {\n    LEFT: 37,\n    RIGHT: 39,\n};\n\nexport default Base.extend({\n    name: \"relateditems\",\n    trigger: \".pat-relateditems\",\n    parser: \"mockup\",\n    currentPath: undefined,\n    selectedUIDs: [],\n    openAfterInit: undefined,\n    defaults: {\n        // main option\n        vocabularyUrl: null, // must be set to work\n\n        // more options\n        attributes: [\n            \"UID\",\n            \"Title\",\n            \"portal_type\",\n            \"path\",\n            \"getURL\",\n            \"getIcon\",\n            \"is_folderish\",\n            \"review_state\",\n        ], // used by utils.QueryHelper\n        basePath: \"\",\n        pageSize: 10,\n        browsing: undefined,\n        closeOnSelect: true,\n        contextPath: undefined,\n        dropdownCssClass: \"pat-relateditems-dropdown\",\n        favorites: [],\n        recentlyUsed: false,\n        recentlyUsedMaxItems: 20,\n        recentlyUsedKey: \"relateditems_recentlyused\",\n        maximumSelectionSize: -1,\n        minimumInputLength: 0,\n        mode: \"browse\", // possible values are 'auto', 'search' and 'browse'.\n        orderable: true, // mockup-patterns-select2\n        pathOperator: \"plone.app.querystring.operation.string.path\",\n        rootPath: \"/\",\n        rootUrl: \"\", // default to be relative.\n        scanSelection: false, // False, to no unnecessarily use CPU time on this.\n        selectableTypes: null, // null means everything is selectable, otherwise a list of strings to match types that are selectable\n        separator: \",\",\n        sortOn: null,\n        sortOrder: \"ascending\",\n        tokenSeparators: [\",\", \" \"],\n        upload: false,\n        uploadAllowView: undefined,\n\n        // templates\n        breadcrumbTemplateSelector: null,\n        favoriteTemplateSelector: null,\n        recentlyusedTemplateSelector: null,\n        resultTemplateSelector: null,\n        selectionTemplateSelector: null,\n        toolbarTemplateSelector: null,\n\n        // needed\n        multiple: true,\n\n        // ajax settings\n        ajaxTimeout: 500,\n    },\n\n    recentlyUsed(filterSelectable) {\n        let ret = utils.storage.get(this.options.recentlyUsedKey) || [];\n        // hard-limit to 1000 entries\n        ret = ret.slice(ret.length - 1000, ret.length);\n        if (filterSelectable) {\n            // Filter out only selectable items.\n            // This is used only to create the list of items to be displayed.\n            // the list to be stored is unfiltered and can be reused among\n            // different instances of this widget with different settings.\n            ret.filter(this.isSelectable.bind(this));\n        }\n        // max is applied AFTER filtering selectable items.\n        const max = parseInt(this.options.recentlyUsedMaxItems, 10);\n        if (max) {\n            // return the slice from the end, as we want to display newest items first.\n            ret = ret.slice(ret.length - max, ret.length);\n        }\n        return ret;\n    },\n\n    applyTemplate(tpl, item) {\n        let template;\n        if (this.options[tpl + \"TemplateSelector\"]) {\n            template = $(this.options[tpl + \"TemplateSelector\"]).html();\n        }\n        if (!template) {\n            if (this.options[tpl + \"Template\"]) {\n                template = this.options[tpl + \"Template\"];\n            } else {\n                template = this[tpl + \"Template\"];\n            }\n        }\n        // let's give all the options possible to the template generation\n        const options = $.extend(true, {}, this.options, item, {\n            browsing: this.browsing,\n            open_folder: _t(\"Open folder\"),\n            current_directory: _t(\"current directory:\"),\n            one_level_up: _t(\"Go one level up\"),\n        });\n        options._item = item;\n        return _.template(template)(options);\n    },\n\n    setAjax() {\n        const ajaxTimeout = parseInt(this.options.ajaxTimeout || 500, 10);\n\n        const ajax = {\n            url: this.options.vocabularyUrl,\n            dataType: \"JSON\",\n            quietMillis: ajaxTimeout,\n\n            data: (term, page) => {\n                const criterias = [];\n                if (term) {\n                    term = \"*\" + term + \"*\";\n                    criterias.push({\n                        i: \"SearchableText\",\n                        o: \"plone.app.querystring.operation.string.contains\",\n                        v: term,\n                    });\n                }\n\n                // We don't restrict for selectable types while browsing...\n                if (!this.browsing && this.options.selectableTypes) {\n                    criterias.push({\n                        i: \"portal_type\",\n                        o: \"plone.app.querystring.operation.selection.any\",\n                        v: this.options.selectableTypes,\n                    });\n                }\n\n                criterias.push({\n                    i: \"path\",\n                    o: this.options.pathOperator,\n                    v:\n                        this.options.rootPath +\n                        this.currentPath +\n                        (this.browsing ? \"::1\" : \"\"),\n                });\n\n                let sort_on = this.options.sortOn;\n                let sort_order = sort_on ? this.options.sortOrder : null;\n                if (this.browsing && sort_on === null) {\n                    sort_on = \"getObjPositionInParent\";\n                    sort_order = \"ascending\";\n                }\n\n                const data = {\n                    query: JSON.stringify({\n                        criteria: criterias,\n                        sort_on: sort_on,\n                        sort_order: sort_order,\n                    }),\n                    attributes: JSON.stringify(this.options.attributes),\n                    batch: JSON.stringify({\n                        page: page ? page : 1,\n                        size: this.options.pageSize,\n                    }),\n                };\n                return data;\n            },\n\n            results: (data, page) => {\n                const more = page * this.options.pageSize < data.total;\n                let results = data.results;\n\n                this.selectedUIDs = (this.$el.select2(\"data\") || []).map((el) => {\n                    // populate current selection. Reuse in formatResult\n                    return el.UID;\n                });\n\n                // Filter out items:\n                // While browsing: always include folderish items\n                // Browsing and searching: Only include selectable items which are not already selected, and all folders\n                // even if they're selected, as we need them available for browsing/selecting their children\n                results = results.filter((item) => {\n                    if (\n                        (this.browsing && item.is_folderish) ||\n                        (this.isSelectable(item) &&\n                            this.selectedUIDs.indexOf(item.UID) === -1)\n                    ) {\n                        return true;\n                    }\n                    return false;\n                });\n\n                // Extend ``data`` with a ``oneLevelUp`` item when browsing\n                const path = this.currentPath.split(\"/\");\n                if (\n                    page === 1 && // Show level up only on top.\n                    this.browsing && // only level up when browsing\n                    path.length > 1 && // do not try to level up one level under root.\n                    this.currentPath !== \"/\" // do not try to level up beyond root\n                ) {\n                    results = [\n                        {\n                            oneLevelUp: true,\n                            Title: _t(\"One level up\"),\n                            path: path.slice(0, path.length - 1).join(\"/\") || \"/\",\n                            currentPath: this.currentPath,\n                            is_folderish: true,\n                            selectable: false,\n                        },\n                    ].concat(results);\n                }\n                return {\n                    results: results,\n                    more: more,\n                };\n            },\n        };\n        this.options.ajax = ajax;\n    },\n\n    async renderToolbar() {\n        const path = this.currentPath;\n        let html;\n\n        const parts = path.split(\"/\");\n        let itemPath = \"\";\n        let itemsHtml = \"\";\n        for (const part of parts) {\n            if (part !== \"\") {\n                const item = {};\n                item.path = itemPath = `${itemPath}/${part}`;\n                item.text = part;\n                itemsHtml = itemsHtml + this.applyTemplate(\"breadcrumb\", item);\n            }\n        }\n\n        // favorites\n        let favoritesHtml = \"\";\n        for (const item of this.options.favorites) {\n            const item_copy = _.clone(item);\n            item_copy.path = item_copy.path.substr(this.options.rootPath.length) || \"/\";\n            favoritesHtml = favoritesHtml + this.applyTemplate(\"favorite\", item_copy);\n        }\n\n        let recentlyUsedHtml = \"\";\n        if (this.options.recentlyUsed) {\n            const recentlyUsed = this.recentlyUsed(true); // filter out only those items which can actually be selected\n            for (const item of recentlyUsed.reverse()) {\n                // reverse to get newest first.\n                recentlyUsedHtml =\n                    recentlyUsedHtml + this.applyTemplate(\"recentlyused\", item);\n            }\n        }\n\n        html = this.applyTemplate(\"toolbar\", {\n            items: itemsHtml,\n            favItems: favoritesHtml,\n            favText: _t(\"Favorites\"),\n            searchText: _t(\"Current path:\"),\n            searchModeText: _t(\"Search\"),\n            browseModeText: _t(\"Browse\"),\n            recentlyUsedItems: recentlyUsedHtml,\n            recentlyUsedText: _t(\"Recently Used\"),\n            icon_root: await utils.resolveIcon(\"house-fill\"),\n            icon_recently_used: await utils.resolveIcon(\"grid-fill\"),\n            icon_favorites: await utils.resolveIcon(\"star-fill\"),\n            icon_upload: await utils.resolveIcon(\"cloud-arrow-up\"),\n            upload: this.options.upload,\n            upload_text: _t(\"Upload\"),\n        });\n\n        this.$toolbar.html(html);\n\n        // unbind mouseup event from select2 to override the behavior:\n        $(\".pat-relateditems-dropdown\").off(\"mouseup\");\n        $(\".pat-relateditems-dropdown\").on(\"mouseup\", (e) => {\n            e.stopPropagation();\n        });\n\n        $(\"button.mode.search\", this.$toolbar).on(\"click\", (e) => {\n            e.preventDefault();\n            if (this.browsing) {\n                $(\"button.mode.search\", this.$toolbar).toggleClass(\n                    \"btn-primary btn-secondary\"\n                );\n                $(\"button.mode.browse\", this.$toolbar).toggleClass(\n                    \"btn-primary btn-secondary\"\n                );\n                this.browsing = false;\n                if (this.$el.select2(\"data\").length > 0) {\n                    // Have to call after initialization\n                    this.openAfterInit = true;\n                }\n                if (!this.openAfterInit) {\n                    this.$el.select2(\"close\");\n                    this.$el.select2(\"open\");\n                }\n            } else {\n                // just open result list\n                this.$el.select2(\"close\");\n                this.$el.select2(\"open\");\n            }\n        });\n\n        $(\"button.mode.browse\", this.$toolbar).on(\"click\", (e) => {\n            e.preventDefault();\n            if (!this.browsing) {\n                $(\"button.mode.search\", this.$toolbar).toggleClass(\n                    \"btn-primary btn-secondary\"\n                );\n                $(\"button.mode.browse\", this.$toolbar).toggleClass(\n                    \"btn-primary btn-secondary\"\n                );\n                this.browsing = true;\n                if (this.$el.select2(\"data\").length > 0) {\n                    // Have to call after initialization\n                    this.openAfterInit = true;\n                }\n                if (!this.openAfterInit) {\n                    this.$el.select2(\"close\");\n                    this.$el.select2(\"open\");\n                }\n            } else {\n                // just open result list\n                this.$el.select2(\"close\");\n                this.$el.select2(\"open\");\n            }\n        });\n\n        $(\"a.crumb\", this.$toolbar).on(\"click\", (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            this.browseTo($(e.currentTarget).attr(\"href\"));\n        });\n\n        $(\"a.fav\", this.$toolbar).on(\"click\", (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            this.browseTo($(e.currentTarget).attr(\"href\"));\n        });\n\n        if (this.options.recentlyUsed) {\n            $(\".pat-relateditems-recentlyused-select\", this.$toolbar).on(\n                \"click\",\n                (event) => {\n                    event.preventDefault();\n                    const uid = $(event.currentTarget).data(\"uid\");\n                    let item = this.recentlyUsed().filter((it) => {\n                        return it.UID === uid;\n                    });\n                    if (item.length > 0) {\n                        item = item[0];\n                    } else {\n                        return;\n                    }\n                    this.selectItem(item);\n                    if (this.options.maximumSelectionSize > 0) {\n                        const items = this.$el.select2(\"data\");\n                        if (items.length >= this.options.maximumSelectionSize) {\n                            return;\n                        }\n                    }\n                }\n            );\n        }\n\n        // upload\n        if (\n            this.options.upload &&\n            utils.featureSupport.dragAndDrop() &&\n            utils.featureSupport.fileApi()\n        ) {\n            if (this.options.uploadAllowView) {\n                // Check, if uploads are allowed in current context\n                $.ajax({\n                    url: this.options.uploadAllowView,\n                    // url: this.currentUrl() + this.options.uploadAllowView,  // not working yet\n                    dataType: \"JSON\",\n                    data: {\n                        path: this.options.rootPath + this.currentPath,\n                    },\n                    type: \"GET\",\n                    success: (result) => {\n                        this.initUploadView(!result.allowUpload);\n                    },\n                });\n            } else {\n                // just initialize upload view without checking, if uploads are allowed.\n                this.initUploadView();\n            }\n        }\n    },\n\n    async initUploadView(disabled) {\n        let Upload = await import(\"../upload/upload\");\n        Upload = Upload.default;\n\n        const upload_button = this.$toolbar[0].querySelector(\".upload button\");\n        upload_button.disabled = disabled;\n\n        const upload_el = this.$toolbar[0].querySelector(\".upload .pat-upload\");\n\n        const upload_config = {\n            success: (e, response) => {\n                const uid = response.UID;\n                if (uid) {\n                    const query = new utils.QueryHelper({\n                        vocabularyUrl: this.options.vocabularyUrl,\n                        attributes: this.options.attributes,\n                    });\n                    query.search(\n                        \"UID\",\n                        \"plone.app.querystring.operation.selection.is\",\n                        uid,\n                        (e) => {\n                            const data = this.$el.select2(\"data\");\n                            data.push.apply(data, e.results);\n                            this.$el.select2(\"data\", data, true);\n                            this.emit(\"selected\");\n                        },\n                        false\n                    );\n                }\n            },\n            uloadMultiple: true,\n            allowPathSelection: false,\n            relativePath: \"fileUpload\",\n            baseUrl: this.options.rootUrl,\n        };\n        const upload = new Upload($(upload_el), upload_config);\n\n        upload_button.addEventListener(\"show.bs.dropdown\", () => {\n            if (this.currentPath !== upload.currentPath) {\n                upload.setPath(this.currentPath);\n            }\n        });\n    },\n\n    browseTo(path) {\n        this.emit(\"before-browse\");\n        this.currentPath = path;\n        this.$el.select2(\"close\");\n        this.renderToolbar();\n        this.$el.select2(\"open\");\n        this.emit(\"after-browse\");\n    },\n\n    selectItem(item) {\n        this.emit(\"selecting\");\n        const data = $(this.el).select2(\"data\");\n        data.push(item);\n        $(this.el).select2(\"data\", data, true);\n\n        if (this.options.recentlyUsed) {\n            // add to recently added items\n            const recentlyUsed = this.recentlyUsed(); // do not filter for selectable but get all. append to that list the new item.\n            const alreadyPresent = recentlyUsed.filter((it) => {\n                return it.UID === item.UID;\n            });\n            if (alreadyPresent.length > 0) {\n                recentlyUsed.splice(recentlyUsed.indexOf(alreadyPresent[0]), 1);\n            }\n            recentlyUsed.push(item);\n            utils.storage.set(this.options.recentlyUsedKey, recentlyUsed);\n        }\n\n        this.emit(\"selected\");\n    },\n\n    deselectItem(item) {\n        this.emit(\"deselecting\");\n        const data = this.$el.select2(\"data\");\n        data.forEach((obj, i) => {\n            if (obj.UID === item.UID) {\n                data.splice(i, 1);\n            }\n        });\n        this.$el.select2(\"data\", data, true);\n        this.emit(\"deselected\");\n    },\n\n    isSelectable(item) {\n        if (item.selectable === false) {\n            return false;\n        }\n        if (this.options.selectableTypes === null) {\n            return true;\n        } else {\n            return this.options.selectableTypes.indexOf(item.portal_type) !== -1;\n        }\n    },\n\n    async init() {\n        (await import(\"bootstrap\")).Dropdown;\n        import(\"./relateditems.scss\");\n\n        // templates\n        this.breadcrumbTemplate = (await import(\"./templates/breadcrumb.xml\")).default; // prettier-ignore\n        this.favoriteTemplate = (await import(\"./templates/favorite.xml\")).default; // prettier-ignore\n        this.recentlyusedTemplate = (await import(\"./templates/recentlyused.xml\")).default; // prettier-ignore\n        this.resultTemplate = (await import(\"./templates/result.xml\")).default; // prettier-ignore\n        this.selectionTemplate = (await import(\"./templates/selection.xml\")).default; // prettier-ignore\n        this.toolbarTemplate = (await import(\"./templates/toolbar.xml\")).default; // prettier-ignore\n\n        this.browsing = this.options.mode !== \"search\";\n\n        // Remove trailing slash\n        this.options.rootPath = this.options.rootPath.replace(/\\/$/, \"\");\n        // Substract rootPath from basePath with is the relative currentPath. Has a leading slash. Or use '/'\n        this.currentPath =\n            this.options.basePath.substr(this.options.rootPath.length) || \"/\";\n\n        this.setAjax();\n\n        this.$el.wrap('<div class=\"pat-relateditems-container\" />');\n        this.$container = this.$el.parents(\".pat-relateditems-container\");\n\n        Select2.prototype.initializeValues.call(this);\n        Select2.prototype.initializeTags.call(this);\n\n        this.options.formatSelection = (item) => {\n            item = $.extend(\n                true,\n                {\n                    Title: \"\",\n                    getIcon: \"\",\n                    getURL: \"\",\n                    path: \"\",\n                    portal_type: \"\",\n                    review_state: \"\",\n                },\n                item\n            );\n\n            // activate petterns on the result set.\n            const $selection = $(this.applyTemplate(\"selection\", item));\n            if (this.options.scanSelection) {\n                registry.scan($selection);\n            }\n            if (this.options.maximumSelectionSize == 1) {\n                // If this related field accepts only 1 item, the breadcrumbs should\n                // reflect the location for this particular item\n                let itemPath = item.path;\n                let path_split = itemPath.split(\"/\");\n                path_split = path_split.slice(0, -1); // Remove last part of path, we always want the parent path\n                itemPath = path_split.join(\"/\");\n                this.currentPath = itemPath;\n                this.renderToolbar();\n            }\n            return $selection;\n        };\n\n        const icon_level_up = await utils.resolveIcon(\"arrow-left-circle\");\n        const icon_level_down = await utils.resolveIcon(\"arrow-right-circle\");\n\n        this.options.formatResult = (item) => {\n            item.selectable = this.isSelectable(item);\n            item = $.extend(\n                true,\n                {\n                    Title: \"\",\n                    getIcon: \"\",\n                    getURL: \"\",\n                    is_folderish: false,\n                    oneLevelUp: false,\n                    iconLevelUp: icon_level_up,\n                    iconLevelDown: icon_level_down,\n                    path: \"\",\n                    portal_type: \"\",\n                    review_state: \"\",\n                    selectable: false,\n                },\n                item\n            );\n\n            if (this.selectedUIDs.indexOf(item.UID) !== -1) {\n                // do not allow already selected items to be selected again.\n                item.selectable = false;\n            }\n            const result = $(this.applyTemplate(\"result\", item));\n\n            $(\".pat-relateditems-result-select\", result).on(\"click\", (event) => {\n                const _el = event.currentTarget;\n                event.preventDefault();\n                // event.stopPropagation();\n                if ($(_el).is(\".selectable\")) {\n                    const $parent = $(_el).parents(\".pat-relateditems-result\");\n                    if ($parent.is(\".pat-relateditems-active\")) {\n                        $parent.removeClass(\"pat-relateditems-active\");\n                        this.deselectItem(item);\n                    } else {\n                        if (this.options.maximumSelectionSize > 0) {\n                            const items = this.$el.select2(\"data\");\n                            if (items.length >= this.options.maximumSelectionSize) {\n                                this.$el.select2(\"close\");\n                            }\n                        }\n                        this.selectItem(item);\n                        $parent.addClass(\"pat-relateditems-active\");\n                        if (this.options.closeOnSelect) {\n                            this.$el.select2(\"close\");\n                        }\n                    }\n                }\n            });\n\n            $(\".pat-relateditems-result-browse\", result).on(\"click\", (event) => {\n                event.preventDefault();\n                event.stopPropagation();\n                const path = $(event.currentTarget).data(\"path\");\n                this.browseTo(path);\n            });\n\n            return $(result);\n        };\n\n        this.options.initSelection = (element, callback) => {\n            const value = $(element).val();\n            if (value !== \"\") {\n                const ids = value.split(this.options.separator);\n                const query = new utils.QueryHelper(\n                    $.extend(true, {}, this.options, {\n                        pattern: this,\n                    })\n                );\n                query.search(\n                    \"UID\",\n                    \"plone.app.querystring.operation.list.contains\",\n                    ids,\n                    (data) => {\n                        const results = data.results.reduce((prev, item) => {\n                            prev[item.UID] = item;\n                            return prev;\n                        }, {});\n\n                        try {\n                            callback(\n                                ids\n                                    .map((uid) => results[uid])\n                                    .filter((item) => item !== undefined)\n                            );\n                        } catch {\n                            // Select2 3.5.4 throws an error in some cases in\n                            // updateSelection, ``this.selection.find(\".select2-search-choice\").remove();``\n                            // No idea why, hard to track.\n                        }\n\n                        if (this.openAfterInit) {\n                            // open after initialization\n                            this.$el.select2(\"open\");\n                            this.openAfterInit = undefined;\n                        }\n                    },\n                    false\n                );\n            }\n        };\n\n        this.options.tokenizer = (input) => {\n            if (this.options.mode === \"auto\") {\n                this.browsing = input ? false : true;\n            }\n        };\n\n        this.options.id = (item) => item.UID;\n\n        await Select2.prototype.initializeSelect2.call(this);\n        await Select2.prototype.initializeOrdering.call(this);\n\n        this.$toolbar = $('<div class=\"toolbar d-flex\" />');\n        this.$container.prepend(this.$toolbar);\n        this.$el.on(\"select2-selecting\", (event) => {\n            if (!this.isSelectable(event.choice)) {\n                event.preventDefault();\n            }\n        });\n        this.renderToolbar();\n        this.$el.on(\"select2-loaded\", () => {\n            let yMax = window.innerHeight || document.documentElement.clientHeight;\n            const relitem_rect = this.el.parentElement.getBoundingClientRect();\n            const element = $(\n                \"#select2-drop.pat-relateditems-dropdown.select2-drop-active .select2-results\"\n            )[0];\n            const rect = element.getBoundingClientRect();\n            const maxHeight = ((relitem_rect.top > rect.top) ? relitem_rect.top : yMax - rect.top) - 18;\n            $(element).css(\"max-height\", `${maxHeight}px`);\n        });\n\n        $(document).on(\"keyup\", this.$el, (event) => {\n            const isOpen = Select2.prototype.opened.call(this);\n            if (!isOpen) {\n                return;\n            }\n\n            if (event.which === KEY.LEFT || event.which === KEY.RIGHT) {\n                event.stopPropagation();\n\n                const selectorContext =\n                    event.which === KEY.LEFT\n                        ? \".pat-relateditems-result.one-level-up\"\n                        : \".select2-highlighted\";\n\n                const browsableItemSelector = \".pat-relateditems-result-browse\";\n                const browsableItem = $(browsableItemSelector, selectorContext);\n\n                if (browsableItem.length !== 1) {\n                    return;\n                }\n\n                const path = browsableItem.data(\"path\");\n\n                this.browseTo(path);\n            }\n        });\n    },\n});\n","import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"navigationmarker\",\n    trigger: \".pat-navigationmarker\",\n    parser: \"mockup\",\n    init: function () {\n        const portal_url = document.body.dataset.portalUrl;\n        var href =\n            document.querySelector('head link[rel=\"canonical\"]').href ||\n            window.location.href;\n\n        $(\"a\", this.$el).each(function () {\n            var navlink = this.href.replace(\"/view\", \"\");\n            if (href.indexOf(navlink) !== -1) {\n                var parent = $(this).parent();\n\n                // check the input-openers within the path\n                var check = parent.find(\"> input\");\n                if (check.length) {\n                    check[0].checked = true;\n                }\n\n                // set \"inPath\" to all nav items which are within the current path\n                // check if parts of navlink are in canonical url parts\n                var hrefParts = href.split(\"/\");\n                var navParts = navlink.split(\"/\");\n                var inPath = false;\n                for (var i = 0, size = navParts.length; i < size; i++) {\n                    // The last path-part must match.\n                    inPath = false;\n                    if (navParts[i] === hrefParts[i]) {\n                        inPath = true;\n                    }\n                }\n                if (navlink === portal_url && href !== portal_url) {\n                    // Avoid marking \"Home\" with \"inPath\", when not actually there\n                    inPath = false;\n                }\n                if (inPath) {\n                    parent.addClass(\"inPath\");\n                }\n\n                // set \"current\" to the current selected nav item, if it is in the navigation structure.\n                if (href === navlink) {\n                    parent.addClass(\"current\");\n                }\n            }\n        });\n    },\n});\n","import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"backdrop\",\n    trigger: \".pat-backdrop\",\n    parser: \"mockup\",\n    defaults: {\n        zIndex: null,\n        opacity: 0.8,\n        className: \"plone-backdrop\",\n        classActiveName: \"plone-backdrop-active\",\n        closeOnEsc: true,\n        closeOnClick: true,\n    },\n    init: function () {\n        var self = this;\n        self.$backdrop = $(\"> .\" + self.options.className, self.$el);\n        if (self.$backdrop.length === 0) {\n            self.$backdrop = $(\"<div/>\")\n                .hide()\n                .appendTo(self.$el)\n                .addClass(self.options.className);\n            if (self.options.zIndex !== null) {\n                self.$backdrop.css(\"z-index\", self.options.zIndex);\n            }\n        }\n        if (self.options.closeOnEsc === true) {\n            // eslint-disable-next-line no-unused-vars\n            $(document).on(\"keydown\", function (e, data) {\n                if (self.$el.is(\".\" + self.options.classActiveName)) {\n                    if (e.keyCode === 27) {\n                        // ESC key pressed\n                        self.hide();\n                    }\n                }\n            });\n        }\n        if (self.options.closeOnClick === true) {\n            self.$backdrop.on(\"click\", function () {\n                if (self.$el.is(\".\" + self.options.classActiveName)) {\n                    self.hide();\n                }\n            });\n        }\n    },\n    show: function () {\n        var self = this;\n        if (!self.$el.hasClass(self.options.classActiveName)) {\n            self.emit(\"show\");\n            self.$backdrop.css(\"opacity\", \"0\").show();\n            self.$el.addClass(self.options.classActiveName);\n            self.$backdrop.animate({ opacity: self.options.opacity }, 500);\n            self.emit(\"shown\");\n        }\n    },\n    hide: function () {\n        var self = this;\n        if (self.$el.hasClass(self.options.classActiveName)) {\n            self.emit(\"hide\");\n            self.$backdrop.animate({ opacity: \"0\" }, 500).hide();\n            self.$el.removeClass(self.options.classActiveName);\n            self.emit(\"hidden\");\n        }\n    },\n});\n","import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"structureupdater\",\n    trigger: \".template-folder_contents\",\n    parser: \"mockup\",\n    defaults: {\n        titleSelector: \"\",\n        descriptionSelector: \"\",\n    },\n\n    init: function () {\n        $(\"body\").on(\"context-info-loaded\", (e, data) => {\n            if (this.options.titleSelector) {\n                $(this.options.titleSelector, this.$el).html(\n                    (data.object && data.object.Title) || \"&nbsp;\"\n                );\n            }\n            if (this.options.descriptionSelector) {\n                $(this.options.descriptionSelector, this.$el).html(\n                    (data.object && data.object.Description) || \"&nbsp;\"\n                );\n            }\n        });\n    },\n});\n","import Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"schemaeditor\",\n    trigger: \".pat-schemaeditor\",\n    parser: \"mockup\",\n    init: async function () {\n        const implementation = (await import(\"./schemaeditor--implementation\")).default;\n        const instance = new implementation(this.el);\n        instance.init();\n    },\n});\n","import $ from \"jquery\";\n\nvar parser = {\n    getOptions($el, patternName, options) {\n        /* This is the Mockup parser. An alternative parser for Patternslib\n         * patterns.\n         *\n         * NOTE: Use of the Mockup parser is discouraged and is added here for\n         * legacy support for the Plone Mockup project.\n         *\n         * It parses a DOM element for pattern configuration options.\n         */\n        options = options || {};\n        // get options from parent element first, stop if element tag name is 'body'\n        if ($el.length !== 0 && !$.nodeName($el[0], \"body\")) {\n            options = this.getOptions($el.parent(), patternName, options);\n        }\n        // collect all options from element\n        let elOptions = {};\n        if ($el.length !== 0) {\n            elOptions = $el.data(\"pat-\" + patternName);\n            if (elOptions) {\n                // parse options if string\n                if (typeof elOptions === \"string\") {\n                    const tmpOptions = {};\n                    $.each(elOptions.split(\";\"), function (i, item) {\n                        item = item.split(\":\");\n                        item.reverse();\n                        let key = item.pop();\n                        key = key.replace(/^\\s+|\\s+$/g, \"\"); // trim\n                        item.reverse();\n                        let value = item.join(\":\");\n                        value = value.replace(/^\\s+|\\s+$/g, \"\"); // trim\n                        tmpOptions[key] = value;\n                    });\n                    elOptions = tmpOptions;\n                }\n            }\n        }\n        return $.extend(true, {}, options, elOptions);\n    },\n};\n\nexport default parser;\n","/**\n * A Base pattern for creating scoped patterns. It's similar to Backbone's\n * Model class. The advantage of this approach is that each instance of a\n * pattern has its own local scope (closure).\n *\n * A new instance is created for each DOM element on which a pattern applies.\n *\n * You can assign values, such as $el, to `this` for an instance and they\n * will remain unique to that instance.\n *\n * Older Patternslib patterns on the other hand have a single global scope for\n * all DOM elements.\n */\nimport $ from \"jquery\";\nimport Registry from \"./registry\";\nimport logging from \"./logging\";\nimport mockupParser from \"./mockup-parser\";\n\nconst log = logging.getLogger(\"Patternslib Base\");\n\nconst initBasePattern = function ($el, options, trigger) {\n    if (!$el.jquery) {\n        $el = $($el);\n    }\n    const name = this.prototype.name;\n    const plog = logging.getLogger(`pat.${name}`);\n    let pattern = $el.data(`pattern-${name}`);\n    if (pattern === undefined && Registry.patterns[name]) {\n        try {\n            // Immediately set the pattern instance to the temporary value\n            // ``initializing`` before the async Base constructor is setting\n            // the value later.\n            // This prevents re-init the pattern on this element on multiple\n            // initialization calls..\n            $el.data(`pattern-${name}`, \"initializing\");\n            options =\n                this.prototype.parser === \"mockup\"\n                    ? mockupParser.getOptions($el, name, options)\n                    : options;\n            pattern = new Registry.patterns[name]($el, options, trigger);\n        } catch (e) {\n            plog.error(`Failed while initializing ${name} pattern.`, e);\n        }\n    }\n    return pattern;\n};\n\nconst Base = async function ($el, options, trigger) {\n    if (($el?.jquery && $el.length === 0) || !$el) {\n        log.warn(\"No element given to pattern.\");\n        return;\n    }\n    if (!$el.jquery) {\n        $el = $($el);\n    }\n    this.$el = $el;\n    this.el = $el[0];\n    this.options = $.extend(true, {}, this.defaults || {}, options || {});\n\n    this.emit(\"pre-init\");\n\n    await this.init($el, options, trigger);\n\n    // Store pattern instance on element\n    this.$el.data(`pattern-${this.name}`, this);\n    this.el[`pattern-${this.name}`] = this;\n\n    this.emit(\"init\");\n};\n\nBase.prototype = {\n    constructor: Base,\n    on(eventName, eventCallback) {\n        this.$el.on(`${eventName}.${this.name}.patterns`, eventCallback);\n    },\n    one(eventName, eventCallback) {\n        this.$el.one(`${eventName}.${this.name}.patterns`, eventCallback);\n    },\n    emit(eventName, args) {\n        // args should be a list\n        if (args === undefined) {\n            args = [];\n        }\n        this.$el.trigger(`${eventName}.${this.name}.patterns`, args);\n    },\n};\n\nBase.extend = function (patternProps) {\n    /* Helper function to correctly set up the prototype chain for new patterns.\n     */\n    const parent = this;\n    let child;\n\n    // Check that the required configuration properties are given.\n    if (!patternProps) {\n        throw new Error(\n            \"Pattern configuration properties required when calling Base.extend\"\n        );\n    }\n\n    // The constructor function for the new subclass is either defined by you\n    // (the \"constructor\" property in your `extend` definition), or defaulted\n    // by us to simply call the parent's constructor.\n    if (Object.hasOwnProperty.call(patternProps, \"constructor\")) {\n        child = patternProps.constructor;\n    } else {\n        child = function () {\n            parent.apply(this, arguments);\n        };\n    }\n\n    // Allow patterns to be extended indefinitely\n    child.extend = Base.extend;\n\n    // Static properties required by the Patternslib registry\n    child.init = initBasePattern;\n    child.jquery_plugin = true;\n    child.trigger = patternProps.trigger;\n    child.parser = patternProps?.parser || null;\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`'s constructor function.\n    var Surrogate = function () {\n        this.constructor = child;\n    };\n    Surrogate.prototype = parent.prototype;\n    child.prototype = new Surrogate();\n\n    // Add pattern's configuration properties (instance properties) to the subclass,\n    $.extend(true, child.prototype, patternProps);\n\n    // Set a convenience property in case the parent's prototype is needed\n    // later.\n    child.__super__ = parent.prototype;\n\n    // Register the pattern in the Patternslib registry.\n    if (!patternProps.name) {\n        log.warn(\"This pattern without a name attribute will not be registered!\");\n    } else if (!patternProps.trigger) {\n        log.warn(\n            `The pattern ${patternProps.name} does not have a trigger attribute, it will not be registered.`\n        );\n    } else if (patternProps.autoregister !== false) {\n        Registry.register(child, patternProps.name);\n    }\n    return child;\n};\n\nexport default Base;\n","import { BasePattern } from \"@patternslib/patternslib/src/core/basepattern\";\nimport Parser from \"@patternslib/patternslib/src/core/parser\";\nimport events from \"@patternslib/patternslib/src/core/events\";\nimport registry from \"@patternslib/patternslib/src/core/registry\";\n\nexport const parser = new Parser(\"code-editor\");\nparser.addArgument(\"language\", null); // programming language to use.\nparser.addArgument(\"linenumbers\", false);\nparser.addArgument(\"theme\", \"dark\"); // dark or light or any other theme variant.\n\n// CodeJar options\nparser.addArgument(\"tab\", \"    \"); // The tab-string. \"\\t\" for real tabs.\nparser.addArgument(\"indent-on\", \"{$\");\nparser.addArgument(\"spellcheck\", false);\nparser.addArgument(\"catch-tab\", true);\nparser.addArgument(\"preserve-ident\", true);\nparser.addArgument(\"add-closing\", true);\nparser.addArgument(\"history\", true);\n\nconst language_mapping = {\n    atom: \"xml\",\n    html: \"xml\",\n    plist: \"xml\",\n    rss: \"xml\",\n    svg: \"xml\",\n    wsf: \"xml\",\n    xhtml: \"xml\",\n    xjb: \"xml\",\n    xsd: \"xml\",\n    xsl: \"xml\",\n};\n\nclass Pattern extends BasePattern {\n    static name = \"code-editor\";\n    static trigger = \".pat-code-editor\";\n    static parser = parser;\n\n    async init() {\n        const CodeJar = (await import(\"codejar\")).CodeJar;\n        const hljs = (await import(\"highlight.js/lib/core\")).default;\n        let el = this.el;\n\n        // Set and load the theme.\n        let theme;\n        if (this.options.theme === \"light\") {\n            theme = \"stackoverflow-light\";\n        } else if (this.options.theme === \"dark\" || this.options.theme === \"okaidia\") {\n            theme = \"stackoverflow-dark\";\n        } else {\n            theme = this.options.theme;\n        }\n\n        // Need to await the style import, otherwise theme might not be applied.\n        await import(`highlight.js/styles/${theme}.css`);\n        if (window.__patternslib_import_styles) {\n            await import(\"./_code-editor.scss\");\n        }\n\n        // Custom hightlighting function, as of:\n        // https://github.com/antonmedv/codejar/blob/master/index.html\n        const highlight = (editor) => {\n            // highlight.js does not trim old tags,\n            // let's do it by this hack.\n            editor.textContent = editor.textContent;\n            hljs.highlightElement(editor);\n        };\n        let highlight_wrapper = highlight;\n\n        // Optional line numbers.\n        if (this.options.linenumbers) {\n            const linenumbers = (await import(\"codejar/linenumbers\")).withLineNumbers;\n            highlight_wrapper = linenumbers(highlight, {\n                class: `codejar-linenumbers ${theme}`,\n            });\n        }\n\n        // Import and register the language.\n        let language = [...el.classList].filter((it) => it.startsWith(\"language-\"))[0];\n        language = language ? language.replace(\"language-\", \"\") : this.options.language;\n        language = language || \"plaintext\";\n        const hljs_language = (\n            await import(\n                `highlight.js/lib/languages/${language_mapping[language] || language}`\n            )\n        ).default;\n        hljs.registerLanguage(language, hljs_language);\n\n        // Create a editor element in case of an input element.\n        if ([\"textarea\", \"input\"].includes(this.el.nodeName.toLowerCase())) {\n            const pre_el = document.createElement(\"pre\");\n            pre_el.innerHTML = `<code contenteditable></code>`;\n            el = pre_el.querySelector(\"code\");\n            el.textContent = this.el.value; // value is already unescaped.\n            this.el.parentNode.insertBefore(pre_el, this.el);\n            this.el.setAttribute(\"hidden\", \"\");\n        }\n\n        // Add some classes to the editor element.\n        el.classList.add(\n            \"code-editor\",\n            `theme-${this.options.theme}`,\n            `language-${language}`\n        );\n\n        // Allow spaces within quotes to be added as tab argument.\n        // Replace escaped tab character with real tab.\n        const tab = this.options.tab\n            .replace(/'/g, \"\") // Allow spaces within quotes\n            .replace(/\"/g, \"\")\n            .replace(/\\\\t/g, \"\\t\"); // Replace double escaped tab character\n\n        // Create the editor.\n        const config = {\n            tab: tab,\n            indentOn: new RegExp(this.options.indentOn),\n            spellcheck: this.options.spellcheck,\n            catchTab: this.options.catchTab,\n            preserveIdent: this.options.preserveIdent,\n            addClosing: this.options.addClosing,\n            history: this.options.history,\n        };\n        this.codeeditor = CodeJar(el, highlight_wrapper, config);\n\n        // Update the input element.\n        if (el !== this.el) {\n            // Update <textarea> or <input>, if one of these were the\n            // initializing elements.\n            this.codeeditor.onUpdate((code) => {\n                this.el.value = code.trim();\n                this.el.dispatchEvent(events.input_event());\n            });\n        }\n    }\n}\n\nregistry.register(Pattern);\n\nexport default Pattern;\nexport { Pattern };\n","import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport _t from \"../../core/i18n-wrapper\";\n\nexport default Base.extend({\n    name: \"formunloadalert\",\n    trigger: \".pat-formunloadalert\",\n    parser: \"mockup\",\n    _changed: false, // Stores a listing of raised changes by their key\n    _suppressed: false, // whether or not warning should be suppressed\n    defaults: {\n        message: _t(\"Discard changes? If you click OK, any changes you have made will be lost.\"), // prettier-ignore\n        // events on which to check for changes\n        changingEvents: \"change keyup paste\",\n        // fields on which to check for changes\n        changingFields: \"input,select,textarea,fileupload\",\n    },\n    init() {\n        var self = this;\n        // if this is not a form just return\n        if (!self.$el.is(\"form\")) {\n            return;\n        }\n\n        $(self.options.changingFields, self.$el).on(self.options.changingEvents, () => {\n            self._changed = true;\n        });\n\n        var $modal = self.$el.parents(\".plone-modal\");\n        if ($modal.length !== 0) {\n            $modal.on(\"hide\", function (e) {\n                var modal = $modal.data(\"patternPloneModal\");\n                if (modal) {\n                    modal._suppressHide = self._handleUnload.call(self, e);\n                }\n            });\n        } else {\n            $(window).on(\"beforeunload\", (e) => {\n                return self._handleUnload(e);\n            });\n        }\n\n        self.$el.on(\"submit\", () => {\n            self._suppressed = true;\n        });\n    },\n    _handleUnload(e) {\n        var self = this;\n        if (self._suppressed) {\n            self._suppressed = false;\n            return undefined;\n        }\n        if (self._changed) {\n            var msg = self.options.message;\n            self._handleMsg(e, msg);\n            $(window).trigger(\"messageset\");\n            return msg;\n        }\n    },\n    _handleMsg(e, msg) {\n        (e || window.event).returnValue = msg;\n    },\n});\n","import $ from \"jquery\";\nimport _ from \"underscore\";\nimport _t from \"../../core/i18n-wrapper\";\nimport utils from \"../../core/utils\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport { Pattern as ContentbrowserPattern } from \"../contentbrowser/contentbrowser\";\n\nvar Criteria = function () {\n    this.init.apply(this, arguments);\n};\nCriteria.prototype = {\n    defaults: {\n        indexWidth: \"20em\",\n        remove: \"\",\n        classBetweenDtName: \"querystring-criteria-betweendt\",\n        classWrapperName: \"querystring-criteria-wrapper\",\n        classIndexName: \"querystring-criteria-index\",\n        classOperatorName: \"querystring-criteria-operator\",\n        classValueName: \"querystring-criteria-value\",\n        classRemoveName: \"querystring-criteria-remove\",\n        classResultsName: \"querystring-criteria-results\",\n        classClearName: \"querystring-criteria-clear\",\n        classDepthName: \"querystring-criteria-depth\",\n    },\n    init: function (\n        $el,\n        app,\n        options,\n        indexes,\n        index,\n        operator,\n        value,\n        baseUrl,\n        patternDateOptions,\n        patternAjaxSelectOptions,\n        patternRelateditemsOptions\n    ) {\n        var self = this;\n        self.app = app;\n\n        self.options = {\n            ...self.defaults,\n            ...options,\n        };\n        self.indexes = indexes;\n        self.indexGroups = {};\n        self.baseUrl = baseUrl;\n        self.advanced = false;\n        self.initial = value;\n        // create wrapper criteria and append it to DOM\n        self.$wrapper = $(\"<div/>\")\n            .addClass(self.options.classWrapperName)\n            .appendTo($el);\n\n        // Sub widgets options\n        self.patternDateOptions = patternDateOptions || {};\n        self.patternAjaxSelectOptions = patternAjaxSelectOptions || {};\n        self.patternRelateditemsOptions = patternRelateditemsOptions || {};\n        // Defaults\n        self.patternAjaxSelectOptions = {\n            width: \"250px\",\n            ...self.patternAjaxSelectOptions,\n        };\n        self.patternRelateditemsOptions = {\n            vocabularyUrl:\n                self.baseUrl +\n                \"@@getVocabulary?name=plone.app.vocabularies.Catalog&field=relatedItems\",\n            width: \"20rem\",\n            ...self.patternRelateditemsOptions,\n        };\n        // Force set\n        self.patternRelateditemsOptions[\"maximumSelectionSize\"] = 1;\n\n        // Remove button\n        self.$remove = $(\"<div>\" + self.options.remove + \"</div>\")\n            .addClass(self.options.classRemoveName)\n            .appendTo(self.$wrapper)\n            .on(\"click\", function (e) {\n                e.stopPropagation();\n                self.remove();\n            });\n\n        // Index selection\n        self.$index = $(\"<select><option></option></select>\").attr(\n            \"placeholder\",\n            _t(\"Select criteria\")\n        );\n\n        // list of indexes\n        for (const value in self.indexes) {\n            let options = self.indexes[value];\n            if (options.enabled) {\n                if (!self.indexGroups[options.group]) {\n                    self.indexGroups[options.group] = $(\"<optgroup/>\")\n                        .attr(\"label\", options.group)\n                        .appendTo(self.$index);\n                }\n                self.indexGroups[options.group].append(\n                    $(\"<option/>\").attr(\"value\", value).html(options.title)\n                );\n            }\n        }\n\n        // attach index select to DOM\n        self.$wrapper.append(\n            $(\"<div/>\").addClass(self.options.classIndexName).append(self.$index)\n        );\n\n        // add blink (select2)\n        self.$index.patternSelect2({\n            width: self.options.indexWidth,\n            placeholder: _t(\"Select criteria\"),\n        });\n        self.$index.on(\"change\", function (e) {\n            self.removeValue();\n            self.createOperator(e.val);\n            self.createClear();\n            self.trigger(\"index-changed\");\n        });\n\n        if (typeof index !== \"undefined\") {\n            self.$index.val(index);\n            self.createOperator(index, operator, value);\n            self.createClear();\n        }\n\n        self.trigger(\"create-criteria\");\n    },\n    appendOperators: function (index) {\n        var self = this;\n\n        self.$operator = $(\"<select/>\");\n\n        if (self.indexes[index]) {\n            _.each(self.indexes[index].operations, function (value) {\n                var options = self.indexes[index].operators[value];\n                $(\"<option/>\")\n                    .attr(\"value\", value)\n                    .html(options.title)\n                    .appendTo(self.$operator);\n            });\n        }\n\n        // attach operators select to DOM\n        self.$wrapper.append(\n            $(\"<div/>\").addClass(self.options.classOperatorName).append(self.$operator)\n        );\n\n        // add blink (select2)\n        self.$operator.patternSelect2({ width: \"10em\" });\n        self.$operator.on(\"change\", function () {\n            self.createValue(index);\n            self.createClear();\n            self.trigger(\"operator-changed\");\n        });\n    },\n    convertPathOperators: function (oval) {\n        var self = this;\n\n        if (self.advanced) {\n            return oval;\n        }\n        //This allows us to use the same query operation for multiple dropdown options.\n        oval = oval.replace(\"advanced\", \"relativePath\").replace(\"path\", \"relativePath\");\n        return oval;\n    },\n    createPathOperators: function () {\n        var self = this;\n\n        if (self.advanced) {\n            self.resetPathOperators();\n            return;\n        }\n        var newOperator = \"plone.app.querystring.operation.string.advanced\";\n\n        if (typeof self.indexes.path.operators[newOperator] === \"undefined\") {\n            self.indexes.path.operations.push(newOperator);\n            self.indexes.path.operators[newOperator] = {\n                title: \"Advanced\",\n                widget: \"AdvancedPathWidget\",\n                description: \"Enter a custom path string\",\n                operation: \"plone.app.querystring.queryparser._relativePath\",\n            };\n        }\n\n        for (const key in self.indexes.path.operators) {\n            var options = self.indexes.path.operators[key];\n            if (key.indexOf(\"absolute\") > 0) {\n                options.title = \"Custom\";\n            } else if (key.indexOf(\"relative\") > 0) {\n                options.title = \"Parent (../)\";\n            } else if (key.indexOf(\"advanced\") > 0) {\n                options.title = \"Advanced Mode\";\n            } else {\n                options.title = \"Current (./)\";\n                options.widget = \"RelativePathWidget\";\n            }\n        };\n    },\n    resetPathOperators: function () {\n        var self = this;\n        for (const key in self.indexes.path.operators) {\n            var options = self.indexes.path.operators[key];\n            if (key.indexOf(\"absolute\") > 0) {\n                options.title = \"Absolute Path\";\n            } else if (key.indexOf(\"relative\") > 0) {\n                options.title = \"Relative Path\";\n            } else if (key.indexOf(\"advanced\") > 0) {\n                options.title = \"Simple Mode\";\n            } else {\n                options.title = \"Navigation Path\";\n                options.widget = \"ReferenceWidget\";\n            }\n        };\n\n        return;\n    },\n    createOperator: function (index, operator, value) {\n        var self = this;\n\n        self.removeOperator();\n        self.createPathOperators();\n\n        // We must test if we have a \"simple\" path or an \"advanced\" one and change the widgets accordingly\n        if (\n            index === \"path\" &&\n            value &&\n            value !== \".::1\" &&\n            value !== \"..::1\" &&\n            !value.match(/^[0-9a-f\\-]{32,36}::-?[0-9]+$/)\n        ) {\n            self.advanced = true;\n            self.resetPathOperators();\n        }\n\n        self.appendOperators(index);\n\n        if (typeof operator === \"undefined\") {\n            operator = self.$operator.val();\n        }\n\n        self.$operator.val(operator);\n        self.createValue(index, value);\n\n        self.trigger(\"create-operator\");\n    },\n    createValue: function (index, value) {\n        var self = this,\n            widget = self.indexes[index].operators[self.$operator.val()].widget,\n            $wrapper = $(\"<div/>\")\n                .addClass(self.options.classValueName)\n                .appendTo(self.$wrapper);\n\n        self.removeValue();\n\n        var createDepthSelect = function (selected) {\n            // remove previous depth-select-box items\n            $wrapper.remove(\".depth-select-box\");\n            var select =\n                \"<div class='depth-select-box'>\" +\n                \"<label for='depth-select'>Depth</label>\" +\n                \"<select name='depth-select' class='\" +\n                self.options.classDepthName +\n                \"'>\" +\n                \"<option value='-1' selected='selected'>Unlimited</option>\";\n\n            for (var i = 0; i <= 10; i += 1) {\n                select += \"<option value=\" + i + \" \";\n                if (\"\" + i === selected) {\n                    select += \"selected='selected' \";\n                }\n                select += \">\" + i + \"</option>\";\n            }\n            select += \"</select>\" + \"</div>\";\n\n            return $(select).on(\"change\", function () {\n                self.trigger(\"depth-changed\");\n            });\n        };\n\n        if (widget === \"StringWidget\") {\n            self.$value = $('<input type=\"text\"/>')\n                .addClass(self.options.classValueName + \"-\" + widget)\n                .val(value)\n                .appendTo($wrapper)\n                .on(\"change\", function () {\n                    self.trigger(\"value-changed\");\n                });\n        } else if (widget === \"DateWidget\") {\n            self.$value = $('<input type=\"date\"/>')\n                .addClass(self.options.classValueName + \"-\" + widget)\n                .val(value)\n                .appendTo($wrapper)\n                .on(\"change\", function () {\n                    self.trigger(\"value-changed\");\n                });\n        } else if (widget === \"DateRangeWidget\") {\n            var startwrap = $(\"<span/>\").appendTo($wrapper);\n            var val1 = \"\";\n            var val2 = \"\";\n\n            if (value) {\n                val1 = value[0] ? value[0] : \"\";\n                val2 = value[1] ? value[1] : \"\";\n            }\n\n            var startdt = $('<input type=\"date\"/>')\n                .addClass(self.options.classValueName + \"-\" + widget)\n                .addClass(self.options.classValueName + \"-\" + widget + \"-start\")\n                .val(val1)\n                .appendTo(startwrap)\n                .on(\"change\", function () {\n                    self.trigger(\"value-changed\");\n                });\n            $wrapper.append(\n                $(\"<span/>\").html(_t(\"to\")).addClass(self.options.classBetweenDtName)\n            );\n            var endwrap = $(\"<span/>\").appendTo($wrapper);\n            var enddt = $('<input type=\"date\"/>')\n                .addClass(self.options.classValueName + \"-\" + widget)\n                .addClass(self.options.classValueName + \"-\" + widget + \"-end\")\n                .val(val2)\n                .appendTo(endwrap)\n                .on(\"change\", function () {\n                    self.trigger(\"value-changed\");\n                });\n            self.$value = [startdt, enddt];\n        } else if (widget === \"RelativeDateWidget\") {\n            self.$value = $('<input type=\"text\"/>')\n                .after($(\"<span/>\").html(_t(\"days\")))\n                .addClass(self.options.classValueName + \"-\" + widget)\n                .val(value)\n                .appendTo($wrapper)\n                .on(\"change\", function () {\n                    self.trigger(\"value-changed\");\n                });\n        } else if (widget === \"AdvancedPathWidget\") {\n            if (self.advanced) {\n                self.advanced = false;\n            } else {\n                self.advanced = true;\n            }\n            self.createPathOperators();\n            self.removeOperator();\n            self.appendOperators(index);\n            self.createValue(index);\n        } else if (widget === \"RelativePathWidget\") {\n            if (self.advanced) {\n                self.$value = $('<input type=\"text\"/>')\n                    .addClass(self.options.classValueName + \"-\" + widget)\n                    .appendTo($wrapper)\n                    .val(value)\n                    .on(\"change\", function () {\n                        self.trigger(\"value-changed\");\n                    });\n            } else {\n                var pathAndDepth = [\".\", \"1\"];\n                if (typeof value !== \"undefined\" && value.indexOf(\"::\") != -1) {\n                    pathAndDepth = value.split(\"::\");\n                    if (pathAndDepth[0] === \".\") {\n                        self.$operator.val(\n                            \"plone.app.querystring.operation.string.path\"\n                        );\n                    } else {\n                        self.$operator.val(\n                            \"plone.app.querystring.operation.string.relativePath\"\n                        );\n                    }\n                } else if (\n                    self.$operator.val() ===\n                    \"plone.app.querystring.operation.string.relativePath\"\n                ) {\n                    pathAndDepth = [\"..\", \"1\"];\n                }\n\n                self.$value = $('<input type=\"hidden\"/>')\n                    .addClass(self.options.classValueName + \"-\" + widget)\n                    .appendTo($wrapper)\n                    .val(pathAndDepth[0]);\n                self.$value.after(createDepthSelect(pathAndDepth[1]));\n            }\n        } else if (widget === \"ReferenceWidget\") {\n            if (self.advanced) {\n                self.$value = $('<input type=\"text\"/>')\n                    .addClass(self.options.classValueName + \"-\" + widget)\n                    .val(value)\n                    .appendTo($wrapper)\n                    .on(\"change\", function () {\n                        self.trigger(\"value-changed\");\n                    });\n            } else {\n                pathAndDepth = [\"\", \"-1\"];\n                if (typeof value !== \"undefined\") {\n                    pathAndDepth = value.split(\"::\");\n                }\n                self.$value = $('<input type=\"text\"/>')\n                    .addClass(self.options.classValueName + \"-\" + widget)\n                    .appendTo($wrapper)\n                    .val(pathAndDepth[0])\n                const pat = new ContentbrowserPattern(self.$value[0], self.patternRelateditemsOptions);\n                pat.el.addEventListener(\"change\", () => {\n                    self.trigger(\"value-changed\");\n                })\n                self.$value.after(createDepthSelect(pathAndDepth[1]));\n            }\n        } else if (widget === \"MultipleSelectionWidget\") {\n            self.$value = $(\"<select/>\")\n                .prop(\"multiple\", true)\n                .addClass(self.options.classValueName + \"-\" + widget)\n                .appendTo($wrapper)\n                .on(\"change\", function () {\n                    self.trigger(\"value-changed\");\n                });\n            if (self.indexes[index]) {\n                for (const value in self.indexes[index].values) {\n                    const options = self.indexes[index].values[value];\n                    $(\"<option/>\")\n                        .attr(\"value\", value)\n                        .html(options.title)\n                        .appendTo(self.$value);\n                };\n            }\n            self.$value.patternSelect2(self.patternAjaxSelectOptions);\n        }\n\n        if (typeof value !== \"undefined\" && typeof self.$value !== \"undefined\") {\n            if (Array.isArray(self.$value)) {\n                $.each(value, function (i, v) {\n                    self.$value[i].val(v);\n                });\n            } else {\n                var trimmedValue = value;\n                if (typeof value === \"string\" && widget !== \"RelativePathWidget\") {\n                    trimmedValue = value.replace(/::-?[0-9]+/, \"\");\n                }\n                self.$value.val(trimmedValue);\n            }\n        }\n\n        self.trigger(\"create-value\");\n    },\n    createClear: function () {\n        var self = this;\n        self.removeClear();\n        self.$clear = $(\"<div/>\")\n            .addClass(self.options.classClearName)\n            .appendTo(self.$wrapper);\n    },\n    remove: function () {\n        var self = this;\n        self.trigger(\"remove\");\n        self.$remove.remove();\n        self.$index.parent().remove();\n        self.removeOperator();\n        self.removeValue();\n        self.removeClear();\n        self.$wrapper.remove();\n    },\n    removeClear: function () {\n        var self = this;\n        self.trigger(\"remove-clear\");\n        if (self.$clear) {\n            self.$clear.remove();\n        }\n    },\n    removeOperator: function () {\n        var self = this;\n        self.trigger(\"remove-operator\");\n        if (self.$operator) {\n            self.$operator.parent().remove();\n        }\n    },\n    removeValue: function () {\n        var self = this;\n        self.trigger(\"remove-value\");\n        if (self.$value) {\n            if (Array.isArray(self.$value)) {\n                // date ranges have 2 values\n                self.$value[0].parents(\".querystring-criteria-value\").remove();\n            } else {\n                self.$value.parents(\".querystring-criteria-value\").remove();\n            }\n        }\n    },\n    // builds the parameters to go into the http querystring for requesting\n    // results from the query builder\n    buildQueryPart: function () {\n        var self = this;\n\n        // index\n        var ival = self.$index.val();\n        if (ival === \"\") {\n            // no index selected, no query\n            return \"\";\n        }\n        var istr = \"query.i:records=\" + ival;\n\n        // operator\n        if (typeof self.$operator === \"undefined\") {\n            // no operator, no query\n            return \"\";\n        }\n        var oval = self.$operator.val();\n\n        if (ival === \"path\") {\n            if (oval.indexOf(\"advanced\") > 0) {\n                return \"\";\n            }\n            oval = self.convertPathOperators(oval);\n        }\n\n        var ostr = \"query.o:records=\" + oval;\n\n        // value(s)\n        var vstrbase = \"query.v:records=\",\n            vstrlistbase = \"query.v:records:list=\",\n            vstr = [];\n        if (typeof self.$value === \"undefined\") {\n            vstr.push(vstrbase);\n        } else if (Array.isArray(self.$value)) {\n            // handles only datepickers from the 'between' operator right now\n            $.each(self.$value, function () {\n                vstr.push(vstrlistbase + $(this).val());\n            });\n        } else if (Array.isArray(self.$value.val())) {\n            // handles multible values\n            $.each(self.$value.val(), function (i, v) {\n                vstr.push(vstrlistbase + v);\n            });\n        } else {\n            var str = vstrbase + self.$value.val();\n            if (ival === \"path\" && self.$value.val() !== \"\") {\n                str += self.getDepthString();\n            } else if (typeof self.initial !== \"undefined\") {\n                str = vstrbase + self.initial;\n                //Sometimes the RelatedItemsWidget won't be loaded by this point.\n                //This only should happen on the initial page load.\n                delete self.initial;\n            }\n            vstr.push(str);\n        }\n\n        return istr + \"&\" + ostr + \"&\" + vstr.join(\"&\");\n    },\n    getJSONListStr: function () {\n        var self = this;\n\n        // index\n        var ival = self.$index.val();\n        if (ival === \"\") {\n            // no index selected, no query\n            return \"\";\n        }\n\n        // operator\n        if (typeof self.$operator === \"undefined\") {\n            // no operator, no query\n            return \"\";\n        }\n        var oval = self.$operator.val();\n\n        if (ival === \"path\") {\n            if (oval.indexOf(\"advanced\") > 0) {\n                //The advanced function is just a placeholder,\n                //We don't want to send an actual query\n                return \"\";\n            }\n            oval = self.convertPathOperators(oval);\n        }\n        // value(s)\n        var varr = [];\n        if (Array.isArray(self.$value)) {\n            // handles only datepickers from the 'between' operator right now\n            $.each(self.$value, function () {\n                varr.push($(this).val());\n            });\n        } else if (typeof self.$value !== \"undefined\") {\n            var value = self.$value.val();\n            if (ival === \"path\" && value) {\n                var depth = self.getDepthString();\n                if (depth) {\n                    value += depth;\n                }\n            }\n            varr.push(value);\n        }\n        var vval;\n        if (varr.length > 1) {\n            vval = '[\"' + varr.join('\",\"') + '\"]';\n        } else if (varr.length === 1) {\n            vval = JSON.stringify(varr[0]);\n        } else {\n            vval = '\"\"';\n        }\n\n        if (typeof self.indexes[ival].operators[oval] === \"undefined\") {\n            return;\n        }\n\n        return '{\"i\":\"' + ival + '\", \"o\":\"' + oval + '\", \"v\":' + vval + \"}\";\n    },\n    getDepthString: function () {\n        var self = this,\n            out = \"\",\n            depth = $(\".\" + self.options.classDepthName).val();\n\n        if (depth !== \"\" && typeof depth !== \"undefined\") {\n            out += \"::\" + depth;\n        }\n        return out;\n    },\n    trigger: function (name) {\n        this.$wrapper.trigger(name + \"-criteria.querystring.patterns\", [this]);\n    },\n    on: function (name, callback) {\n        this.$wrapper.on(name + \"-criteria.querystring.patterns\", callback);\n    },\n};\n\nexport default Base.extend({\n    name: \"querystring\",\n    trigger: \".pat-querystring\",\n    parser: \"mockup\",\n    defaults: {\n        indexes: [],\n        classWrapperName: \"querystring-wrapper\",\n        criteria: {},\n        indexOptionsUrl: null,\n        previewURL: \"portal_factory/@@querybuilder_html_results\", // base url to use to request preview information from\n        previewCountURL: \"portal_factory/@@querybuildernumberofresults\",\n        patternDateOptions: {},\n        patternAjaxSelectOptions: {},\n        patternRelateditemsOptions: {},\n        classSortLabelName: \"querystring-sort-label\",\n        classSortReverseName: \"querystring-sortreverse\",\n        classSortReverseLabelName: \"querystring-sortreverse-label\",\n        classPreviewCountWrapperName: \"querystring-previewcount-wrapper\",\n        classPreviewResultsWrapperName: \"querystring-previewresults-wrapper\",\n        classPreviewWrapperName: \"querystring-preview-wrapper\",\n        classPreviewName: \"querystring-preview\",\n        classPreviewTitleName: \"querystring-preview-title\",\n        classPreviewDescriptionName: \"querystring-preview-description\",\n        classSortWrapperName: \"querystring-sort-wrapper\",\n        showPreviews: true,\n    },\n    init: async function () {\n        await import(\"../select2/select2\");\n\n        import(\"./querystring.scss\");\n\n        var self = this;\n\n        // hide input element\n        self.$el.hide();\n\n        // create wrapper for out criteria\n        self.$wrapper = $(\"<div/>\");\n        self.$el.after(self.$wrapper);\n\n        // initialization can be detailed if by ajax\n        self.initialized = false;\n\n        // get remove icon for criterias\n        self.options.criteria.remove = await utils.resolveIcon(\"x-circle\");\n\n        if (self.options.indexOptionsUrl) {\n            try {\n                const response = await fetch(self.options.indexOptionsUrl);\n                const data = await response.json();\n                self.options.indexes = data.indexes;\n                self.options[\"sortable_indexes\"] = data[\"sortable_indexes\"];\n                self._init();\n            } catch {\n                // XXX handle this...\n            }\n        }\n    },\n    _init: function () {\n        var self = this;\n        self.$criteriaWrapper = $(\"<div/>\")\n            .addClass(self.options.classWrapperName)\n            .appendTo(self.$wrapper);\n\n        self.$sortWrapper = $(\"<div/>\")\n            .addClass(self.options.classSortWrapperName)\n            .appendTo(self.$wrapper);\n\n        if (self.options.showPreviews === \"false\") {\n            self.options.showPreviews = false;\n        }\n        if (self.options.showPreviews) {\n            self.$previewWrapper = $(\"<div/>\")\n                .addClass(self.options.classPreviewWrapperName)\n                .appendTo(self.$wrapper);\n\n            // preview title and description\n            $(\"<div/>\")\n                .addClass(self.options.classPreviewTitleName)\n                .html(_t(\"Preview\"))\n                .appendTo(self.$previewWrapper);\n            $(\"<div/>\")\n                .addClass(self.options.classPreviewDescriptionName)\n                .html(_t(\"Preview of at most 10 items\"))\n                .appendTo(self.$previewWrapper);\n        }\n\n        self.criterias = [];\n\n        // create populated criterias\n        if (self.el.value) {\n            for (const item of JSON.parse(self.el.value)) {\n                self.createCriteria(item.i, item.o, item.v);\n            }\n        }\n\n        // add empty criteria which enables users to create new cr\n        self.createCriteria();\n\n        // add sort/order fields\n        self.createSort();\n\n        // add criteria preview pane to see results from criteria query\n        if (self.options.showPreviews) {\n            self.refreshPreviewEvent();\n        }\n        self.$el.trigger(\"initialized\");\n        self.initialized = true;\n    },\n    createCriteria: function (index, operator, value) {\n        var self = this,\n            baseUrl = self.options.indexOptionsUrl.replace(/(@@.*)/g, \"\"),\n            criteria = new Criteria(\n                self.$criteriaWrapper,\n                self,\n                self.options.criteria,\n                self.options.indexes,\n                index,\n                operator,\n                value,\n                baseUrl,\n                self.options.patternDateOptions,\n                self.options.patternAjaxSelectOptions,\n                self.options.patternRelateditemsOptions\n            );\n\n        criteria.on(\"remove\", function () {\n            if (self.criterias[self.criterias.length - 1] === criteria) {\n                self.createCriteria();\n            }\n        });\n\n        criteria.on(\"index-changed\", function () {\n            if (self.criterias[self.criterias.length - 1] === criteria) {\n                self.createCriteria();\n            }\n        });\n\n        //This prevents multiple requests from going off after making a single change\n        var _doupdates = function () {\n            self.refreshPreviewEvent();\n            self.updateValue();\n        };\n        var _updateTimeout = -1;\n        var doupdates = function () {\n            clearTimeout(_updateTimeout);\n            _updateTimeout = setTimeout(_doupdates, 100);\n        };\n\n        criteria.on(\"remove\", function (e, criteria) {\n            if (self.criterias.indexOf(criteria) !== -1) {\n                self.criterias.splice(self.criterias.indexOf(criteria), 1);\n            }\n            doupdates(e, criteria);\n        });\n        criteria.on(\"remove-clear\", doupdates);\n        criteria.on(\"remove-operator\", doupdates);\n        criteria.on(\"remove-value\", doupdates);\n        criteria.on(\"index-changed\", doupdates);\n        criteria.on(\"operator-changed\", doupdates);\n        criteria.on(\"create-criteria\", doupdates);\n        criteria.on(\"create-operator\", doupdates);\n        criteria.on(\"create-value\", doupdates);\n        criteria.on(\"value-changed\", doupdates);\n        criteria.on(\"depth-changed\", doupdates);\n\n        self.criterias.push(criteria);\n    },\n    createSort: function () {\n        var self = this;\n\n        // elements that may exist already on the page\n        // XXX do this in a way so it'll work with other forms will work\n        // as long as they provide sort_on and sort_reversed fields in z3c form\n        var existingSortOn = $('[id$=\"-sort_on\"]').filter('[id^=\"formfield-\"]');\n        var existingSortOrder = $('[id*=\"-sort_reversed\"]').filter('[id^=\"formfield-\"]');\n\n        $(\"<span/>\")\n            .addClass(self.options.classSortLabelName)\n            .html(_t(\"Sort on\"))\n            .appendTo(self.$sortWrapper);\n        self.$sortOn = $(\"<select/>\")\n            .attr(\"name\", \"sort_on\")\n            .appendTo(self.$sortWrapper)\n            .on(\"change\", function () {\n                self.refreshPreviewEvent();\n                $('[id$=\"sort_on\"]', existingSortOn).val($(this).val());\n            });\n\n        self.$sortOn.append($('<option value=\"\">' + _t(\"No sorting\") + \"</option>\")); // default no sorting\n        for (var key in self.options[\"sortable_indexes\"]) {\n            self.$sortOn.append(\n                $(\"<option/>\").attr(\"value\", key).html(self.options.indexes[key].title)\n            );\n        }\n        self.$sortOn.patternSelect2({ width: \"150px\" });\n\n        self.$sortOrder = $('<input type=\"checkbox\" />')\n            .attr(\"name\", \"sort_reversed:boolean\")\n            .on(\"change\", function () {\n                self.refreshPreviewEvent();\n                if ($(this).prop(\"checked\")) {\n                    $('input[type=\"checkbox\"]', existingSortOrder).prop(\"checked\", true);\n                } else {\n                    $('input[type=\"checkbox\"]', existingSortOrder).prop(\n                        \"checked\",\n                        false\n                    );\n                }\n            });\n\n        $(\"<span/>\")\n            .addClass(self.options.classSortReverseName)\n            .appendTo(self.$sortWrapper)\n            .append(self.$sortOrder)\n            .append(\n                $(\"<span/>\")\n                    .html(_t(\"Reversed Order\"))\n                    .addClass(self.options.classSortReverseLabelName)\n            );\n\n        // if the form already contains the sort fields, hide them! Their values\n        // will be synced back and forth between the querystring's form elements\n        if (existingSortOn.length >= 1 && existingSortOrder.length >= 1) {\n            var reversed = $('input[type=\"checkbox\"]', existingSortOrder).prop(\n                \"checked\"\n            );\n            var sortOn = $('[id$=\"-sort_on\"]', existingSortOn).val();\n            if (reversed) {\n                self.$sortOrder.prop(\"checked\", true);\n            }\n            self.$sortOn.val(sortOn);\n            $(existingSortOn).hide();\n            $(existingSortOrder).hide();\n        }\n    },\n    refreshPreviewEvent: function () {\n        var self = this;\n\n        if (!self.options.showPreviews) {\n            return; // cut out of this if there are no previews available\n        }\n\n        if (typeof self._previewXhr !== \"undefined\") {\n            self._previewXhr.abort();\n        }\n\n        if (typeof self.$previewPane !== \"undefined\") {\n            self.$previewPane.remove();\n        }\n\n        var query = [];\n        for (const criteria of self.criterias) {\n            var querypart = criteria.buildQueryPart();\n            if (querypart !== \"\") {\n                query.push(querypart);\n            }\n        };\n\n        self.$previewPane = $(\"<div/>\")\n            .addClass(self.options.classPreviewName)\n            .appendTo(self.$previewWrapper);\n\n        if (query.length <= 0) {\n            $(\"<div/>\")\n                .addClass(self.options.classPreviewCountWrapperName)\n                .html(\"No results to preview\")\n                .prependTo(self.$previewPane);\n            return; // no query means nothing to send out requests for\n        }\n\n        query.push(\"sort_on=\" + self.$sortOn.val());\n        if (self.$sortOrder.prop(\"checked\")) {\n            query.push(\"sort_order=reverse\");\n        }\n\n        self._previewXhr = $.ajax({\n            url: self.options.previewURL + \"?\" + query.join(\"&\"),\n            success: (data) => {\n                $(\"<div/>\")\n                    .addClass(self.options.classPreviewResultsWrapperName)\n                    .html(utils.parseBodyTag(data))\n                    .appendTo(self.$previewPane);\n            },\n        });\n    },\n    updateValue: function () {\n        // updating the original input with json data in the form:\n        // [\n        //    {i:'index', o:'operator', v:'value'}\n        // ]\n\n        var self = this;\n\n        var criteriastrs = [];\n        for (const criteria of self.criterias) {\n            var jsonstr = criteria.getJSONListStr();\n            if (jsonstr !== \"\") {\n                criteriastrs.push(jsonstr);\n            }\n        }\n        var val = \"[\" + criteriastrs.join(\",\") + \"]\";\n        self.$el.val(val);\n        self.$el.trigger(\"change\");\n    },\n});\n","import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport logger from \"@patternslib/patternslib/src/core/logging\";\n\nconst log = logger.getLogger(\"pat-toggle\");\n\nexport default Base.extend({\n    name: \"toggle\",\n    trigger: \".pat-toggle\",\n    parser: \"mockup\",\n    defaults: {\n        attribute: \"class\",\n        event: \"click\",\n        targetScope: \"global\",\n    },\n    init: function () {\n        var self = this;\n\n        if (!self.options.target) {\n            self.$target = self.$el;\n        } else if (self.options.targetScope === \"global\") {\n            self.$target = $(self.options.target);\n        } else {\n            //self.$target = self.$el[self.options.menu](self.options.target);\n            self.$target = self.$el\n                .parents(self.options.targetScope)\n                .first()\n                .find(self.options.target);\n        }\n\n        if (!self.$target || self.$target.length === 0) {\n            log.error(`No target found for \"${self.options.target}\".`);\n        }\n\n        self.on(self.options.event, function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n            self.toggle();\n        });\n    },\n    isMarked: function () {\n        var self = this;\n        var marked = false;\n\n        for (var i = 0; i < this.$target.length; i = i + 1) {\n            if (self.options.attribute === \"class\") {\n                if (this.$target.eq(i).hasClass(this.options.value)) {\n                    marked = true;\n                } else {\n                    marked = false;\n                    break;\n                }\n            } else {\n                if (\n                    this.$target.eq(i).attr(this.options.attribute) ===\n                    this.options.value\n                ) {\n                    marked = true;\n                } else {\n                    marked = false;\n                    break;\n                }\n            }\n        }\n        return marked;\n    },\n    toggle: function () {\n        var self = this;\n        if (self.isMarked()) {\n            self.remove();\n        } else {\n            self.add();\n        }\n    },\n    remove: function () {\n        var self = this;\n        self.emit(\"remove-attr\");\n        if (self.options.attribute === \"class\") {\n            self.$target.removeClass(self.options.value);\n        } else {\n            self.$target.removeAttr(self.options.attribute);\n        }\n        self.emit(\"attr-removed\");\n    },\n    add: function () {\n        var self = this;\n        self.emit(\"add-attr\");\n        if (self.options.attribute === \"class\") {\n            self.$target.addClass(self.options.value);\n        } else {\n            self.$target.attr(self.options.attribute, self.options.value);\n        }\n        self.emit(\"added-attr\");\n    },\n});\n","import Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"registry\",\n    trigger: \".pat-registry\",\n    parser: \"mockup\",\n    init: async function () {\n        const implementation = (await import(\"./registry--implementation.js\")).default;\n        const reg = new implementation(this.el);\n        reg.init();\n    },\n});\n","import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"sortable\",\n    trigger: \".pat-sortable\",\n    parser: \"mockup\",\n    defaults: {\n        selector: \"li\",\n        dragClass: \"item-dragging\",\n        cloneClass: \"dragging\",\n        drop: undefined, // callback function or name of global function\n    },\n    init: async function () {\n        let Sortable = await import(\"sortablejs\");\n        Sortable = Sortable.default;\n        this.sortable = new Sortable(this.$el[0], {\n            animation: 150,\n            draggable: this.options.selector,\n            chosenClass: this.options.dragClass,\n            dragClass: this.options.cloneClass,\n            onEnd: function (e) {\n                var cb = this.options.drop;\n                if (!cb) {\n                    return;\n                }\n                if (typeof cb === \"string\") {\n                    cb = window[this.options.drop];\n                }\n                cb($(e.item), e.newIndex - e.oldIndex);\n            }.bind(this),\n        });\n    },\n    disableSort: function () {\n        this.sortable.option(\"sort\", false);\n    },\n    enableSort: function () {\n        this.sortable.option(\"sort\", true);\n    },\n});\n","import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport registry from \"@patternslib/patternslib/src/core/registry\";\nimport utils from \"../../core/utils\";\nimport Cookies from \"js-cookie\";\n\nexport default Base.extend({\n    name: \"toolbar\",\n    trigger: \".pat-toolbar\",\n    parser: \"mockup\",\n    defaults: {},\n\n    init: function () {\n        $(\"body\").on(\"structure-url-changed\", (e, path) => {\n            $.ajax({\n                url: $(\"body\").attr(\"data-portal-url\") + path + \"/@@render-toolbar\",\n            }).done((data) => {\n                const wrapper = $(utils.parseBodyTag(data));\n                const $main_toolbar = wrapper.find(\"#edit-zone .plone-toolbar-main\");\n                const $personal_tools = wrapper.find(\n                    \"#edit-zone #collapse-personaltools\"\n                );\n                // setup modals\n                registry.scan($main_toolbar);\n                $(\".plone-toolbar-main\", this.$el).replaceWith($main_toolbar);\n                $(\"#collapse-personaltools\", this.$el).replaceWith($personal_tools);\n            });\n        });\n\n        // unpin toolbar and save state\n        this.$el.on(\"click\", \".toolbar-collapse\", () => {\n            $(\"body\").removeClass(\"plone-toolbar-left-expanded\");\n            Cookies.set(\"plone-toolbar\", JSON.stringify({ expanded: false }), {\n                path: \"/\",\n            });\n        });\n\n        // pin toolbar and save state\n        this.$el.on(\"click\", \".toolbar-expand\", () => {\n            $(\"body\").addClass(\"plone-toolbar-left-expanded\");\n            Cookies.set(\"plone-toolbar\", JSON.stringify({ expanded: true }), {\n                path: \"/\",\n            });\n        });\n\n        this.el.classList.add(\"initialized\");\n    },\n});\n","/**\n * Get a universally unique id (uuid).\n *\n * @returns {String} - The uuid.\n */\nconst create_uuid = () => {\n    let uuid;\n    if (window.crypto.randomUUID) {\n        // Create a real UUID\n        // window.crypto.randomUUID does only exist in browsers with secure\n        // context.\n        // See: https://developer.mozilla.org/en-US/docs/Web/API/Crypto/randomUUID\n        uuid = window.crypto.randomUUID();\n    } else {\n        // Create a sufficiently unique ID\n        const array = new Uint32Array(4);\n        uuid = window.crypto.getRandomValues(array).join(\"\");\n    }\n    return uuid;\n};\nexport default create_uuid;\n","// Polyfills for modern browsers\n\n// SubmitEvent.submitter polyfill for Safari < 15.4 and jsDOM\n// Original code: https://stackoverflow.com/a/61110260/1337474\n// Also see: https://caniuse.com/?search=submitter\n// NOTE: the `submitter` property is now widely available except for ancient browsers and jsDOM.\n!(function () {\n    if (window.SubmitEvent && \"submitter\" in window.SubmitEvent.prototype) {\n        // `submitter` attribute is already supported.\n        return;\n    }\n\n    let last_btn = null;\n    const submitable_buttons = `button, input[type=\"button\"], input[type=\"submit\"], input[type=\"image\"]`;\n    document.addEventListener(\n        \"click\",\n        function (e) {\n            if (!e.target.closest) return;\n            last_btn = e.target.closest(submitable_buttons);\n        },\n        true\n    );\n    document.addEventListener(\n        \"submit\",\n        function (e) {\n            if (\"submitter\" in e) return;\n            const canditates = [document.activeElement, last_btn];\n            last_btn = null;\n            for (const candidate of canditates) {\n                if (!candidate) continue;\n                if (!candidate.form) continue;\n                if (!candidate.matches(submitable_buttons)) continue;\n                e.submitter = candidate;\n                return;\n            }\n            e.submitter = e.target.querySelector(submitable_buttons);\n        },\n        true\n    );\n})();\n\n// Navigation polyfill for Firefox and Safari, as of 2024-01-04\n// NOTE: this is a very basic polyfill, it only supports firing a `navigate`\n// event on location change and even that without interception support, etc.\n!(function () {\n    if (window.navigation == undefined) {\n\n        class NavigateEvent extends CustomEvent {\n            constructor() {\n                super(\"navigate\");\n                this.destination = { url: undefined };\n            }\n        }\n\n        // Create a navigation object on the window\n        // We create a DOM element for the navigation object so that we can\n        // attach events on it.\n        window.navigation = document.createElement(\"div\");\n\n        const create_event = (args) => {\n            const event = new NavigateEvent();\n            event.destination.url = args[2];\n            return event;\n        };\n\n        // Patch pushState to trigger an `navigate` event on the navigation\n        // object when the URL changes.\n        const pushState = window.history.pushState;\n        window.history.pushState = function () {\n            pushState.apply(window.history, arguments);\n            window.navigation.dispatchEvent(create_event(arguments));\n        };\n\n        // Same with replaceState\n        const replaceState = window.history.replaceState;\n        window.history.replaceState = function () {\n            replaceState.apply(window.history, arguments);\n            window.navigation.dispatchEvent(create_event(arguments));\n        };\n    }\n})();\n","import Base from \"../../core/base\";\nimport Parser from \"../../core/parser\";\nimport dom from \"../../core/dom\";\nimport logging from \"../../core/logging\";\nimport utils from \"../../core/utils\";\n\n// Lazy loading modules.\nlet Moment;\n\nconst log = logging.getLogger(\"pat-display-time\");\n\nexport const parser = new Parser(\"display-time\");\n// input datetime options\nparser.add_argument(\"format\", \"\");\nparser.add_argument(\"locale\", null);\nparser.add_argument(\"strict\", false);\n// output options\nparser.add_argument(\"from-now\", false);\nparser.add_argument(\"no-suffix\", false);\nparser.add_argument(\"output-format\", null);\n\nexport default Base.extend({\n    name: \"display-time\",\n    trigger: \".pat-display-time\",\n\n    async init() {\n        Moment = (await import(\"moment\")).default;\n\n        this.options = parser.parse(this.el, this.options);\n\n        let lang = this.options.locale || dom.acquire_attribute(this.el, \"lang\") || \"en\";\n        // we don't support any country-specific language variants, always use first 2 letters\n        lang = lang.substr(0, 2).toLowerCase();\n        try {\n            await import(`moment/locale/${lang}.js`);\n            Moment.locale(lang);\n            this.lang = lang;\n        } catch {\n            Moment.locale(\"en\");\n            this.lang = \"en\";\n        }\n        log.debug(`Moment.js language used: ${lang}.`);\n        this.format();\n    },\n\n    format() {\n        const datetime = this.el.getAttribute(\"datetime\");\n        let out = \"\";\n        if (datetime) {\n            const date = Moment(datetime, this.options.format, this.options.strict);\n            out = date;\n            if (this.options.fromNow === true) {\n                if (utils.is_iso_date(datetime)) {\n                    // date-only case.\n                    const rtf = new Intl.RelativeTimeFormat(this.lang, {\n                        numeric: \"auto\",\n                    });\n                    const date_diff = utils.date_diff(date.toDate(), new Date());\n                    out = date.calendar(null, {\n                        // when the date is closer, specify custom values\n                        lastWeek: `[${rtf.format(date_diff, \"day\")}]`, // translates to \"x days ago\"\n                        lastDay: `[${rtf.format(-1, \"day\")}]`, // translates to \"yesterday\"\n                        sameDay: `[${rtf.format(0, \"day\")}]`, // translates to \"today\"\n                        nextDay: `[${rtf.format(1, \"day\")}]`, // translates to \"tomorrow\"\n                        nextWeek: \"dddd\", // translates to week day name\n                        // otherwise, just use Intl.RelativeTimeFormat.\n                        sameElse: () => {\n                            return `[${rtf.format(date_diff, \"day\")}]`;\n                        },\n                    });\n                } else {\n                    // datetime case.\n                    out = date.fromNow(this.options.noSuffix);\n                }\n            } else if (this.options.outputFormat) {\n                out = date.format(this.options.outputFormat);\n            }\n        }\n        this.el.textContent = out;\n    },\n});\n","import Base from \"@patternslib/patternslib/src/core/base\";\n\nexport default Base.extend({\n    name: \"contentrules-elements\",\n    trigger: \"pat-contentrules-elements\",\n\n    async init() {\n        // Async import implementation to reduce bundle size for controlpanels\n        const implementation = (await import(\"./contentrule-elements--implementation\"))\n            .default;\n        const instance = new implementation(this.el);\n        instance.init();\n    },\n});\n","import $ from \"jquery\";\nimport _ from \"underscore\";\nimport _t from \"../../core/i18n-wrapper\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport dom from \"@patternslib/patternslib/src/core/dom\";\n\nexport default Base.extend({\n    name: \"livesearch\",\n    trigger: \".pat-livesearch\",\n    parser: \"mockup\",\n    timeout: null,\n    active: false,\n    results: null,\n    selectedItem: -1,\n    resultsClass: \"livesearch-results list-group d-none\",\n    defaults: {\n        ajaxUrl: null,\n        defaultSortOn: \"\",\n        perPage: 7,\n        quietMillis: 350,\n        timeoutHide: 200,\n        minimumInputLength: 4,\n        inputSelector: 'input[type=\"text\"]',\n        itemTemplate:\n            '<li class=\"search-result <%- state %> list-group-item list-group-item-action\">' +\n            '<a class=\"text-reset text-decoration-none\" href=\"<%- url %>\">' +\n            '<div class=\"row\">' +\n            '<div class=\"col info\">' +\n            '<div class=\"heading\"><%- title %></div>' +\n            '<div class=\"description\"><%- description %></div>' +\n            \"</div>\" +\n            \"<% if (img_tag) { %> \" +\n            '<div class=\"col img\">' +\n            \"<%= img_tag %>\" +\n            \"</div>\" +\n            \"<% } %> \" +\n            \"</div>\" +\n            \"</a>\" +\n            \"</li>\",\n    },\n    doSearch: function (page) {\n        var self = this;\n        self.active = true;\n        self.render();\n        self.$el.addClass(\"searching\");\n        var query = self.$el.serialize();\n        if (page === undefined) {\n            page = 1;\n        }\n        var sort_on = (function () {\n            var parameters = location.search,\n                sorton_position = parameters.indexOf(\"sort_on\");\n            if (sorton_position === -1) {\n                // return default sort\n                var $searchResults = $(\"#search-results\");\n                if ($searchResults.length > 0) {\n                    return $searchResults.attr(\"data-default-sort\");\n                }\n                return self.options.defaultSortOn;\n            }\n            // cut string before sort_on parameter\n            var sort_on = parameters.substring(sorton_position);\n            // cut other parameters\n            sort_on = sort_on.split(\"&\")[0];\n            // get just the value\n            sort_on = sort_on.split(\"=\")[1];\n            return sort_on;\n        })();\n\n        $.ajax({\n            url:\n                self.options.ajaxUrl +\n                \"?\" +\n                query +\n                \"&page=\" +\n                page +\n                \"&perPage=\" +\n                self.options.perPage +\n                \"&sort_on=\" +\n                sort_on,\n            dataType: \"json\",\n        })\n            .done(function (data) {\n                self.results = data;\n                self.page = page;\n                // maybe odd here.. but we're checking to see if the user\n                // has typed while a search was being performed. Perhap another search if so\n                if (query !== self.$el.serialize()) {\n                    self.doSearch();\n                }\n            })\n            .fail(function () {\n                self.results = {\n                    items: [\n                        {\n                            url: \"\",\n                            title: _t(\"Error\"),\n                            description: _t(\"There was an error searching…\"),\n                            state: \"error\",\n                            error: false,\n                        },\n                    ],\n                    total: 1,\n                };\n                self.page = 1;\n            })\n            .always(function () {\n                self.active = false;\n                self.selectedItem = -1;\n                self.$el.removeClass(\"searching\");\n                self.render();\n            });\n    },\n    render: function () {\n        var self = this;\n        self.$results.empty();\n\n        /* find a status message */\n\n        if (self.active) {\n            self.$results.append(\n                $('<li class=\"searching list-group-item\">' + _t(\"searching…\") + \"</li>\")\n            );\n        } else if (self.results === null) {\n            // no results gathered yet\n            self.$results.append(\n                $(\n                    '<li class=\"no-results no-search list-group-item\">' +\n                        _t(\"enter search phrase\") +\n                        \"</li>\"\n                )\n            );\n        } else if (self.results.total === 0) {\n            self.$results.append(\n                $(\n                    '<li class=\"no-results list-group-item\">' +\n                        _t(\"no results found\") +\n                        \"</li>\"\n                )\n            );\n        } else {\n            self.$results.append(\n                $(\n                    '<li class=\"results-summary list-group-item\">' +\n                        _t(\"found\") +\n                        \" \" +\n                        self.results.total +\n                        \" \" +\n                        _t(\"results\") +\n                        \"</li>\"\n                )\n            );\n        }\n\n        if (self.results !== null) {\n            var template = _.template(self.options.itemTemplate);\n            _.each(self.results.items, function (item, index) {\n                var $el = $(template($.extend({ _t: _t }, item)));\n                $el.attr(\"data-url\", item.url).on(\"click\", function () {\n                    if (!item.error) {\n                        window.location = item.url;\n                    }\n                });\n                if (index === self.selectedItem) {\n                    $el.addClass(\"active\");\n                }\n                self.$results.append($el);\n            });\n            var nav = {};\n            if (self.page > 1) {\n                var $prev = $(\n                    '<a href=\"#\" class=\"prev position-absolute ps-3 start-0\">' +\n                        _t(\"Previous\") +\n                        \"</a>\"\n                );\n                $prev.on(\"click\", function (e) {\n                    self.disableHiding = true;\n                    e.preventDefault();\n                    self.doSearch(self.page - 1);\n                });\n                nav.prev = $prev;\n            }\n            if (self.page * self.options.perPage < self.results.total) {\n                var $next = $(\n                    '<a href=\"#\" class=\"next position-absolute pe-3 end-0\">' +\n                        _t(\"Next\") +\n                        \"</a>\"\n                );\n                $next.on(\"click\", function (e) {\n                    self.disableHiding = true;\n                    e.preventDefault();\n                    self.doSearch(self.page + 1);\n                });\n                nav.next = $next;\n            }\n            if (nav.next || nav.prev) {\n                var $li = $(\n                    '<li class=\"list-group-item load-more d-flex justify-content-center\"><span class=\"page\">' +\n                        self.page +\n                        \"</span></li>\"\n                );\n                if (nav.prev) {\n                    $li.prepend(nav.prev);\n                }\n                if (nav.next) {\n                    $li.append(nav.next);\n                }\n                self.$results.append($li);\n            }\n        }\n        self.show();\n    },\n    show: function () {\n        /* we are positioning directly below the\n         input box, same width */\n        var self = this;\n\n        self.$results[0].classList.remove(\"d-none\");\n        self.$el[0].classList.add(\"livesearch-active\");\n    },\n    hide: function () {\n        this.$el[0].classList.remove(\"livesearch-active\");\n        this.$results[0].classList.add(\"d-none\");\n    },\n    init: function () {\n        // import(\"./livesearch.scss\");\n\n        var self = this;\n\n        self.$input = self.$el.find(self.options.inputSelector);\n        self.$input\n            .off(\"focusout\")\n            .on(\"focusout\", function () {\n                /* we put this in a timer so click events still\n           get trigger on search results */\n                setTimeout(function () {\n                    /* hack, look above, to handle dealing with clicks\n             unfocusing element */\n                    if (!self.disableHiding) {\n                        self.hide();\n                    } else {\n                        self.disableHiding = false;\n                        // and refocus elemtn\n                        self.$input.focus();\n                    }\n                }, self.options.timeoutHide);\n            })\n            .off(\"focusin\")\n            .on(\"focusin\", function () {\n                if (!self.onceFocused) {\n                    /* Case: field already filled out but no reasons\n             present yet, do ajax search and grab some results */\n                    self.onceFocused = true;\n                    if (self.$input.val().length >= self.options.minimumInputLength) {\n                        self.doSearch();\n                    }\n                } else if (!dom.is_visible(self.$results[0])) {\n                    self.render();\n                }\n            })\n            .attr(\"autocomplete\", \"off\")\n            .off(\"keyup\")\n            .on(\"keyup\", function (e) {\n                var code = e.keyCode || e.which;\n                // first off, we're capturing esc presses\n                if (code === 27) {\n                    self.$input.val(\"\");\n                    self.hide();\n                    return;\n                }\n                // then, we're capturing up, down and enter key presses\n                if (\n                    self.results &&\n                    self.results.items &&\n                    self.results.items.length > 0\n                ) {\n                    if (code === 13) {\n                        /* enter key, check to see if there is a selected item */\n                        if (self.selectedItem !== -1) {\n                            window.location = self.results.items[self.selectedItem].url;\n                        }\n                        return;\n                    } else if (code === 38) {\n                        /* up key */\n                        if (self.selectedItem !== -1) {\n                            self.selectedItem -= 1;\n                            self.render();\n                        }\n                        return;\n                    } else if (code === 40) {\n                        /* down key */\n                        if (self.selectedItem < self.results.items.length) {\n                            self.selectedItem += 1;\n                            self.render();\n                        }\n                        return;\n                    }\n                }\n\n                /* then, we handle timeouts for doing ajax search */\n                if (self.timeout !== null) {\n                    clearTimeout(self.timeout);\n                    self.timeout = null;\n                }\n                if (self.active) {\n                    return;\n                }\n                if (self.$input.val().length >= self.options.minimumInputLength) {\n                    self.timeout = setTimeout(function () {\n                        self.doSearch();\n                    }, self.options.quietMillis);\n                } else {\n                    self.results = null;\n                    self.render();\n                }\n            });\n        $(\"#sorting-options a\").on(\"click\", function (e) {\n            e.preventDefault();\n            self.onceFocused = false;\n        });\n\n        /* create result dom */\n        self.$results = $('<ul class=\"' + self.resultsClass + '\"></ul>').insertAfter(\n            self.$el\n        );\n    },\n});\n","import $ from \"jquery\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport logger from \"@patternslib/patternslib/src/core/logging\";\nimport registry from \"@patternslib/patternslib/src/core/registry\";\nimport utils from \"../../core/utils\";\nimport _ from \"underscore\";\n\nconst log = logger.getLogger(\"pat-contentloader\");\n\nexport default Base.extend({\n    name: \"contentloader\",\n    trigger: \".pat-contentloader\",\n    parser: \"mockup\",\n    defaults: {\n        url: null,\n        content: null,\n        trigger: \"click\",\n        target: null,\n        template: null,\n        dataType: \"html\",\n    },\n    init: function () {\n        var that = this;\n        if (that.options.url === \"el\" && that.$el[0].tagName === \"A\") {\n            that.options.url = that.$el.attr(\"href\");\n        }\n        that.$el.removeClass(\"loading-content\");\n        that.$el.removeClass(\"content-load-error\");\n        if (that.options.trigger === \"immediate\") {\n            that._load();\n        } else {\n            that.$el.on(that.options.trigger, function (e) {\n                e.preventDefault();\n                that._load();\n            });\n        }\n    },\n    _load: function () {\n        var that = this;\n        that.$el.addClass(\"loading-content\");\n        if (that.options.url) {\n            that.loadRemote();\n        } else {\n            that.loadLocal();\n        }\n    },\n    loadRemote: function () {\n        var that = this;\n        $.ajax({\n            url: that.options.url,\n            dataType: that.options.dataType,\n            success: function (data) {\n                var $el;\n                if (that.options.dataType === \"html\") {\n                    if (data.indexOf(\"<html\") !== -1) {\n                        data = utils.parseBodyTag(data);\n                    }\n                    $el = $(\"<div>\" + data + \"</div>\"); // jQuery starts to search at the first child element.\n                } else if (that.options.dataType.indexOf(\"json\") !== -1) {\n                    // must have template defined with json\n                    if (data.constructor === Array && data.length === 1) {\n                        // normalize json if it makes sense since some json returns as array with one item\n                        data = data[0];\n                    }\n                    try {\n                        $el = $(_.template(that.options.template)(data));\n                    } catch {\n                        that.$el.removeClass(\"loading-content\");\n                        that.$el.addClass(\"content-load-error\");\n                        log.warn(\n                            \"error rendering template. pat-contentloader will not work\"\n                        );\n                        return;\n                    }\n                }\n                if (that.options.content !== null) {\n                    $el = $el.find(that.options.content);\n                }\n                that.loadLocal($el);\n            },\n            error: function () {\n                that.$el.removeClass(\"loading-content\");\n                that.$el.addClass(\"content-load-error\");\n            },\n        });\n    },\n    loadLocal: function ($content) {\n        var that = this;\n        if (!$content && that.options.content === null) {\n            that.$el.removeClass(\"loading-content\");\n            that.$el.addClass(\"content-load-error\");\n            log.warn(\"No selector configured\");\n            return;\n        }\n        var $target = that.$el;\n        if (that.options.target !== null) {\n            $target = $(that.options.target);\n            if ($target.length === 0) {\n                that.$el.removeClass(\"loading-content\");\n                that.$el.addClass(\"content-load-error\");\n                log.warn(\"No target nodes found\");\n                return;\n            }\n        }\n\n        if (!$content) {\n            $content = $(that.options.content).clone();\n        }\n        if ($content.length) {\n            $content.show();\n            $target.replaceWith($content);\n            registry.scan($content);\n        } else {\n            // empty target node instead of removing it.\n            // allows for subsequent content loader calls to work sucessfully.\n            $target.empty();\n        }\n\n        that.$el.removeClass(\"loading-content\");\n        that.emit(\"loading-done\");\n    },\n});\n","import Base from \"../../core/base\";\nimport events from \"../../core/events\";\nimport utils from \"../../core/utils\";\n\nexport default Base.extend({\n    name: \"close-panel\",\n    trigger: \".close-panel\",\n\n    init() {\n        // Close panel support for dialog panels\n        // Other modals are handled in pat-modal.\n        const dialog_panel = this.el.closest(\"dialog\");\n        if (dialog_panel) {\n            events.add_event_listener(\n                dialog_panel,\n                \"close-panel\",\n                \"close-panel--dialog\",\n                () => {\n                    dialog_panel.close();\n                }\n            );\n        }\n\n        this.el.addEventListener(\"click\", async (e) => {\n            await utils.timeout(0); // Wait for other patterns, like pat-validation.\n\n            if (\n                e.target.matches(\":not([formnovalidate])\") &&\n                e.target.matches(\"[type=submit], button:not([type=button])\") &&\n                this.el.closest(\"form\")?.checkValidity() === false\n            ) {\n                // Prevent closing an invalid form when submitting.\n                return;\n            }\n\n            this.el.dispatchEvent(\n                new Event(\"close-panel\", { bubbles: true, cancelable: true })\n            );\n        });\n    },\n});\n","import $ from \"jquery\";\nimport { BasePattern } from \"../../core/basepattern\";\nimport logging from \"../../core/logging\";\nimport Parser from \"../../core/parser\";\nimport events from \"../../core/events\";\nimport registry from \"../../core/registry\";\nimport utils from \"../../core/utils\";\n\n// Initialize close-panel functionality.\nimport \"../close-panel/close-panel\";\n\nconst log = logging.getLogger(\"pat-tooltip\");\n\nexport const parser = new Parser(\"tooltip\");\nconst all_positions = [\n    \"tl\",\n    \"tm\",\n    \"tr\",\n    \"rt\",\n    \"rm\",\n    \"rb\",\n    \"br\",\n    \"bm\",\n    \"bl\",\n    \"lb\",\n    \"lm\",\n    \"lt\",\n];\nparser.addArgument(\"position-list\", [], all_positions, true);\nparser.addArgument(\"position-policy\", \"auto\", [\"auto\", \"force\"]);\nparser.addArgument(\"trigger\", \"click\", [\"click\", \"hover\", \"none\"]);\nparser.addArgument(\"source\", \"title\", [\"ajax\", \"content\", \"title\"]);\nparser.addArgument(\"ajax-data-type\", \"html\", [\"html\", \"markdown\"]);\nparser.addArgument(\"closing\", \"auto\", [\"auto\", \"sticky\", \"close-button\"]);\nparser.addArgument(\"delay\");\nparser.addArgument(\"mark-inactive\", true);\nparser.addArgument(\"class\");\nparser.addArgument(\"target\", \"body\");\nparser.addArgument(\"arrow-padding\", null);\nparser.addArgument(\"url\", null);\n\n// Tippy Lifecycle-hooks\n// See: https://tippyjs.bootcss.com/lifecycle-hooks/\n// onCreate\n// onTrigger\n// onShow\n// onMount\n// onShown\n// onUntrigger\n// onHide\n// onHidden\n//\n// onBeforeUpdate\n// onAfterUpdate\n// onDestroy\n\nclass Pattern extends BasePattern {\n    static name = \"tooltip\";\n    static trigger = \".pat-tooltip, .pat-tooltip-ng\";\n    static parser = parser;\n\n    tippy = null;\n\n    active_class = \"tooltip-active-hover\";\n    inactive_class = \"tooltip-inactive\";\n\n    async init() {\n        const el = this.el;\n\n        if (window.__patternslib_import_styles) {\n            import(\"tippy.js/dist/tippy.css\");\n        }\n        const Tippy = (await import(\"tippy.js\")).default;\n        this.tippy_options = this.parseOptionsForTippy(this.options);\n\n        const defaultProps = {\n            animation: false,\n            arrow: true,\n            //'delay': [0, 1800],\n            //'duration': [325, 275],\n            hideOnClick: this.options.closing === \"close-button\" ? false : true,\n            ignoreAttributes: true,\n            interactive: true,\n            onHide: this._onHide.bind(this),\n            onShow: this._onShow.bind(this),\n            trigger: \"click\",\n        };\n\n        Tippy.setDefaultProps(defaultProps);\n        this.tippy = new Tippy(el, this.tippy_options);\n\n        if (this.options.source === \"title\") {\n            // Remove ``title`` attribute when source is set to ``title`` to\n            // disable the browser's built-in tooltip feature\n            el.removeAttribute(\"title\");\n        }\n\n        if (this.options.trigger === \"click\" && this.options.source === \"ajax\") {\n            // prevent default action for \"click\" and \"mouseenter click\"\n            events.add_event_listener(\n                el,\n                \"click\",\n                \"pat-tooltip--click-prevent-default\",\n                (event) => {\n                    event.preventDefault();\n                    event.stopPropagation();\n                }\n            );\n        }\n\n        if (this.options.trigger === \"click\") {\n            this.active_class = \"tooltip-active-click\";\n        }\n        if (this.options.markInactive) {\n            // Initially mark as inactive\n            el.classList.add(this.inactive_class);\n        }\n    }\n\n    show() {\n        // Show this tooltip\n        this.tippy.show();\n    }\n\n    async hide() {\n        // Hide this tooltip\n        await utils.timeout(1); // wait a tick for event being processed by other handlers.\n        this.tippy.hide();\n    }\n\n    destroy() {\n        // Remove this tooltip\n        super.destroy(); // Unregister\n        this.tippy.destroy();\n    }\n\n    parseOptionsForTippy(opts) {\n        const placement = (pos) => {\n            // note that Cornelis needs the positioning to be the placement of the thingy on the bubble\n            // tippy though refers to positioning as the placement of the bubble relatively to the reference element\n            // so we invert the meaning below. It's intentional.\n            const primary = (pos0) =>\n                ({\n                    t: \"bottom\",\n                    r: \"left\",\n                    b: \"top\",\n                    l: \"right\",\n                }[pos0]);\n\n            const secondary = (pos1) =>\n                ({\n                    l: \"-start\",\n                    r: \"-end\",\n                    m: \"\",\n                    t: \"-start\",\n                    b: \"-end\",\n                }[pos1]);\n\n            return `${primary(pos[0])}${secondary(pos[1])}`;\n        };\n\n        const tippy_options = { popperOptions: { modifiers: [] } };\n\n        if (opts.arrowPadding !== null) {\n            tippy_options.popperOptions.modifiers.push({\n                name: \"arrow\",\n                options: {\n                    padding: parseInt(opts.arrowPadding, 10),\n                },\n            });\n        }\n\n        const parsers = {\n            position: () => {\n                if (!opts.position?.list?.length) {\n                    return;\n                }\n                tippy_options.placement = placement(opts.position.list[0]); // main position\n\n                const flip_options = {\n                    name: \"flip\",\n                    enabled: true,\n                };\n\n                if (opts.position.policy === \"force\") {\n                    flip_options.enabled = false;\n                } else if (opts.position.length > 1) {\n                    const fallbacks = opts.position.list.slice(1).map(placement);\n                    flip_options.fallbackPlacements = fallbacks;\n                }\n\n                tippy_options.popperOptions.modifiers.push(flip_options);\n            },\n\n            trigger() {\n                if (opts.trigger === \"hover\") {\n                    tippy_options.trigger = \"mouseenter focus\";\n                } else if (opts.trigger === \"none\") {\n                    tippy_options.trigger = \"manual\";\n                    tippy_options.hideOnClick = false;\n                }\n            },\n\n            source: () => {\n                let content;\n                if (opts.source === \"title\") {\n                    // Tooltip content from title attribute\n                    content = this.el.getAttribute(\"title\");\n                } else if (opts.source === \"content\") {\n                    // Tooltip content from trigger childs.\n                    content = this.el.innerHTML;\n                    tippy_options.allowHTML = true;\n                } else if (opts.source === \"ajax\") {\n                    // Tooltiop content from AJAX request.\n                    content = document.createElement(\"progress\");\n                    tippy_options.allowHTML = true;\n                }\n                tippy_options.content = content;\n            },\n\n            delay() {\n                if (opts.delay) {\n                    tippy_options.delay = [utils.parseTime(opts.delay), 0];\n                }\n            },\n\n            target: () => {\n                if (!opts.target) {\n                    return;\n                }\n                if (opts.target === \"parent\") {\n                    tippy_options.appendTo = \"parent\";\n                } else if (opts.target === \"body\") {\n                    tippy_options.appendTo = document.body;\n                } else {\n                    tippy_options.appendTo = document.querySelector(opts.target);\n                }\n            },\n        };\n\n        for (let arg in opts) {\n            switch (arg) {\n                case \"ajax-data-type\":\n                    arg = \"ajaxDataType\";\n                    break;\n                case \"mark-inactive\":\n                    arg = \"markInactive\";\n                    break;\n            }\n            parsers[arg] && parsers[arg](arg);\n        }\n\n        return tippy_options;\n    }\n\n    _initialize_content() {\n        // Initialize any other patterns.\n        registry.scan(this.tippy.popper);\n    }\n\n    async _onShow() {\n        const tippy_classes = [];\n\n        // Group DOM manipulations\n\n        if (this.options.class) {\n            tippy_classes.push(...this.options.class.split(\" \"));\n        }\n\n        // Add a generic non-tippy related class to identify the tooltip container\n        tippy_classes.push(\"tooltip-container\");\n\n        if (this.options.closing === \"close-button\") {\n            // First, remove previously automatically added close buttons.\n            // Otherwise we would end up adding another close button with every\n            // click on it.\n            for (const close_button of this.tippy.popper.querySelectorAll(\n                \".pat-tooltip--close-button\"\n            )) {\n                close_button.remove();\n            }\n\n            const close_button = document.createElement(\"button\");\n            close_button.setAttribute(\"class\", \"close-panel pat-tooltip--close-button\");\n            const content = this.tippy.popper.querySelector(\".tippy-content\");\n            content.parentNode.insertBefore(close_button, content);\n        }\n\n        // Store reference to method for closing panels on the tooltip element instance.\n        events.add_event_listener(\n            this.tippy.popper,\n            \"close-panel\",\n            \"pat-tooltip--close-panel\",\n            () => this.hide()\n        );\n\n        this.tippy.popper.classList.add(...tippy_classes);\n\n        if (this.options.markInactive) {\n            this.el.classList.remove(this.inactive_class);\n            this.el.classList.add(this.active_class);\n        }\n\n        if (this.options.closing !== \"auto\" && this.options.trigger === \"hover\") {\n            // no auto-close when hovering when closing mode is \"sticky\" or \"close-button\".\n            this.tippy.setProps({ trigger: \"click\" });\n        }\n\n        if (this.options.source === \"ajax\") {\n            await this._get_content();\n        }\n\n        // Notify parent patterns about injected content.\n        // Do not call pat-inject's handler, because all necessary\n        // initialization after injection is done here.\n        $(this.tippy.popper).trigger(\"patterns-injected\", [\n            { skipPatInjectHandler: true },\n            this.el,\n            this.tippy.popper,\n        ]);\n\n        this._initialize_content();\n    }\n\n    _onHide() {\n        if (this.options.markInactive) {\n            this.el.classList.remove(this.active_class);\n            this.el.classList.add(this.inactive_class);\n        }\n\n        if (this.options.closing !== \"auto\" && this.options.trigger === \"hover\") {\n            // re-set hover behavior\n            this.tippy.setProps({ trigger: \"mouseenter focus\" });\n        }\n\n        if (this.options.source === \"ajax\") {\n            this.tippy.setContent(document.createElement(\"progress\"));\n        }\n    }\n\n    async _get_content(url = this.options.url) {\n        let selector;\n        ({ url, selector } = this.get_url_parts(url || this.el.getAttribute(\"href\")));\n        let content;\n        if (url) {\n            // Tooltip from remote page.\n            const handler = this.data_type_handlers[this.options.ajaxDataType];\n            try {\n                // TODO: use pat-inject, once it supports async\n                const response = await fetch(url, {\n                    headers: {\n                        Accept: \"text/html,application/xhtml+xml,application/xml\",\n                    },\n                });\n                const text = await response.text();\n                content = await handler(text, url, selector);\n            } catch {\n                log.error(\"Error on ajax request. ${e}\");\n            }\n        } else if (selector) {\n            // Tooltip content from current DOM tree.\n            content = document.querySelector(selector);\n            content = content?.innerHTML || undefined;\n        }\n        if (content) {\n            this.tippy.setContent(content);\n            await utils.timeout(1); // Wait a tick before forceUpdate. Might fail due to unset popperInstance.\n            this.tippy.popperInstance.forceUpdate(); // re-position tippy after content is known.\n        }\n    }\n\n    async get_content(url = this.options.url) {\n        // API method: _get_content + _initialize_content\n        await this._get_content(url);\n        this._initialize_content();\n    }\n\n    get_url_parts(href) {\n        // Return the URL and a CSS ID selector.\n        let url, selector, query;\n        if (!href) {\n            return { url, selector };\n        }\n        [url, selector] = href.split(\"#\");\n        if (selector) {\n            selector = `#${selector}`;\n            [selector, query] = selector.split(\"?\");\n        }\n        if (query) {\n            url = `${url}?${query}`;\n        }\n        return { url, selector };\n    }\n\n    static data_type_handlers = {\n        html(text, url, selector) {\n            let tmp = document.createElement(\"div\");\n            tmp.innerHTML = text;\n            if (selector) {\n                tmp = tmp.querySelector(selector);\n            }\n            return tmp?.innerHTML || \"\";\n        },\n\n        async markdown(text, url, selector) {\n            const Markdown = registry.patterns.markdown;\n            if (!Markdown) {\n                return text;\n            }\n\n            const instance = new Markdown($(\"<div/>\"));\n            await events.await_pattern_init(instance);\n\n            const cfg = { url };\n            if (selector) {\n                cfg.source = selector;\n            }\n\n            const ret = await instance.renderForInjection(cfg, text);\n            return ret[0];\n        },\n    };\n\n    static register_type_handler(type, handler) {\n        Pattern.data_type_handlers[type] = handler;\n    }\n\n    constructor(...args) {\n        super(...args);\n\n        this.register_type_handler = this.constructor.register_type_handler;\n        this.data_type_handlers = this.constructor.data_type_handlers;\n    }\n}\n\nregistry.register(Pattern);\nexport default Pattern;\nexport { Pattern };\n","import $ from \"jquery\";\nimport _ from \"underscore\";\nimport _t from \"../../core/i18n-wrapper\";\nimport Base from \"@patternslib/patternslib/src/core/base\";\nimport logger from \"@patternslib/patternslib/src/core/logging\";\nimport utils from \"../../core/utils\";\n\nconst log = logger.getLogger(\"pat-upload\");\n\nlet Dropzone;\n\nexport default Base.extend({\n    name: \"upload\",\n    trigger: \".pat-upload\",\n    parser: \"mockup\",\n    defaults: {\n        showTitle: true,\n        url: null, // XXX MUST provide url to submit to OR be in a form\n        className: \"upload\",\n        wrap: false,\n        wrapperTemplate: '<div class=\"upload-wrapper\"/>',\n        fileaddedClassName: \"dropping\",\n        useTus: false,\n        container: \"\",\n        ajaxUpload: true,\n\n        paramName: \"file\",\n        addRemoveLinks: false,\n        autoCleanResults: true,\n        previewsContainer: \".previews\",\n        previewTemplate: null,\n        maxFiles: null,\n        maxFilesize: 99999999, // let's not have a max by default...\n\n        allowPathSelection: undefined,\n        relatedItems: {\n            // UID attribute is required here since we're working with related items\n            attributes: [\n                \"UID\",\n                \"Title\",\n                \"Description\",\n                \"getURL\",\n                \"portal_type\",\n                \"path\",\n                \"ModificationDate\",\n            ],\n            batchSize: 20,\n            basePath: \"/\",\n            vocabularyUrl: null,\n            width: 500,\n            maximumSelectionSize: 1,\n            selectableTypes: [\"Folder\"],\n        },\n    },\n\n    init: async function () {\n        import(\"dropzone/dist/dropzone.css\");\n        import(\"./upload.scss\");\n        Dropzone = (await import(\"dropzone\")).default;\n        /* we do not want this plugin to auto discover */\n        Dropzone.autoDiscover = false;\n\n        const UploadTemplate = (await import(\"./templates/upload.xml\")).default;\n\n        var self = this;\n\n        if (self.$el.find(\".upload-area\").length) {\n            log.info(\"Found already a dropzone on element, skipping!\");\n            return;\n        }\n\n        if (typeof self.options.allowPathSelection === \"undefined\") {\n            // Set allowPathSelection to true, if we can use path based urls.\n            self.options.allowPathSelection =\n                self.options.baseUrl && self.options.relativePath;\n        }\n\n        // TODO: find a way to make this work in firefox (and IE)\n        $(document).on(\"paste\", function (e) {\n            var oe = e.originalEvent;\n            var items = oe.clipboardData.items;\n            if (items) {\n                for (var i = 0; i < items.length; i++) {\n                    if (items[i].type.indexOf(\"image\") !== -1) {\n                        var blob = items[i].getAsFile();\n                        self.dropzone.addFile(blob);\n                    }\n                }\n            }\n        });\n        // values that will change current processing\n        self.currentPath = self.options.currentPath;\n        self.currentFile = 0;\n\n        let template = _.template(UploadTemplate)({\n            _t: _t,\n            allowPathSelection: self.options.allowPathSelection,\n        });\n        self.$el.addClass(self.options.className);\n        self.$el.append(template);\n\n        self.$progress = $(\".progress-bar-success\", self.$el);\n\n        if (!self.options.showTitle) {\n            self.$el.find(\"h2.title\").hide();\n        }\n\n        if (!self.options.ajaxUpload) {\n            // no ajax upload, drop the fallback\n            $(\".fallback\", this.$el).remove();\n            if (this.$el.hasClass(\".upload-container\")) {\n                this.$el.addClass(\"no-ajax-upload\");\n            } else {\n                this.$el.closest(\".upload-container\").addClass(\"no-ajax-upload\");\n            }\n        }\n\n        if (self.options.wrap) {\n            self.$el.wrap(self.options.wrapperTemplate);\n            self.$el = self.$el.parent();\n        }\n\n        if (self.options.allowPathSelection) {\n            // only use related items if we can generate path based urls and if it's not turned off.\n            self.$pathInput = $('input[name=\"location\"]', self.$el);\n            self.relatedItems = await self.setupRelatedItems(self.$pathInput);\n        } else {\n            $('input[name=\"location\"]', self.$el).parent().remove();\n            self.relatedItems = null;\n        }\n\n        self.$dropzone = $(\".upload-area\", self.$el);\n\n        $(\"div.browse-select button.browse\", self.$el).on(\"click\", function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            if (\n                !self.options.maxFiles ||\n                self.dropzone.files.length < self.options.maxFiles\n            ) {\n                self.dropzone.hiddenFileInput.click();\n            }\n        });\n\n        var dzoneOptions = await this.getDzoneOptions();\n\n        try {\n            // if init of Dropzone fails it says nothing and\n            // it fails silently. Using this block we make sure\n            // that if you break it w/ some weird or missing option\n            // you can get a proper log of it\n            //\n            self.dropzone = new Dropzone(self.$dropzone[0], dzoneOptions);\n        } catch (e) {\n            if (window.DEBUG) {\n                // log it!\n                console.log(e);\n            }\n            throw e;\n        }\n\n        self.dropzone.on(\"maxfilesreached\", function () {\n            self.showHideControls();\n        });\n\n        self.dropzone.on(\"addedfile\", function (/* file */) {\n            self.showHideControls();\n        });\n\n        self.dropzone.on(\"removedfile\", function () {\n            self.showHideControls();\n        });\n\n        self.dropzone.on(\"success\", function (e, response) {\n            // Trigger event 'uploadAllCompleted' and pass the server's reponse and\n            // the path uid. This event can be listened to by patterns using the\n            // upload pattern, e.g. the TinyMCE pattern's link plugin.\n            var data;\n            try {\n                data = $.parseJSON(response);\n            } catch {\n                data = response;\n            }\n            self.$el.trigger(\"uploadAllCompleted\", {\n                data: data,\n                path_uid: self.$pathInput ? self.$pathInput.val() : null,\n            });\n        });\n\n        if (self.options.autoCleanResults) {\n            self.dropzone.on(\"complete\", function (file) {\n                if (file.status === Dropzone.SUCCESS) {\n                    setTimeout(function () {\n                        $(file.previewElement).fadeOut();\n                    }, 3000);\n                }\n            });\n        }\n\n        self.dropzone.on(\"complete\", function (file) {\n            if (file.status === Dropzone.SUCCESS && self.dropzone.files.length === 1) {\n                self.showHideControls();\n            }\n        });\n\n        self.dropzone.on(\"error\", function (file, response, xmlhr) {\n            if (typeof xmlhr !== \"undefined\" && xmlhr.status !== 403) {\n                // If error other than 403, just print a generic message\n                $(\".dz-error-message span\", file.previewElement).html(\n                    _t(\"The file transfer failed\")\n                );\n            }\n        });\n\n        self.dropzone.on(\"totaluploadprogress\", function (pct) {\n            // need to caclulate total pct here in reality since we're manually\n            // processing each file one at a time.\n            pct =\n                (((self.currentFile - 1) * 100 + pct) /\n                    (self.dropzone.files.length * 100)) *\n                100;\n            self.$progress.attr(\"aria-valuenow\", pct).css(\"width\", pct + \"%\");\n        });\n\n        $(\".upload-all\", self.$el).on(\"click\", function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            self.processUpload({\n                finished: function () {\n                    self.$progress.attr(\"aria-valuenow\", 0).css(\"width\", \"0%\");\n                },\n            });\n        });\n        if (self.options.clipboardfile) {\n            self.dropzone.addFile(self.options.clipboardfile);\n        }\n    },\n\n    showHideControls: function () {\n        /* we do this delayed because this can be called multiple times\n         AND we need to do this hide/show AFTER dropzone is done with\n         all it's own events. This is NASTY but the only way we can\n         enforce some numFiles with dropzone! */\n        var self = this;\n        if (self._showHideTimeout) {\n            clearTimeout(self._showHideTimeout);\n        }\n        self._showHideTimeout = setTimeout(function () {\n            self._showHideControls();\n        }, 50);\n    },\n\n    _showHideControls: function () {\n        var self = this;\n        var $controls = $(\".controls\", self.$el);\n        var $browse = $(\".browse-select\", self.$el);\n        var $input = $(\".dz-hidden-input\");\n\n        if (self.options.maxFiles) {\n            if (self.dropzone.files.length < self.options.maxFiles) {\n                $browse.show();\n                $input.prop(\"disabled\", false);\n            } else {\n                $browse.hide();\n                $input.prop(\"disabled\", true);\n            }\n        }\n        if (self.dropzone.files.length > 0) {\n            $controls.fadeIn(\"slow\");\n            var file = self.dropzone.files[0];\n            $(\".dz-error-message span\", file.previewElement).html(\"\");\n        } else {\n            $controls.fadeOut(\"slow\");\n        }\n    },\n\n    pathJoin: function () {\n        var parts = [];\n        _.each(arguments, function (part) {\n            if (!part) {\n                return;\n            }\n            if (part[0] === \"/\") {\n                part = part.substring(1);\n            }\n            if (part[part.length - 1] === \"/\") {\n                part = part.substring(0, part.length - 1);\n            }\n            parts.push(part);\n        });\n        return parts.join(\"/\");\n    },\n\n    getUrl: function () {\n        var self = this;\n        var url = self.options.url;\n        if (!url) {\n            if (self.options.baseUrl && self.options.relativePath) {\n                url = self.options.baseUrl;\n                if (url[url.length - 1] !== \"/\") {\n                    url = url + \"/\";\n                }\n                url = url + self.pathJoin(self.currentPath, self.options.relativePath);\n            } else {\n                var $form = self.$el.parents(\"form\");\n                if ($form.length > 0) {\n                    url = $form.attr(\"action\");\n                } else {\n                    url = window.location.href;\n                }\n            }\n        }\n        return url;\n    },\n\n    getDzoneOptions: async function () {\n        let PreviewTemplate = await import(\"./templates/preview.xml\");\n        PreviewTemplate = PreviewTemplate.default;\n\n        var self = this;\n\n        // This pattern REQUIRE dropzone to be clickable\n        self.options.clickable = true;\n\n        var options = $.extend({}, self.options);\n        options.url = self.getUrl();\n\n        options.headers = {\n            \"X-CSRF-TOKEN\": utils.getAuthenticator(),\n        };\n\n        // XXX force to only upload one to the server at a time,\n        // right now we don't support multiple for backends\n        options.uploadMultiple = false;\n\n        delete options.wrap;\n        delete options.wrapperTemplate;\n        delete options.resultTemplate;\n        delete options.autoCleanResults;\n        delete options.fileaddedClassName;\n        delete options.useTus;\n\n        if (self.options.previewsContainer) {\n            /*\n             * if they have a select but it's not an id, let's make an id selector\n             * so we can target the correct container. dropzone is weird here...\n             */\n            var $preview = self.$el.find(self.options.previewsContainer);\n            if ($preview.length > 0) {\n                options.previewsContainer = $preview[0];\n            }\n        }\n\n        // XXX: do we need to allow this?\n        options.autoProcessQueue = false;\n        // options.addRemoveLinks = true;  // we show them in the template\n        options.previewTemplate = PreviewTemplate;\n\n        // if our element is a form we should force some values\n        // https://github.com/enyo/dropzone/wiki/Combine-normal-form-with-Dropzone\n        return options;\n    },\n\n    processUpload: function (options) {\n        if (!options) {\n            options = {};\n        }\n\n        var self = this,\n            processing = false,\n            useTus = self.options.useTus,\n            fileaddedClassName = self.options.fileaddedClassName,\n            finished = options.finished;\n\n        self.currentFile = 0;\n\n        function process() {\n            processing = true;\n            if (self.dropzone.files.length === 0) {\n                processing = false;\n            }\n\n            var file = self.dropzone.files[0];\n            if (processing && file.status === Dropzone.ERROR) {\n                // Put the file back as \"queued\" for retrying\n                file.status = Dropzone.QUEUED;\n                processing = false;\n            }\n\n            if (!processing) {\n                self.$el.removeClass(fileaddedClassName);\n                if (finished !== undefined && typeof finished === \"function\") {\n                    finished();\n                }\n                return;\n            }\n\n            if ([Dropzone.SUCCESS, Dropzone.CANCELED].indexOf(file.status) !== -1) {\n                // remove it\n                self.dropzone.removeFile(file);\n                process();\n            } else if (file.status !== Dropzone.UPLOADING) {\n                // start processing file\n                if (useTus && window.tus) {\n                    // use tus upload if installed\n                    self.handleTusUpload(file);\n                } else {\n                    // otherwise, just use dropzone to process\n                    self.currentFile += 1;\n                    self.dropzone.processFile(file);\n                }\n                setTimeout(process, 100);\n            } else {\n                // currently processing\n                setTimeout(process, 100);\n            }\n        }\n        process();\n    },\n\n    handleTusUpload: function (file) {\n        /* this needs fixing... */\n        var self = this,\n            chunkSize = 1024 * 1024 * 5; // 5mb chunk size\n\n        file.status = Dropzone.UPLOADING;\n\n        window.tus\n            .upload(file, {\n                endpoint: self.dropzone.options.url,\n                headers: {\n                    \"FILENAME\": file.name,\n                    \"X-CSRF-TOKEN\": utils.getAuthenticator(),\n                },\n                chunkSize: chunkSize,\n            })\n            .fail(function () {\n                if (window.DEBUG) {\n                    console.alert(_t(\"Error uploading with TUS resumable uploads\"));\n                }\n                file.status = Dropzone.ERROR;\n            })\n            .progress(function (e, bytesUploaded, bytesTotal) {\n                var percentage = (bytesUploaded / bytesTotal) * 100;\n                self.$progress\n                    .attr(\"aria-valuenow\", percentage)\n                    .css(\"width\", percentage + \"%\");\n                self.$progress.html(\n                    _t(\"uploading...\") +\n                        \"<br />\" +\n                        self.formatBytes(bytesUploaded) +\n                        \" / \" +\n                        self.formatBytes(bytesTotal)\n                );\n            })\n            .done(function (url, file) {\n                file.status = Dropzone.SUCCESS;\n                self.dropzone.emit(\"success\", file);\n                self.dropzone.emit(\"complete\", file);\n            });\n    },\n\n    formatBytes: function (bytes) {\n        var kb = Math.round(bytes / 1024);\n        if (kb < 1024) {\n            return kb + \" KiB\";\n        }\n        var mb = Math.round(kb / 1024);\n        if (mb < 1024) {\n            return mb + \" MB\";\n        }\n        return Math.round(mb / 1024) + \" GB\";\n    },\n\n    setPath: function (path) {\n        var self = this;\n        self.currentPath = path;\n        self.options.url = null;\n        self.options.url = self.dropzone.options.url = self.getUrl();\n    },\n\n    setupRelatedItems: async function ($input) {\n        const RelatedItems = (await import(\"../relateditems/relateditems\")).default;\n\n        var self = this;\n        var options = self.options.relatedItems;\n        options.upload = false; // ensure that related items upload is off.\n        if (self.options.initialFolder) {\n            $input.attr(\"value\", self.options.initialFolder);\n        }\n        var ri = new RelatedItems($input, options);\n        ri.$el.on(\"change\", function () {\n            var result = $(this).select2(\"data\");\n            var path = null;\n            if (result.length > 0) {\n                path = result[0].path;\n            }\n            self.setPath(path);\n        });\n        return ri;\n    },\n});\n","/**\n * Patterns store - store pattern state locally in the browser\n *\n * Copyright 2008-2012 Simplon B.V.\n * Copyright 2011 Humberto Sermeño\n * Copyright 2011 Florian Friesdorf\n */\nimport logging from \"./logging\";\n\nconst log = logging.getLogger(\"Patternslib Store\");\n\nfunction Storage(backend, prefix) {\n    this.prefix = prefix;\n    this.backend = backend;\n}\n\nStorage.prototype._key = function Storage_key(name) {\n    return this.prefix + \":\" + name;\n};\n\nStorage.prototype._allKeys = function Storage_allKeys() {\n    var keys = [],\n        prefix = this.prefix + \":\",\n        prefix_length = prefix.length,\n        key,\n        i;\n\n    for (i = 0; i < this.backend.length; i++) {\n        key = this.backend.key(i);\n        if (key.slice(0, prefix_length) === prefix) keys.push(key);\n    }\n    return keys;\n};\n\nStorage.prototype.get = function Storage_get(name) {\n    var key = this._key(name),\n        value = this.backend.getItem(key);\n    if (value !== null) {\n        try {\n            value = JSON.parse(value);\n        } catch {\n            log.warn(`Cannot parse storage value for key ${key}`);\n            return;\n        }\n    }\n    return value;\n};\n\nStorage.prototype.set = function Storage_set(name, value) {\n    var key = this._key(name);\n    return this.backend.setItem(key, JSON.stringify(value));\n};\n\nStorage.prototype.remove = function Storage_remove(name) {\n    var key = this._key(name);\n    return this.backend.removeItem(key);\n};\n\nStorage.prototype.clear = function Storage_clear() {\n    var keys = this._allKeys();\n    for (var i = 0; i < keys.length; i++) this.backend.removeItem(keys[i]);\n};\n\nStorage.prototype.all = function Storage_all() {\n    var keys = this._allKeys(),\n        prefix_length = this.prefix.length + 1,\n        lk,\n        data = {};\n\n    for (var i = 0; i < keys.length; i++) {\n        lk = keys[i].slice(prefix_length);\n        data[lk] = JSON.parse(this.backend.getItem(keys[i]));\n    }\n    return data;\n};\n\nfunction ValueStorage(store, name) {\n    this.store = store;\n    this.name = name;\n}\n\nValueStorage.prototype.get = function ValueStorage_get() {\n    return this.store.get(this.name);\n};\n\nValueStorage.prototype.set = function ValueStorage_get(value) {\n    return this.store.set(this.name, value);\n};\n\nValueStorage.prototype.remove = function ValueStorage_remove() {\n    return this.store.remove(this.name);\n};\n\nvar store = {\n    supported: false,\n\n    local: function (name) {\n        return new Storage(window.localStorage, name);\n    },\n\n    session: function (name) {\n        return new Storage(window.sessionStorage, name);\n    },\n\n    ValueStorage: ValueStorage,\n\n    // Update storage options for a given element.\n    updateOptions: function store_updateOptions(trigger, options) {\n        if (options.store !== \"none\") {\n            if (!trigger.id) {\n                log.warn(\"state persistance requested, but element has no id\");\n                options.store = \"none\";\n            } else if (!store.supported) {\n                log.warn(\n                    \"state persistance requested, but browser does not support webstorage\"\n                );\n                options.store = \"none\";\n            }\n        }\n        return options;\n    },\n};\n\n// Perform the test separately since this may throw a SecurityError as\n// reported in #326\ntry {\n    store.supported = typeof window.sessionStorage !== \"undefined\";\n} catch {\n    // just ignore.\n}\n\nexport default store;\n","/* pat-date-picker  - Polyfill for input type=date */\nimport $ from \"jquery\";\nimport Base from \"../../core/base\";\nimport logging from \"../../core/logging\";\nimport Parser from \"../../core/parser\";\nimport dom from \"../../core/dom\";\nimport events from \"../../core/events\";\nimport store from \"../../core/store\";\nimport utils from \"../../core/utils\";\n\nconst log = logging.getLogger(\"date-picker\");\n\nexport const parser = new Parser(\"date-picker\");\nparser.addArgument(\"behavior\", \"styled\", [\"native\", \"styled\"]);\nparser.addArgument(\"week-numbers\", [], [\"show\", \"hide\"]);\nparser.addArgument(\"i18n\"); // URL pointing to JSON resource with i18n values\nparser.addArgument(\"first-day\", 0);\nparser.addArgument(\"after\");\nparser.addArgument(\"offset-days\", 0);\n\nparser.add_argument(\"output-format\", null);\nparser.add_argument(\"locale\", null);\n\nparser.addAlias(\"behaviour\", \"behavior\");\n\n/* JSON format for i18n\n * { \"previousMonth\": \"Previous Month\",\n *   \"nextMonth\"    : \"Next Month\",\n *   \"months\"       : [\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\n *   \"weekdays\"     : [\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"],\n *   \"weekdaysShort\": [\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"]\n * } */\n\nexport const storage = store.session(\"pat-date-picker\");\n\n\nexport default Base.extend({\n    name: \"date-picker\",\n    trigger: \".pat-date-picker\",\n    parser: parser,\n    format: \"YYYY-MM-DD\",\n\n    async init() {\n        const el = this.el;\n        const disabled = this.el.disabled;\n\n        //TODO: make parser with options extend missing options.\n        //this.options = parser.parse(el, opts);\n        this.options = $.extend(parser.parse(el), this.options);\n\n        if (!disabled && this.options.after) {\n            // Set the date depending on another date which must be ``offset-days``\n            // BEFORE this date. Only set it, if the other date is AFTER this\n            // date.\n            const befores = document.querySelectorAll(this.options.after);\n            for (const b_el of befores) {\n                b_el.addEventListener(\"change\", (e) => {\n                    let b_date = e.target.value; // the \"before-date\"\n                    b_date = b_date ? new Date(b_date) : null;\n                    if (!b_date) {\n                        return;\n                    }\n                    let a_date = this.el.value; // the \"after-date\"\n                    a_date = a_date ? new Date(a_date) : null;\n                    if (!a_date || a_date < b_date) {\n                        const offset = this.options.offsetDays || 0;\n                        b_date.setDate(b_date.getDate() + offset);\n                        this.el.value = b_date.toISOString().substring(0, 10);\n                        this.dispatch_change_event();\n                    }\n                });\n            }\n        }\n\n        let display_el;\n        if (this.options.behavior === \"styled\") {\n            dom.hide(el); // hide input, but keep active (e.g. for validation)\n\n            display_el = document.createElement(\"time\");\n            display_el.setAttribute(\"class\", \"output-field\");\n            display_el.setAttribute(\"datetime\", el.value);\n            if (disabled) {\n                display_el.classList.add(\"disabled\");\n            }\n            el.insertAdjacentElement(\"beforebegin\", display_el);\n\n            // Disable click on label, as this invokes a click on the invisible\n            // input field which opens the calendar in Firefox and masks a\n            // click on display_el on Chrome.\n            const label = display_el.closest(\"label\");\n            if (label) {\n                events.add_event_listener(\n                    label,\n                    \"click\",\n                    \"pat-date-picker--label\",\n                    (e) => {\n                        e.preventDefault();\n                    }\n                );\n            }\n\n            let pat_display_time;\n            if (this.options.outputFormat) {\n                const PatDisplayTime = (await import(\"../display-time/display-time\")).default; // prettier-ignore\n                const display_time_config = { format: this.format };\n                if (this.options.outputFormat) {\n                    display_time_config[\"output-format\"] = this.options.outputFormat;\n                }\n                if (this.options.locale) {\n                    display_time_config.locale = this.options.locale;\n                }\n                pat_display_time = new PatDisplayTime(display_el, display_time_config);\n            } else if (this.el.value) {\n                display_el.textContent = el.value;\n            }\n\n            // Add the additional elements \"clear button\" and placeholder to\n            // the `<time>` element.\n            const _add_additional = () => {\n                this.add_clear_button(display_el);\n                if (!this.el.value && this.el.placeholder) {\n                    display_el.innerHTML = `<span class=\"placeholder\">${this.el.placeholder}</span>`;\n                }\n            };\n            if (pat_display_time) {\n                // Add the additional elements after display time has\n                // eventually cleared the contents or done any other changes.\n                $(display_el).on(\"init.display-time.patterns\", () => {\n                    _add_additional();\n                });\n            } else {\n                // If no `pat-display-time` was used, add immediately.\n                _add_additional();\n            }\n\n            this.el.addEventListener(\"change\", () => {\n                display_el.setAttribute(\"datetime\", this.el.value);\n                if (pat_display_time && this.el.value) {\n                    pat_display_time.format();\n                } else {\n                    //} else if (this.el.value) {\n                    display_el.textContent = this.el.value;\n                }\n                _add_additional();\n            });\n\n            if (disabled) {\n                // nothing else to do here...\n                return;\n            }\n        } else if (disabled) {\n            return;\n        } else if (utils.checkInputSupport(\"date\", \"invalid date\")) {\n            // behavior native with native support.\n            return;\n        } else if (el.getAttribute(\"type\") === \"date\") {\n            // behavior native but no native support.\n            // Fallback JS date picker with a text input field.\n            el.setAttribute(\"type\", \"text\");\n        }\n\n        if (window.__patternslib_import_styles) {\n            import(\"./_date-picker.scss\");\n        }\n        const Pikaday = (await import(\"pikaday\")).default;\n\n        const config = {\n            field: el,\n            trigger: display_el || el,\n            format: this.format,\n            firstDay: this.options.firstDay,\n            showWeekNumber: this.options.weekNumbers === \"show\",\n            onSelect: () => this.dispatch_change_event(),\n            onClose: () => {\n                if (this.options.behavior === \"styled\" && !this.el.value) {\n                    // blur the input field so that pat-validate can kick in when\n                    // nothing was selected.\n                    el.dispatchEvent(events.blur_event());\n                }\n            },\n        };\n\n        if (el.getAttribute(\"min\")) {\n            config.minDate = new Date(el.getAttribute(\"min\"));\n        }\n        if (el.getAttribute(\"max\")) {\n            config.maxDate = new Date(el.getAttribute(\"max\"));\n        }\n\n        if (this.options.i18n) {\n            let i18n = storage.get(this.options.i18n);\n            if (!i18n) {\n                try {\n                    const response = await fetch(this.options.i18n);\n                    i18n = await response.json();\n                    storage.set(this.options.i18n, i18n);\n                } catch {\n                    log.error(`date-picker could not load i18n for ${this.options.i18n}`);\n                }\n            }\n            if (i18n) {\n                config.i18n = i18n;\n            }\n        }\n        this.pikaday = new Pikaday(config);\n    },\n\n    add_clear_button(el_append_to) {\n        if (!this.el.disabled && !this.el.required && this.el.value) {\n            // Add clear button\n            const clear_button = document.createElement(\"span\");\n            clear_button.setAttribute(\"class\", \"cancel-button\");\n            clear_button.addEventListener(\"click\", (e) => {\n                e.stopPropagation();\n                this.el.value = null;\n                this.dispatch_change_event();\n            });\n            el_append_to.appendChild(clear_button);\n        }\n    },\n\n    dispatch_change_event() {\n        const event = new Event(\"change\", {\n            bubbles: true,\n            cancelable: true,\n        });\n        // Set ``firedBy` to prevent pikaday to call it's own handler and land\n        // in an infinite loop.\n        event.firedBy = this.pikaday;\n        this.el.dispatchEvent(event);\n\n        // Also trigger input-change\n        $(this.el).trigger(\"input-change\");\n        $(this.el.form).trigger(\"input-change\");\n    },\n});\n"],"names":["Base","extend","name","trigger","parser","defaults","dragAndDrop","autoOpen","selectable","keyboardSupport","onLoad","init","self","this","optionKey","options","def","undefined","utils","bool","onCanMoveTo","moved","target","position","folder","data","$","dataUrl","tree","$el","fail","response","console","log","Parser","addArgument","Pattern","BasePattern","static","el","style","display","SelectedItem","default","plone_registry","component","nodeId","getAttribute","generateId","setAttribute","ContentBrowserApp","contentBrowserEl","document","createElement","classList","add","parentNode","insertBefore","component_content_browser","props","fieldId","registry","register","logger","logging","getLogger","addAlias","KEY_ERROR_EL","KEY_ERROR_MSG","events","add_event_listener","e","input","inputs","debug","check_input","event","capture","initialize_inputs","on","querySelectorAll","disabled_elements","disableSelector","cnt","entries","debouncer","debounce","delay","stop","disabled","set_error","msg","skip_event","validity_state","validity","submitter","hasAttribute","badInput","customError","patternMismatch","rangeOverflow","rangeUnderflow","stepMismatch","tooLong","tooShort","typeMismatch","valid","valueMissing","input_options","parse","equality","querySelector","value","message","attribute","not","after","before","date","datetime","msg_default_not_before","msg_default_not_after","not_after","not_after_el","not_before","not_before_el","is_iso_date_time","Date","isNaN","msg_attr","labels","textContent","replace","trim","remove_error","required","min","max","type","number","email","emit_update","preventDefault","stopPropagation","stopImmediatePropagation","set_error_message","JSON","stringify","setCustomValidity","all_of_group","filter","it","error_node","remove","checkValidity","removeAttribute","length","some","validation_message","validationMessage","dom","create_from_string","error_template","firstChild","fieldset","closest","append","did_disable","formNoValidate","_input","implementation","isCookiesEnabled","c","cookie","dc","indexOf","showIfCookiesDisabled","hide","show","safeClone","clone","Array","prototype","forEach","callback","thisArg","T","k","TypeError","O","Object","len","arguments","kValue","call","singleBoundJQueryPlugin","pattern","method","each","pat","charAt","apply","pluralBoundJQueryPlugin","$this","concat","isObject","obj","regexp_from_wildcard","wildcard","regexp","RegExp","isElementInViewport","partial","offset","rec","getBoundingClientRect","top","bottom","left","right","every","val","window","innerHeight","documentElement","clientHeight","innerWidth","clientWidth","jqueryPlugin","escapeRegExp","str","source","prop","i","hasOwnProperty","findLabel","$label","label","nodeType","tagName","id","form","removeWildcardClass","targets","classes","ensureArray","matcher","class_list","split","ok","test","join","hideOrShow","nodes","visible","pattern_name","toNodeArray","transitions","none","fade","slide","duration","transition","effect","on_complete","action","t","easing","complete","addURLQueryParameter","fullURL","param","parts","toString","url","hash","newURL","removeDuplicateObjects","objs","comparator","v","reduce","list","next_obj","is_duplicate","keys","bind","push","mergeStack","stack","results","frame","frame_length","x","hasValue","checked","selectedIndex","parseTime","time","m","exec","Error","amount","parseFloat","Math","round","parseLength","reference_length","findRelatives","$relatives","$form","body","find","get_bounds","bounds","parseInt","y","width","height","checkInputSupport","invalid_value","support","checkCSSFeature","tag","supported","animation_frame","Promise","requestAnimationFrame","timeout","ms","resolve","setTimeout","func","timer","postpone","last_run","args","now","clearTimeout","isIE","documentMode","jqToNode","jquery","force_array","NodeList","isPrototypeOf","isArray","localized_isodate","day","getDate","padStart","month","getMonth","getFullYear","escape_html","html","appendChild","createTextNode","innerHTML","unescape_html","escaped_html","DOMParser","parseFromString","optional_time","is_iso_date","date_diff","date_1","date_2","utc_1","UTC","utc_2","floor","threshold_list","num_steps","thresholds","sort","is_option_truthy","option","includes","elementInViewport","warn","input_event","detail","CustomEvent","bubbles","cancelable","DependsHandler","handler","condition","error","set_state","getAllInputs","uuid","pattern_uuid","async","update_modal","enable","find_inputs","is_button","dispatchEvent","remove_event_listener","enabled","disable","state","evaluate","section","levels","IDPrefix","classTOCName","classSectionName","classLevelPrefixName","classActiveName","scrollDuration","scrollEasing","validationDelay","tabs","$toc","addClass","prependTo","appendTo","className","asTabs","hasClass","activeId","$level","location","$nav","text","attr","getLevel","doScroll","skipHash","children","removeClass","parents","animate","scrollTop","history","pushState","nav","first","initialize_validation","tab","matches","debounced_validation_marker","validation_marker","addEventListener","elementLevel","level","levelSelector","baseUrl","currentLanguage","storage","catalogs","ttl","valueOf","localStorage","configure","config","key","_setCatalog","domain","language","catalog","_storeCatalog","setItem","getUrl","loadCatalog","getItem","MessageFactory","msgid","keywords","msgstr","keyword","_translation_domains","plone","widgets","translate","i18n","I18N","translate_plone","root","writer","Function","oThis","aArgs","slice","fToBind","fNOP","fBound","Level","DEBUG","INFO","WARN","ERROR","FATAL","ConsoleWriter","Logger","parent","_loggers","_parent","_enabled","_level","setWriter","w","output","log_name","messages","unshift","info","path","route","entry","shift","_getFlag","flag","context","setEnabled","isEnabled","setLevel","toUpperCase","fatal","match","logconfig","search","api","getWriter","el_date","el_time","__patternslib_import_styles","DatePicker","date_value","time_value","el_wrapper","html_btn_now","today","html_btn_clear","clear","update","isotime","date_options","behavior","format","weekNumbers","firstDay","isodate","Event","toISOString","substr","toTimeString","loading","Loading","$filter","$filterBtn","$advSearchInput","$ctSelectAll","$selectAllContainer","$sortingContainer","href","origin","pathname","serialize","pushHistory","done","$html","replaceWith","setBatchStart","b_start","updateSortingState","default_sort","order","toggleClass","URLSearchParams","currentTarget","get","separator","ajaxTimeout","initializeValues","initialValues","term","initSelection","seldefaults","initial_values","selection","items","removeHTML","initializeTags","tags","allowNewItems","map","multiple","initializeOrdering","orderable","Sortable","_initializeOrdering","sortable_el","$select2","draggable","dragClass","chosenClass","onStart","select2","onEnd","initializeSelect2","startsWith","lang","formatResultCssClass","ob","toLowerCase","onSelected","onSelecting","onDeselecting","onDeselected","off","opened","I18n","ajax","vocabularyUrl","_val","queryTerm","quietMillis","page","query","page_limit","dataIds","haveResult","is","vals","parser_group_options","parser_multiple","parser_inherit","constructor","create_uuid","update_event","one","event_name","event_callback","once","destroy","ArgumentParser","parameters","enum_values","enum_conflicts","groups","possible_groups","group_pattern","json_param_pattern","named_param_pattern","token_pattern","_camelCase","__","p1","alias","original","addGroupToSpec","spec","group","field","first_spec","first_name","dest","choices","addJSONArgument","default_value","_typeof","choice","_coerce","num","_set","opts","part","_split","tokens","quoted","simple","_parseExtendedNotation","argstring","arg","values","subopt","_parseShorthandNotation","parameter","sense","positional","_parse","sep","extended","_defaults","result","_cleanupOptions","group_options","inherit","$possible_config_providers","final_length","addBack","provider","current_value","add_argument","table","DataTable","xhrCount","a","_","onTriggerEvents","onClickSubmit","request","_request","cfg","seqNumber","inc","temp","clickedData","Boolean","headers","cache","browserCache","accept","Accept","formdata","FormData","removeData","ajax_deferred","status","jqxhr","inject","cfgs","extractConfig","nextHref","nodeName","pushMarker","onTrigger","idleTrigger","_initIdleTrigger","processDelay","delayed_trigger","uuid_","still_there","_initAutoloadVisible","formaction","cfg_node","params","serializeArray","execute","submitSubform","$sub","assign","$context","urlparts","defaultSelector","elementIsDirty","askForConfirmation","should_confirm","_confirm","confirm","$target","confirmMessage","ensureTarget","createTarget","$created_target","verifySingleConfig","extractModifiers","listenForFormReset","verifyConfig","source_match","target_match","sourceMod","targetMod","targetPosition","loadingClass","selector","_performInjection","$sources","$title","wrapper","sources_string","img","content","source_nodes","childNodes","_inject","_update_history","_afterInjection","glue","title_el","$injected","idx","el_","scroll","scroll_target","querySelectorAllAndMe","scroll_container","find_scroll_container","scroll_to_top","scroll_to_element","_onInjectSuccess","ev","responseText","sources$","callTypeHandler","dataType","idx1","perform_inject","_onInjectError","explanation","timestamp","error_page","error_page_fragment","error_page_url","error_page_response","fetch","executingClass","error_zone","scan","statusText","removeAttr","do_close_panel","contentafter","contentbefore","element","elementafter","elementbefore","_sourcesFromHtml","sources","_parseRawHtml","$source","_rebaseAttrs","object","video","_rebaseOptions","_rebaseURL","base","URL","lastIndexOf","_rebaseHTML","rebase_selector","patterns","pattern_parser","changed","opt","title","clean_html","timeout_id","observer","IntersectionObserver","isIntersecting","disconnect","threshold","margin","observe","onTimeout","unsub","onInteraction","contains","removeEventListener","registerTypeHandler","handlers","fn","injected","skipPatInjectHandler","executedClass","originalEvent","reload","replaceState","_t","guardClassName","optOutClassName","event_listener_map","Map","els","el_events","delete","size","UpdateEvent","super","event_type","cb","has","set","_cb","await_event","await_pattern_init","reject","catch","generic_event","blur_event","click_event","change_event","focus_event","mousedown_event","mouseup_event","scroll_event","submit_event","dragstart_event","dragend_event","always","focus","urlStructure","indexOptionsUrl","contextInfoUrl","setDefaultPageUrl","menuOptions","backdropSelector","activeColumnsCookie","attributes","activeColumns","availableColumns","ModificationDate","EffectiveDate","ExpirationDate","CreationDate","review_state","Subject","portal_type","is_folderish","exclude_from_nav","getObjSize","last_comment_date","total_comments","typeToViewAction","File","Image","Blob","defaultPageTypes","dateFormat","dateStyle","timeStyle","rearrange","properties","sortable_title","moveUrl","buttons","tooltip","icon","datatables_options","upload","uploadMultiple","showTitle","Dropdown","Backbone","AppView","browsing","collectionUrl","queryHelperAttributes","view","render","createModal","$model","modalSizeClass","triggers","zIndexSelector","backdrop","backdropOptions","zIndex","opacity","closeOnEsc","closeOnClick","titleSelector","automaticallyAddButtonActions","loadLinksWithinModal","prependContent","onRender","templateOptions","classDialog","classModal","classHeaderName","classBodyName","classFooterName","classWrapperName","classWrapperInnerName","classPrependName","classContentName","template","actions","actionOptions","eventType","disableAjaxFormSubmit","ajaxUrl","modalFunction","isForm","displayInModal","reloadWindowOnClose","formFieldError","onSuccess","onError","onFormError","redirectOnResponse","redirectToUrl","$action","reg","$modal","actionKeys","patternKeys","patternOptions","handleFormAction","handleLinkAction","extraData","ajaxSubmit","xhr","textStatus","errorStatus","emit","success","redraw","reloadWindow","alert","open","$raw","tplObject","prepend","closeButtonLabel","$modalDialog","$modalContent","eq","$button","positionModal","$wrapperInner","resize","item","substring","image","initModal","createAjaxModal","ajaxXHR","ajaxType","parseBodyTag","_show","createTargetModal","createBasicModal","createHtmlModal","createImageModal","$wrapper","src","srcset","innerText","findPosition","horpos","vertpos","modalWidth","modalHeight","wrapperInnerWidth","wrapperInnerHeight","absTop","absBottom","absLeft","absRight","returnpos","modalInitialized","activateFocusTrap","modal_el","inputsBody","inputsFooter","is_visible","firstInput","lastInput","closeInput","currentIndex","nextIndex","shiftKey","modalCss","css","posopt","outerWidth","outerHeight","pos","createBackdrop","Backdrop","$backdrop","abort","_suppressHide","zxcvbn","htmltmp","pwfield","pwmeterContainer","firstElementChild","pwmeter","indicators","score","elements","inp","wclass","nextSibling","onkeyup","s","head","scripts","getElementsByTagName","loadScript","methods","settings","initialTime","exceptionAreas","lastEvent","trueTime","untouched","inExceptionArea","mouseMoved","live","enteredException","leftException","startTimer","diff","scrollable","scrollHeight","scrollWidth","makeVisibleInScroll","parent_id","absoluteParent","elemTop","elemBottom","viewTop","viewBottom","safeOffset","docElem","elem","ownerDocument","setPositionAbsolute","offsettop","offsetleft","thiswidth","setleft","settop","positionAncestor","$ancestor","$child","childMarginEdgeLeft","childMarginEdgeTop","ancestorPaddingEdgeLeft","ancestorPaddingEdgeTop","findInclusive","slideIn","speed","slideOut","Contains","scopedFind","jquery_plugin","all_selects","all_deselects","all_toggles","all_checkboxes","all_radios","_init","change_handler","change_buttons_and_toggles","change_checked","find_scoped","select","btn","select_all","deselect","deselect_all","toggle","toggle_all","find_siblings","sel","res","find_checkboxes","ref_el","chkbxs","tgl","box","disable_re","dont_catch_re","dont_catch","__patternslib_registry","PATTERN_REGISTRY","__patternslib_registry_initialized","document_ready","transformPattern","transform","initPattern","plog","orderPatterns","splice","Text","selectors","selector_string","reverse","BLACKLIST","__patternslib_patterns_blacklist","plugin_name","external_links_open_new_window","mark_special_links","protocol_icon_map","https","http","ftp","callto","bitcoin","geo","im","irc","ircs","magnet","mailto","mms","news","nntp","openpgp4fpr","sip","sms","smsto","ssh","tel","urn","webcal","wtai","xmpp","open_new_window","protocol","host","links","link","link_url","icon_name","resolveIcon","icon_el","closable","prefix","random","featureSupport","fileApi","FileReader","ICON_CACHE","escapeHTML","getAuthenticator","getWindow","win","txt","QueryHelper","searchParam","pathOperator","batchSize","baseCriteria","sort_on","sort_order","pathDepth","basePath","getBatch","getCurrentPath","currentPath","getCriterias","searchOptions","criterias","useBaseCriteria","additionalCriterias","o","searchPath","getQueryData","criteria","batch","selectAjax","more","total","operation","icon_lookup_name","cache_key","base_url","controller","AbortController","resp","signal","iconmap","_resolve_icon","setId","Re","zeropad","fmt","conf","d","D","getDay","flags","dd","ddd","localization","shortWeekdays","dddd","weekdays","mm","mmm","shortMonths","mmmm","months","yy","String","yyyy","$0","widgetSaveToRfc5545","RDATE","EXDATE","tz","interval","year","occurrences","i18nweekdays","monthlyType","index","yearlyType","rangeType","rtemplate","rrule","human","field_id","fields","dailyInterval2","weeklyInterval2","j","weeklyWeekdaysHuman","monthlyInterval2","monthlyDayOfMonth1Human","monthlyDayOfMonth2","monthlyWeekdayOfMonth1Human","orderIndexes","monthlyWeekdayOfMonth2","yearlyInterval2","yearlyDayOfMonth1Human","yearlyWeekdayOfMonth1Human","yearlyWeekdayOfMonth2","yearlyWeekdayOfMonth3","yearlyWeekdayOfMonth4","rangeByOccurrences1Human","rangeByOccurrences2","replaceAll","rangeByEndDateHuman","date_parts","longDateFormat","tmp_dates","tmp_human","rdate","including","exdate","except","description","parseLine","icalline","property","cleanDates","dates","parseIcal","icaldata","nextline","lines","RRULE","line","pop","widgetLoadFromRfc5545","force","radiobutton","freq","byday","bymonth","bymonthday","count","until","weekday","unsupportedFeatures","noRule","bysetpos","noTemplateMatch","multipleDayOfMonth","day_index","weekday_index","hasRepeatForeverButton","messagearea","RecurrenceInput","textarea","$textarea","orderedWeekdays","now_date","displayFields","$modalForm","rtField","occurrenceExclude","occurrenceInclude","occurrenceDelete","occurrenceAdd","datevalue","errorarea","alreadyAdded","$newdate","additionalDate","icons","slideDown","loadOccurrences","startdate","rfc5545","start","readonly","occurrenceDiv","ajaxURL","contentType","ajaxContentType","readOnly","occurrence","formattedDate","jqXHR","getField","realField","findStartDate","startField","startFieldYear","startFieldMonth","startFieldDay","findIntField","fieldName","recurrenceOn","RFC5545","displayActivate","edit_rules","checkFields","startDate","endDate","endField","enddate","noRepeatEvery","noRepeatOn","noEndAfterNOccurrences","noEndDate","pastEndDate","save","modal","cancel","updateOccurrences","Modal","displayUnactivate","add_rules","dayindex","loadData","start_date","setDate","initModalForm","delete_rules","refresh","preview","addDate","recurrenceType","dailyInterval1","weeklyInterval1","weeklyWeekdays","monthlyInterval1","monthlyDayOfMonth1","monthlyDayOfMonth3","monthlyWeekdayOfMonth1","monthlyWeekdayOfMonth3","monthlyRepeatOn","yearlyInterval1","yearlyDayOfMonth1","yearlyDayOfMonth2","yearlyDayOfMonth3","yearlyWeekdayOfMonth1","yearlyRepeatOn","range","rangeNoEnd","rangeByOccurrences1","rangeByEndDate","recurrenceStart","include","exclude","shortDateFormat","daily","mondayfriday","weekly","monthly","yearly","ributtonExtraClass","load_icons","configuration","recurrenceinput","DATA_PREFIX","DATA_STYLE_DISPLAY","INPUT_SELECTOR","all","get_css_value","as_pixels","as_float","getComputedStyle","getPropertyValue","get_relative_position","reference_el","abs","scrollLeft","get_data","set_data","event_id","_ready","readyState","wrap","find_parents","ret","get_parents","HTMLElement","acquire_attribute","include_empty","include_all","_el","parentElement","offsetWidth","offsetHeight","is_input","string","createRange","createContextualFragment","direction","fallback","overflow_y","overflow_x","get_scroll_x","scroll_reference","scrollX","get_scroll_y","scrollY","scrollTo","scroll_to_bottom","delete_data","template_string","template_variables","get_visible_ratio","container","rect","container_rect","visible_ratio","rect_height","escape_css_id","CSS","escape","element_uuid","find_form","messageTimeout","submitTimeout","switchTimeout","isModal","dirty","that","setupAddDropdown","setupSwitchPortletManager","setupSavePortletsSettings","setupPortletEdit","ajax_load","$body","empty","$content","$h1","rebind","suppress","statusMessage","$message","fadeTo","showEditPortlet","$a","$select","ajaxForm","beforeSubmit","url_","_reloadPortletManager","is_popstate","KEY","selectedUIDs","openAfterInit","pageSize","closeOnSelect","contextPath","dropdownCssClass","favorites","recentlyUsed","recentlyUsedMaxItems","recentlyUsedKey","maximumSelectionSize","minimumInputLength","mode","rootPath","rootUrl","scanSelection","selectableTypes","sortOn","sortOrder","tokenSeparators","uploadAllowView","breadcrumbTemplateSelector","favoriteTemplateSelector","recentlyusedTemplateSelector","resultTemplateSelector","selectionTemplateSelector","toolbarTemplateSelector","filterSelectable","isSelectable","applyTemplate","tpl","open_folder","current_directory","one_level_up","_item","setAjax","UID","oneLevelUp","Title","renderToolbar","itemPath","itemsHtml","favoritesHtml","item_copy","recentlyUsedHtml","favItems","favText","searchText","searchModeText","browseModeText","recentlyUsedItems","recentlyUsedText","icon_root","icon_recently_used","icon_favorites","icon_upload","upload_text","$toolbar","browseTo","uid","selectItem","initUploadView","allowUpload","Upload","upload_button","upload_el","upload_config","uloadMultiple","allowPathSelection","relativePath","setPath","alreadyPresent","deselectItem","breadcrumbTemplate","favoriteTemplate","recentlyusedTemplate","resultTemplate","selectionTemplate","toolbarTemplate","$container","Select2","formatSelection","getIcon","getURL","$selection","path_split","icon_level_up","icon_level_down","formatResult","iconLevelUp","iconLevelDown","$parent","ids","prev","tokenizer","yMax","relitem_rect","maxHeight","which","selectorContext","browsableItemSelector","browsableItem","portal_url","dataset","portalUrl","navlink","check","hrefParts","navParts","inPath","keyCode","descriptionSelector","Description","getOptions","patternName","elOptions","tmpOptions","initBasePattern","Registry","mockupParser","eventName","eventCallback","patternProps","child","Surrogate","__super__","autoregister","language_mapping","atom","plist","rss","svg","wsf","xhtml","xjb","xsd","xsl","CodeJar","hljs","theme","highlight","editor","highlightElement","highlight_wrapper","linenumbers","withLineNumbers","class","hljs_language","registerLanguage","pre_el","indentOn","spellcheck","catchTab","preserveIdent","addClosing","codeeditor","onUpdate","code","_changed","_suppressed","changingEvents","changingFields","_handleUnload","_handleMsg","returnValue","Criteria","indexWidth","classBetweenDtName","classIndexName","classOperatorName","classValueName","classRemoveName","classResultsName","classClearName","classDepthName","app","indexes","operator","patternDateOptions","patternAjaxSelectOptions","patternRelateditemsOptions","indexGroups","advanced","initial","$remove","$index","patternSelect2","placeholder","removeValue","createOperator","createClear","appendOperators","$operator","operations","operators","createValue","convertPathOperators","oval","createPathOperators","resetPathOperators","newOperator","widget","removeOperator","createDepthSelect","selected","$value","startwrap","val1","val2","startdt","endwrap","enddt","pathAndDepth","ContentbrowserPattern","trimmedValue","removeClear","$clear","buildQueryPart","ival","istr","ostr","vstrbase","vstrlistbase","vstr","getDepthString","getJSONListStr","vval","varr","depth","out","previewURL","previewCountURL","classSortLabelName","classSortReverseName","classSortReverseLabelName","classPreviewCountWrapperName","classPreviewResultsWrapperName","classPreviewWrapperName","classPreviewName","classPreviewTitleName","classPreviewDescriptionName","classSortWrapperName","showPreviews","initialized","json","$criteriaWrapper","$sortWrapper","$previewWrapper","createCriteria","createSort","refreshPreviewEvent","_doupdates","updateValue","_updateTimeout","doupdates","existingSortOn","existingSortOrder","$sortOn","$sortOrder","reversed","_previewXhr","$previewPane","querypart","criteriastrs","jsonstr","targetScope","isMarked","marked","cloneClass","drop","sortable","animation","newIndex","oldIndex","disableSort","enableSort","$main_toolbar","$personal_tools","Cookies","expanded","crypto","randomUUID","array","Uint32Array","getRandomValues","SubmitEvent","last_btn","submitable_buttons","canditates","activeElement","candidate","navigation","NavigateEvent","destination","create_event","Moment","locale","strict","fromNow","rtf","Intl","RelativeTimeFormat","numeric","toDate","calendar","lastWeek","lastDay","sameDay","nextDay","nextWeek","sameElse","noSuffix","outputFormat","active","selectedItem","resultsClass","defaultSortOn","perPage","timeoutHide","inputSelector","itemTemplate","doSearch","sorton_position","$searchResults","$results","$prev","disableHiding","$next","next","$li","$input","onceFocused","insertAfter","_load","loadRemote","loadLocal","dialog_panel","close","tippy","active_class","inactive_class","Tippy","tippy_options","parseOptionsForTippy","defaultProps","arrow","hideOnClick","closing","ignoreAttributes","interactive","onHide","_onHide","onShow","_onShow","setDefaultProps","markInactive","placement","pos0","r","b","l","pos1","popperOptions","modifiers","arrowPadding","padding","parsers","flip_options","policy","fallbacks","fallbackPlacements","allowHTML","_initialize_content","popper","tippy_classes","close_button","setProps","_get_content","setContent","get_url_parts","data_type_handlers","ajaxDataType","popperInstance","forceUpdate","get_content","tmp","markdown","Markdown","instance","renderForInjection","register_type_handler","Dropzone","wrapperTemplate","fileaddedClassName","useTus","ajaxUpload","paramName","addRemoveLinks","autoCleanResults","previewsContainer","previewTemplate","maxFiles","maxFilesize","relatedItems","autoDiscover","UploadTemplate","clipboardData","blob","getAsFile","dropzone","addFile","currentFile","$progress","$pathInput","setupRelatedItems","$dropzone","files","hiddenFileInput","click","dzoneOptions","getDzoneOptions","showHideControls","path_uid","file","SUCCESS","previewElement","fadeOut","xmlhr","pct","processUpload","finished","clipboardfile","_showHideTimeout","_showHideControls","$controls","$browse","fadeIn","pathJoin","PreviewTemplate","clickable","$preview","autoProcessQueue","processing","process","QUEUED","CANCELED","removeFile","UPLOADING","tus","handleTusUpload","processFile","endpoint","chunkSize","progress","bytesUploaded","bytesTotal","percentage","formatBytes","bytes","kb","mb","RelatedItems","initialFolder","ri","Storage","backend","ValueStorage","store","_key","_allKeys","prefix_length","removeItem","local","session","sessionStorage","updateOptions","befores","b_el","b_date","a_date","offsetDays","dispatch_change_event","display_el","insertAdjacentElement","pat_display_time","PatDisplayTime","display_time_config","_add_additional","add_clear_button","Pikaday","showWeekNumber","onSelect","onClose","minDate","maxDate","pikaday","el_append_to","clear_button","firedBy"],"sourceRoot":""}